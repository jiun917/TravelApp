{"ast":null,"code":"import _typeof from \"C:/Users/BangJun/Desktop/VUE\\u7DF4\\u7FD2/travel_vue/node_modules/@babel/runtime/helpers/esm/typeof.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.regexp.test.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.string.split.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.regexp.constructor.js\";\nimport \"core-js/modules/es.regexp.dot-all.js\";\nimport \"core-js/modules/es.regexp.sticky.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\n\n/*!\n * better-scroll / better-scroll\n * (c) 2016-2021 ustbhuangyi\n * Released under the MIT License.\n */\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar _extendStatics = function extendStatics(d, b) {\n  _extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    }\n  };\n\n  return _extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  _extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nfunction __generator(thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n}\n\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) {\n    s += arguments[i].length;\n  }\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) {\n    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) {\n      r[k] = a[j];\n    }\n  }\n\n  return r;\n}\n\nvar propertiesConfig$7 = [{\n  sourceKey: 'scroller.scrollBehaviorX.currentPos',\n  key: 'x'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.currentPos',\n  key: 'y'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.hasScroll',\n  key: 'hasHorizontalScroll'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.hasScroll',\n  key: 'hasVerticalScroll'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.contentSize',\n  key: 'scrollerWidth'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.contentSize',\n  key: 'scrollerHeight'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.maxScrollPos',\n  key: 'maxScrollX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.maxScrollPos',\n  key: 'maxScrollY'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.minScrollPos',\n  key: 'minScrollX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.minScrollPos',\n  key: 'minScrollY'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.movingDirection',\n  key: 'movingDirectionX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.movingDirection',\n  key: 'movingDirectionY'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.direction',\n  key: 'directionX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.direction',\n  key: 'directionY'\n}, {\n  sourceKey: 'scroller.actions.enabled',\n  key: 'enabled'\n}, {\n  sourceKey: 'scroller.animater.pending',\n  key: 'pending'\n}, {\n  sourceKey: 'scroller.animater.stop',\n  key: 'stop'\n}, {\n  sourceKey: 'scroller.scrollTo',\n  key: 'scrollTo'\n}, {\n  sourceKey: 'scroller.scrollBy',\n  key: 'scrollBy'\n}, {\n  sourceKey: 'scroller.scrollToElement',\n  key: 'scrollToElement'\n}, {\n  sourceKey: 'scroller.resetPosition',\n  key: 'resetPosition'\n}];\n\nfunction warn(msg) {\n  console.error(\"[BScroll warn]: \" + msg);\n}\n\nfunction assert(condition, msg) {\n  if (!condition) {\n    throw new Error('[BScroll] ' + msg);\n  }\n} // ssr support\n\n\nvar inBrowser = typeof window !== 'undefined';\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\nvar isWeChatDevTools = !!(ua && /wechatdevtools/.test(ua));\nvar isAndroid = ua && ua.indexOf('android') > 0;\n/* istanbul ignore next */\n\nvar isIOSBadVersion = function () {\n  if (typeof ua === 'string') {\n    var regex = /os (\\d\\d?_\\d(_\\d)?)/;\n    var matches = regex.exec(ua);\n    if (!matches) return false;\n    var parts = matches[1].split('_').map(function (item) {\n      return parseInt(item, 10);\n    }); // ios version >= 13.4 issue 982\n\n    return !!(parts[0] === 13 && parts[1] >= 4);\n  }\n\n  return false;\n}();\n/* istanbul ignore next */\n\n\nvar supportsPassive = false;\n/* istanbul ignore next */\n\nif (inBrowser) {\n  var EventName = 'test-passive';\n\n  try {\n    var opts = {};\n    Object.defineProperty(opts, 'passive', {\n      get: function get() {\n        supportsPassive = true;\n      }\n    }); // https://github.com/facebook/flow/issues/285\n\n    window.addEventListener(EventName, function () {}, opts);\n  } catch (e) {}\n}\n\nfunction getNow() {\n  return window.performance && window.performance.now && window.performance.timing ? window.performance.now() + window.performance.timing.navigationStart : +new Date();\n}\n\nvar extend = function extend(target, source) {\n  for (var key in source) {\n    target[key] = source[key];\n  }\n\n  return target;\n};\n\nfunction isUndef(v) {\n  return v === undefined || v === null;\n}\n\nfunction getDistance(x, y) {\n  return Math.sqrt(x * x + y * y);\n}\n\nfunction between(x, min, max) {\n  if (x < min) {\n    return min;\n  }\n\n  if (x > max) {\n    return max;\n  }\n\n  return x;\n}\n\nfunction findIndex(ary, fn) {\n  if (ary.findIndex) {\n    return ary.findIndex(fn);\n  }\n\n  var index = -1;\n  ary.some(function (item, i, ary) {\n    var ret = fn(item, i, ary);\n\n    if (ret) {\n      index = i;\n      return ret;\n    }\n  });\n  return index;\n}\n\nvar elementStyle = inBrowser && document.createElement('div').style;\n\nvar vendor = function () {\n  /* istanbul ignore if  */\n  if (!inBrowser) {\n    return false;\n  }\n\n  var transformNames = [{\n    key: 'standard',\n    value: 'transform'\n  }, {\n    key: 'webkit',\n    value: 'webkitTransform'\n  }, {\n    key: 'Moz',\n    value: 'MozTransform'\n  }, {\n    key: 'O',\n    value: 'OTransform'\n  }, {\n    key: 'ms',\n    value: 'msTransform'\n  }];\n\n  for (var _i = 0, transformNames_1 = transformNames; _i < transformNames_1.length; _i++) {\n    var obj = transformNames_1[_i];\n\n    if (elementStyle[obj.value] !== undefined) {\n      return obj.key;\n    }\n  }\n  /* istanbul ignore next  */\n\n\n  return false;\n}();\n/* istanbul ignore next  */\n\n\nfunction prefixStyle(style) {\n  if (vendor === false) {\n    return style;\n  }\n\n  if (vendor === 'standard') {\n    if (style === 'transitionEnd') {\n      return 'transitionend';\n    }\n\n    return style;\n  }\n\n  return vendor + style.charAt(0).toUpperCase() + style.substr(1);\n}\n\nfunction getElement(el) {\n  return typeof el === 'string' ? document.querySelector(el) : el;\n}\n\nfunction addEvent(el, type, fn, capture) {\n  var useCapture = supportsPassive ? {\n    passive: false,\n    capture: !!capture\n  } : !!capture;\n  el.addEventListener(type, fn, useCapture);\n}\n\nfunction removeEvent(el, type, fn, capture) {\n  el.removeEventListener(type, fn, {\n    capture: !!capture\n  });\n}\n\nfunction offset(el) {\n  var left = 0;\n  var top = 0;\n\n  while (el) {\n    left -= el.offsetLeft;\n    top -= el.offsetTop;\n    el = el.offsetParent;\n  }\n\n  return {\n    left: left,\n    top: top\n  };\n}\n\nfunction offsetToBody(el) {\n  var rect = el.getBoundingClientRect();\n  return {\n    left: -(rect.left + window.pageXOffset),\n    top: -(rect.top + window.pageYOffset)\n  };\n}\n\nvar cssVendor = vendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\nvar transform = prefixStyle('transform');\nvar transition = prefixStyle('transition');\nvar hasPerspective = inBrowser && prefixStyle('perspective') in elementStyle; // fix issue #361\n\nvar hasTouch = inBrowser && ('ontouchstart' in window || isWeChatDevTools);\nvar hasTransition = inBrowser && transition in elementStyle;\nvar style = {\n  transform: transform,\n  transition: transition,\n  transitionTimingFunction: prefixStyle('transitionTimingFunction'),\n  transitionDuration: prefixStyle('transitionDuration'),\n  transitionDelay: prefixStyle('transitionDelay'),\n  transformOrigin: prefixStyle('transformOrigin'),\n  transitionEnd: prefixStyle('transitionEnd'),\n  transitionProperty: prefixStyle('transitionProperty')\n};\nvar eventTypeMap = {\n  touchstart: 1,\n  touchmove: 1,\n  touchend: 1,\n  touchcancel: 1,\n  mousedown: 2,\n  mousemove: 2,\n  mouseup: 2\n};\n\nfunction getRect(el) {\n  /* istanbul ignore if  */\n  if (el instanceof window.SVGElement) {\n    var rect = el.getBoundingClientRect();\n    return {\n      top: rect.top,\n      left: rect.left,\n      width: rect.width,\n      height: rect.height\n    };\n  } else {\n    return {\n      top: el.offsetTop,\n      left: el.offsetLeft,\n      width: el.offsetWidth,\n      height: el.offsetHeight\n    };\n  }\n}\n\nfunction preventDefaultExceptionFn(el, exceptions) {\n  for (var i in exceptions) {\n    if (exceptions[i].test(el[i])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nvar tagExceptionFn = preventDefaultExceptionFn;\n\nfunction tap(e, eventName) {\n  var ev = document.createEvent('Event');\n  ev.initEvent(eventName, true, true);\n  ev.pageX = e.pageX;\n  ev.pageY = e.pageY;\n  e.target.dispatchEvent(ev);\n}\n\nfunction click(e, event) {\n  if (event === void 0) {\n    event = 'click';\n  }\n\n  var eventSource;\n\n  if (e.type === 'mouseup') {\n    eventSource = e;\n  } else if (e.type === 'touchend' || e.type === 'touchcancel') {\n    eventSource = e.changedTouches[0];\n  }\n\n  var posSrc = {};\n\n  if (eventSource) {\n    posSrc.screenX = eventSource.screenX || 0;\n    posSrc.screenY = eventSource.screenY || 0;\n    posSrc.clientX = eventSource.clientX || 0;\n    posSrc.clientY = eventSource.clientY || 0;\n  }\n\n  var ev;\n  var bubbles = true;\n  var cancelable = true;\n  var ctrlKey = e.ctrlKey,\n      shiftKey = e.shiftKey,\n      altKey = e.altKey,\n      metaKey = e.metaKey;\n  var pressedKeysMap = {\n    ctrlKey: ctrlKey,\n    shiftKey: shiftKey,\n    altKey: altKey,\n    metaKey: metaKey\n  };\n\n  if (typeof MouseEvent !== 'undefined') {\n    try {\n      ev = new MouseEvent(event, extend(_assign({\n        bubbles: bubbles,\n        cancelable: cancelable\n      }, pressedKeysMap), posSrc));\n    } catch (e) {\n      /* istanbul ignore next */\n      createEvent();\n    }\n  } else {\n    createEvent();\n  }\n\n  function createEvent() {\n    ev = document.createEvent('Event');\n    ev.initEvent(event, bubbles, cancelable);\n    extend(ev, posSrc);\n  } // forwardedTouchEvent set to true in case of the conflict with fastclick\n\n\n  ev.forwardedTouchEvent = true;\n  ev._constructed = true;\n  e.target.dispatchEvent(ev);\n}\n\nfunction dblclick(e) {\n  click(e, 'dblclick');\n}\n\nfunction prepend(el, target) {\n  var firstChild = target.firstChild;\n\n  if (firstChild) {\n    before(el, firstChild);\n  } else {\n    target.appendChild(el);\n  }\n}\n\nfunction before(el, target) {\n  var parentNode = target.parentNode;\n  parentNode.insertBefore(el, target);\n}\n\nfunction removeChild(el, child) {\n  el.removeChild(child);\n}\n\nfunction hasClass(el, className) {\n  var reg = new RegExp('(^|\\\\s)' + className + '(\\\\s|$)');\n  return reg.test(el.className);\n}\n\nfunction HTMLCollectionToArray(el) {\n  return Array.prototype.slice.call(el, 0);\n}\n\nfunction getClientSize(el) {\n  return {\n    width: el.clientWidth,\n    height: el.clientHeight\n  };\n}\n\nvar ease = {\n  // easeOutQuint\n  swipe: {\n    style: 'cubic-bezier(0.23, 1, 0.32, 1)',\n    fn: function fn(t) {\n      return 1 + --t * t * t * t * t;\n    }\n  },\n  // easeOutQuard\n  swipeBounce: {\n    style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n    fn: function fn(t) {\n      return t * (2 - t);\n    }\n  },\n  // easeOutQuart\n  bounce: {\n    style: 'cubic-bezier(0.165, 0.84, 0.44, 1)',\n    fn: function fn(t) {\n      return 1 - --t * t * t * t;\n    }\n  }\n};\nvar DEFAULT_INTERVAL = 1000 / 60;\nvar windowCompat = inBrowser && window;\n/* istanbul ignore next */\n\nfunction noop$1() {}\n\nvar requestAnimationFrame = function () {\n  /* istanbul ignore if  */\n  if (!inBrowser) {\n    return noop$1;\n  }\n\n  return windowCompat.requestAnimationFrame || windowCompat.webkitRequestAnimationFrame || windowCompat.mozRequestAnimationFrame || windowCompat.oRequestAnimationFrame || // if all else fails, use setTimeout\n  function (callback) {\n    return window.setTimeout(callback, callback.interval || DEFAULT_INTERVAL); // make interval as precise as possible.\n  };\n}();\n\nvar cancelAnimationFrame = function () {\n  /* istanbul ignore if  */\n  if (!inBrowser) {\n    return noop$1;\n  }\n\n  return windowCompat.cancelAnimationFrame || windowCompat.webkitCancelAnimationFrame || windowCompat.mozCancelAnimationFrame || windowCompat.oCancelAnimationFrame || function (id) {\n    window.clearTimeout(id);\n  };\n}();\n/* istanbul ignore next */\n\n\nvar noop = function noop(val) {};\n\nvar sharedPropertyDefinition = {\n  enumerable: true,\n  configurable: true,\n  get: noop,\n  set: noop\n};\n\nvar getProperty = function getProperty(obj, key) {\n  var keys = key.split('.');\n\n  for (var i = 0; i < keys.length - 1; i++) {\n    obj = obj[keys[i]];\n    if (_typeof(obj) !== 'object' || !obj) return;\n  }\n\n  var lastKey = keys.pop();\n\n  if (typeof obj[lastKey] === 'function') {\n    return function () {\n      return obj[lastKey].apply(obj, arguments);\n    };\n  } else {\n    return obj[lastKey];\n  }\n};\n\nvar setProperty = function setProperty(obj, key, value) {\n  var keys = key.split('.');\n  var temp;\n\n  for (var i = 0; i < keys.length - 1; i++) {\n    temp = keys[i];\n    if (!obj[temp]) obj[temp] = {};\n    obj = obj[temp];\n  }\n\n  obj[keys.pop()] = value;\n};\n\nfunction propertiesProxy(target, sourceKey, key) {\n  sharedPropertyDefinition.get = function proxyGetter() {\n    return getProperty(this, sourceKey);\n  };\n\n  sharedPropertyDefinition.set = function proxySetter(val) {\n    setProperty(this, sourceKey, val);\n  };\n\n  Object.defineProperty(target, key, sharedPropertyDefinition);\n}\n\nvar EventEmitter =\n/** @class */\nfunction () {\n  function EventEmitter(names) {\n    this.events = {};\n    this.eventTypes = {};\n    this.registerType(names);\n  }\n\n  EventEmitter.prototype.on = function (type, fn, context) {\n    if (context === void 0) {\n      context = this;\n    }\n\n    this.hasType(type);\n\n    if (!this.events[type]) {\n      this.events[type] = [];\n    }\n\n    this.events[type].push([fn, context]);\n    return this;\n  };\n\n  EventEmitter.prototype.once = function (type, fn, context) {\n    var _this = this;\n\n    if (context === void 0) {\n      context = this;\n    }\n\n    this.hasType(type);\n\n    var magic = function magic() {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      _this.off(type, magic);\n\n      var ret = fn.apply(context, args);\n\n      if (ret === true) {\n        return ret;\n      }\n    };\n\n    magic.fn = fn;\n    this.on(type, magic);\n    return this;\n  };\n\n  EventEmitter.prototype.off = function (type, fn) {\n    if (!type && !fn) {\n      this.events = {};\n      return this;\n    }\n\n    if (type) {\n      this.hasType(type);\n\n      if (!fn) {\n        this.events[type] = [];\n        return this;\n      }\n\n      var events = this.events[type];\n\n      if (!events) {\n        return this;\n      }\n\n      var count = events.length;\n\n      while (count--) {\n        if (events[count][0] === fn || events[count][0] && events[count][0].fn === fn) {\n          events.splice(count, 1);\n        }\n      }\n\n      return this;\n    }\n  };\n\n  EventEmitter.prototype.trigger = function (type) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    this.hasType(type);\n    var events = this.events[type];\n\n    if (!events) {\n      return;\n    }\n\n    var len = events.length;\n\n    var eventsCopy = __spreadArrays(events);\n\n    var ret;\n\n    for (var i = 0; i < len; i++) {\n      var event_1 = eventsCopy[i];\n      var fn = event_1[0],\n          context = event_1[1];\n\n      if (fn) {\n        ret = fn.apply(context, args);\n\n        if (ret === true) {\n          return ret;\n        }\n      }\n    }\n  };\n\n  EventEmitter.prototype.registerType = function (names) {\n    var _this = this;\n\n    names.forEach(function (type) {\n      _this.eventTypes[type] = type;\n    });\n  };\n\n  EventEmitter.prototype.destroy = function () {\n    this.events = {};\n    this.eventTypes = {};\n  };\n\n  EventEmitter.prototype.hasType = function (type) {\n    var types = this.eventTypes;\n    var isType = types[type] === type;\n\n    if (!isType) {\n      warn(\"EventEmitter has used unknown event type: \\\"\" + type + \"\\\", should be oneof [\" + (\"\" + Object.keys(types).map(function (_) {\n        return JSON.stringify(_);\n      })) + \"]\");\n    }\n  };\n\n  return EventEmitter;\n}();\n\nvar EventRegister =\n/** @class */\nfunction () {\n  function EventRegister(wrapper, events) {\n    this.wrapper = wrapper;\n    this.events = events;\n    this.addDOMEvents();\n  }\n\n  EventRegister.prototype.destroy = function () {\n    this.removeDOMEvents();\n    this.events = [];\n  };\n\n  EventRegister.prototype.addDOMEvents = function () {\n    this.handleDOMEvents(addEvent);\n  };\n\n  EventRegister.prototype.removeDOMEvents = function () {\n    this.handleDOMEvents(removeEvent);\n  };\n\n  EventRegister.prototype.handleDOMEvents = function (eventOperation) {\n    var _this = this;\n\n    var wrapper = this.wrapper;\n    this.events.forEach(function (event) {\n      eventOperation(wrapper, event.name, _this, !!event.capture);\n    });\n  };\n\n  EventRegister.prototype.handleEvent = function (e) {\n    var eventType = e.type;\n    this.events.some(function (event) {\n      if (event.name === eventType) {\n        event.handler(e);\n        return true;\n      }\n\n      return false;\n    });\n  };\n\n  return EventRegister;\n}();\n\nvar CustomOptions =\n/** @class */\nfunction () {\n  function CustomOptions() {}\n\n  return CustomOptions;\n}();\n\nvar OptionsConstructor =\n/** @class */\nfunction (_super) {\n  __extends(OptionsConstructor, _super);\n\n  function OptionsConstructor() {\n    var _this = _super.call(this) || this;\n\n    _this.startX = 0;\n    _this.startY = 0;\n    _this.scrollX = false;\n    _this.scrollY = true;\n    _this.freeScroll = false;\n    _this.directionLockThreshold = 0;\n    _this.eventPassthrough = \"\"\n    /* None */\n    ;\n    _this.click = false;\n    _this.dblclick = false;\n    _this.tap = '';\n    _this.bounce = {\n      top: true,\n      bottom: true,\n      left: true,\n      right: true\n    };\n    _this.bounceTime = 800;\n    _this.momentum = true;\n    _this.momentumLimitTime = 300;\n    _this.momentumLimitDistance = 15;\n    _this.swipeTime = 2500;\n    _this.swipeBounceTime = 500;\n    _this.deceleration = 0.0015;\n    _this.flickLimitTime = 200;\n    _this.flickLimitDistance = 100;\n    _this.resizePolling = 60;\n    _this.probeType = 0\n    /* Default */\n    ;\n    _this.stopPropagation = false;\n    _this.preventDefault = true;\n    _this.preventDefaultException = {\n      tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|AUDIO)$/\n    };\n    _this.tagException = {\n      tagName: /^TEXTAREA$/\n    };\n    _this.HWCompositing = true;\n    _this.useTransition = true;\n    _this.bindToWrapper = false;\n    _this.bindToTarget = false;\n    _this.disableMouse = hasTouch;\n    _this.disableTouch = !hasTouch;\n    _this.autoBlur = true;\n    _this.autoEndDistance = 5;\n    _this.outOfBoundaryDampingFactor = 1 / 3;\n    _this.specifiedIndexAsContent = 0;\n    _this.quadrant = 1\n    /* First */\n    ;\n    return _this;\n  }\n\n  OptionsConstructor.prototype.merge = function (options) {\n    if (!options) return this;\n\n    for (var key in options) {\n      if (key === 'bounce') {\n        this.bounce = this.resolveBounce(options[key]);\n        continue;\n      }\n\n      this[key] = options[key];\n    }\n\n    return this;\n  };\n\n  OptionsConstructor.prototype.process = function () {\n    this.translateZ = this.HWCompositing && hasPerspective ? ' translateZ(1px)' : '';\n    this.useTransition = this.useTransition && hasTransition;\n    this.preventDefault = !this.eventPassthrough && this.preventDefault; // If you want eventPassthrough I have to lock one of the axes\n\n    this.scrollX = this.eventPassthrough === \"horizontal\"\n    /* Horizontal */\n    ? false : this.scrollX;\n    this.scrollY = this.eventPassthrough === \"vertical\"\n    /* Vertical */\n    ? false : this.scrollY; // With eventPassthrough we also need lockDirection mechanism\n\n    this.freeScroll = this.freeScroll && !this.eventPassthrough; // force true when freeScroll is true\n\n    this.scrollX = this.freeScroll ? true : this.scrollX;\n    this.scrollY = this.freeScroll ? true : this.scrollY;\n    this.directionLockThreshold = this.eventPassthrough ? 0 : this.directionLockThreshold;\n    return this;\n  };\n\n  OptionsConstructor.prototype.resolveBounce = function (bounceOptions) {\n    var DEFAULT_BOUNCE = {\n      top: true,\n      right: true,\n      bottom: true,\n      left: true\n    };\n    var NEGATED_BOUNCE = {\n      top: false,\n      right: false,\n      bottom: false,\n      left: false\n    };\n    var ret;\n\n    if (_typeof(bounceOptions) === 'object') {\n      ret = extend(DEFAULT_BOUNCE, bounceOptions);\n    } else {\n      ret = bounceOptions ? DEFAULT_BOUNCE : NEGATED_BOUNCE;\n    }\n\n    return ret;\n  };\n\n  return OptionsConstructor;\n}(CustomOptions);\n\nvar ActionsHandler =\n/** @class */\nfunction () {\n  function ActionsHandler(wrapper, options) {\n    this.wrapper = wrapper;\n    this.options = options;\n    this.hooks = new EventEmitter(['beforeStart', 'start', 'move', 'end', 'click']);\n    this.handleDOMEvents();\n  }\n\n  ActionsHandler.prototype.handleDOMEvents = function () {\n    var _a = this.options,\n        bindToWrapper = _a.bindToWrapper,\n        disableMouse = _a.disableMouse,\n        disableTouch = _a.disableTouch,\n        click = _a.click;\n    var wrapper = this.wrapper;\n    var target = bindToWrapper ? wrapper : window;\n    var wrapperEvents = [];\n    var targetEvents = [];\n    var shouldRegisterTouch = !disableTouch;\n    var shouldRegisterMouse = !disableMouse;\n\n    if (click) {\n      wrapperEvents.push({\n        name: 'click',\n        handler: this.click.bind(this),\n        capture: true\n      });\n    }\n\n    if (shouldRegisterTouch) {\n      wrapperEvents.push({\n        name: 'touchstart',\n        handler: this.start.bind(this)\n      });\n      targetEvents.push({\n        name: 'touchmove',\n        handler: this.move.bind(this)\n      }, {\n        name: 'touchend',\n        handler: this.end.bind(this)\n      }, {\n        name: 'touchcancel',\n        handler: this.end.bind(this)\n      });\n    }\n\n    if (shouldRegisterMouse) {\n      wrapperEvents.push({\n        name: 'mousedown',\n        handler: this.start.bind(this)\n      });\n      targetEvents.push({\n        name: 'mousemove',\n        handler: this.move.bind(this)\n      }, {\n        name: 'mouseup',\n        handler: this.end.bind(this)\n      });\n    }\n\n    this.wrapperEventRegister = new EventRegister(wrapper, wrapperEvents);\n    this.targetEventRegister = new EventRegister(target, targetEvents);\n  };\n\n  ActionsHandler.prototype.beforeHandler = function (e, type) {\n    var _a = this.options,\n        preventDefault = _a.preventDefault,\n        stopPropagation = _a.stopPropagation,\n        preventDefaultException = _a.preventDefaultException;\n    var preventDefaultConditions = {\n      start: function start() {\n        return preventDefault && !preventDefaultExceptionFn(e.target, preventDefaultException);\n      },\n      end: function end() {\n        return preventDefault && !preventDefaultExceptionFn(e.target, preventDefaultException);\n      },\n      move: function move() {\n        return preventDefault;\n      }\n    };\n\n    if (preventDefaultConditions[type]()) {\n      e.preventDefault();\n    }\n\n    if (stopPropagation) {\n      e.stopPropagation();\n    }\n  };\n\n  ActionsHandler.prototype.setInitiated = function (type) {\n    if (type === void 0) {\n      type = 0;\n    }\n\n    this.initiated = type;\n  };\n\n  ActionsHandler.prototype.start = function (e) {\n    var _eventType = eventTypeMap[e.type];\n\n    if (this.initiated && this.initiated !== _eventType) {\n      return;\n    }\n\n    this.setInitiated(_eventType); // if textarea or other html tags in options.tagException is manipulated\n    // do not make bs scroll\n\n    if (tagExceptionFn(e.target, this.options.tagException)) {\n      this.setInitiated();\n      return;\n    } // only allow mouse left button\n\n\n    if (_eventType === 2\n    /* Mouse */\n    && e.button !== 0\n    /* Left */\n    ) return;\n\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeStart, e)) {\n      return;\n    }\n\n    this.beforeHandler(e, 'start');\n    var point = e.touches ? e.touches[0] : e;\n    this.pointX = point.pageX;\n    this.pointY = point.pageY;\n    this.hooks.trigger(this.hooks.eventTypes.start, e);\n  };\n\n  ActionsHandler.prototype.move = function (e) {\n    if (eventTypeMap[e.type] !== this.initiated) {\n      return;\n    }\n\n    this.beforeHandler(e, 'move');\n    var point = e.touches ? e.touches[0] : e;\n    var deltaX = point.pageX - this.pointX;\n    var deltaY = point.pageY - this.pointY;\n    this.pointX = point.pageX;\n    this.pointY = point.pageY;\n\n    if (this.hooks.trigger(this.hooks.eventTypes.move, {\n      deltaX: deltaX,\n      deltaY: deltaY,\n      e: e\n    })) {\n      return;\n    } // auto end when out of viewport\n\n\n    var scrollLeft = document.documentElement.scrollLeft || window.pageXOffset || document.body.scrollLeft;\n    var scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n    var pX = this.pointX - scrollLeft;\n    var pY = this.pointY - scrollTop;\n    var autoEndDistance = this.options.autoEndDistance;\n\n    if (pX > document.documentElement.clientWidth - autoEndDistance || pY > document.documentElement.clientHeight - autoEndDistance || pX < autoEndDistance || pY < autoEndDistance) {\n      this.end(e);\n    }\n  };\n\n  ActionsHandler.prototype.end = function (e) {\n    if (eventTypeMap[e.type] !== this.initiated) {\n      return;\n    }\n\n    this.setInitiated();\n    this.beforeHandler(e, 'end');\n    this.hooks.trigger(this.hooks.eventTypes.end, e);\n  };\n\n  ActionsHandler.prototype.click = function (e) {\n    this.hooks.trigger(this.hooks.eventTypes.click, e);\n  };\n\n  ActionsHandler.prototype.setContent = function (content) {\n    if (content !== this.wrapper) {\n      this.wrapper = content;\n      this.rebindDOMEvents();\n    }\n  };\n\n  ActionsHandler.prototype.rebindDOMEvents = function () {\n    this.wrapperEventRegister.destroy();\n    this.targetEventRegister.destroy();\n    this.handleDOMEvents();\n  };\n\n  ActionsHandler.prototype.destroy = function () {\n    this.wrapperEventRegister.destroy();\n    this.targetEventRegister.destroy();\n    this.hooks.destroy();\n  };\n\n  return ActionsHandler;\n}();\n\nvar translaterMetaData = {\n  x: ['translateX', 'px'],\n  y: ['translateY', 'px']\n};\n\nvar Translater =\n/** @class */\nfunction () {\n  function Translater(content) {\n    this.setContent(content);\n    this.hooks = new EventEmitter(['beforeTranslate', 'translate']);\n  }\n\n  Translater.prototype.getComputedPosition = function () {\n    var cssStyle = window.getComputedStyle(this.content, null);\n    var matrix = cssStyle[style.transform].split(')')[0].split(', ');\n    var x = +(matrix[12] || matrix[4]) || 0;\n    var y = +(matrix[13] || matrix[5]) || 0;\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  Translater.prototype.translate = function (point) {\n    var transformStyle = [];\n    Object.keys(point).forEach(function (key) {\n      if (!translaterMetaData[key]) {\n        return;\n      }\n\n      var transformFnName = translaterMetaData[key][0];\n\n      if (transformFnName) {\n        var transformFnArgUnit = translaterMetaData[key][1];\n        var transformFnArg = point[key];\n        transformStyle.push(transformFnName + \"(\" + transformFnArg + transformFnArgUnit + \")\");\n      }\n    });\n    this.hooks.trigger(this.hooks.eventTypes.beforeTranslate, transformStyle, point);\n    this.style[style.transform] = transformStyle.join(' ');\n    this.hooks.trigger(this.hooks.eventTypes.translate, point);\n  };\n\n  Translater.prototype.setContent = function (content) {\n    if (this.content !== content) {\n      this.content = content;\n      this.style = content.style;\n    }\n  };\n\n  Translater.prototype.destroy = function () {\n    this.hooks.destroy();\n  };\n\n  return Translater;\n}();\n\nvar Base =\n/** @class */\nfunction () {\n  function Base(content, translater, options) {\n    this.translater = translater;\n    this.options = options;\n    this.timer = 0;\n    this.hooks = new EventEmitter(['move', 'end', 'beforeForceStop', 'forceStop', 'callStop', 'time', 'timeFunction']);\n    this.setContent(content);\n  }\n\n  Base.prototype.translate = function (endPoint) {\n    this.translater.translate(endPoint);\n  };\n\n  Base.prototype.setPending = function (pending) {\n    this.pending = pending;\n  };\n\n  Base.prototype.setForceStopped = function (forceStopped) {\n    this.forceStopped = forceStopped;\n  };\n\n  Base.prototype.setCallStop = function (called) {\n    this.callStopWhenPending = called;\n  };\n\n  Base.prototype.setContent = function (content) {\n    if (this.content !== content) {\n      this.content = content;\n      this.style = content.style;\n      this.stop();\n    }\n  };\n\n  Base.prototype.clearTimer = function () {\n    if (this.timer) {\n      cancelAnimationFrame(this.timer);\n      this.timer = 0;\n    }\n  };\n\n  Base.prototype.destroy = function () {\n    this.hooks.destroy();\n    cancelAnimationFrame(this.timer);\n  };\n\n  return Base;\n}(); // iOS 13.6 - 14.x, window.getComputedStyle sometimes will get wrong transform value\n// when bs use transition mode\n// eg: translateY -100px -> -200px, when the last frame which is about to scroll to -200px\n// window.getComputedStyle(this.content) will calculate transformY to be -100px(startPoint)\n// it is weird\n// so we should validate position caculated by 'window.getComputedStyle'\n\n\nvar isValidPostion = function isValidPostion(startPoint, endPoint, currentPos, prePos) {\n  var computeDirection = function computeDirection(endValue, startValue) {\n    var delta = endValue - startValue;\n    var direction = delta > 0 ? -1\n    /* Negative */\n    : delta < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n    return direction;\n  };\n\n  var directionX = computeDirection(endPoint.x, startPoint.x);\n  var directionY = computeDirection(endPoint.y, startPoint.y);\n  var deltaX = currentPos.x - prePos.x;\n  var deltaY = currentPos.y - prePos.y;\n  return directionX * deltaX <= 0 && directionY * deltaY <= 0;\n};\n\nvar Transition =\n/** @class */\nfunction (_super) {\n  __extends(Transition, _super);\n\n  function Transition() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Transition.prototype.startProbe = function (startPoint, endPoint) {\n    var _this = this;\n\n    var prePos = startPoint;\n\n    var probe = function probe() {\n      var pos = _this.translater.getComputedPosition();\n\n      if (isValidPostion(startPoint, endPoint, pos, prePos)) {\n        _this.hooks.trigger(_this.hooks.eventTypes.move, pos);\n      } // call bs.stop() should not dispatch end hook again.\n      // forceStop hook will do this.\n\n      /* istanbul ignore if  */\n\n\n      if (!_this.pending) {\n        if (_this.callStopWhenPending) {\n          _this.callStopWhenPending = false;\n        } else {\n          // transition ends should dispatch end hook.\n          _this.hooks.trigger(_this.hooks.eventTypes.end, pos);\n        }\n      }\n\n      prePos = pos;\n\n      if (_this.pending) {\n        _this.timer = requestAnimationFrame(probe);\n      }\n    }; // when manually call bs.stop(), then bs.scrollTo()\n    // we should reset callStopWhenPending to dispatch end hook\n\n\n    if (this.callStopWhenPending) {\n      this.setCallStop(false);\n    }\n\n    cancelAnimationFrame(this.timer);\n    probe();\n  };\n\n  Transition.prototype.transitionTime = function (time) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    this.style[style.transitionDuration] = time + 'ms';\n    this.hooks.trigger(this.hooks.eventTypes.time, time);\n  };\n\n  Transition.prototype.transitionTimingFunction = function (easing) {\n    this.style[style.transitionTimingFunction] = easing;\n    this.hooks.trigger(this.hooks.eventTypes.timeFunction, easing);\n  };\n\n  Transition.prototype.transitionProperty = function () {\n    this.style[style.transitionProperty] = style.transform;\n  };\n\n  Transition.prototype.move = function (startPoint, endPoint, time, easingFn) {\n    this.setPending(time > 0);\n    this.transitionTimingFunction(easingFn);\n    this.transitionProperty();\n    this.transitionTime(time);\n    this.translate(endPoint);\n    var isRealtimeProbeType = this.options.probeType === 3\n    /* Realtime */\n    ;\n\n    if (time && isRealtimeProbeType) {\n      this.startProbe(startPoint, endPoint);\n    } // if we change content's transformY in a tick\n    // such as: 0 -> 50px -> 0\n    // transitionend will not be triggered\n    // so we forceupdate by reflow\n\n\n    if (!time) {\n      this._reflow = this.content.offsetHeight;\n\n      if (isRealtimeProbeType) {\n        this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\n      }\n\n      this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\n    }\n  };\n\n  Transition.prototype.doStop = function () {\n    var pending = this.pending;\n    this.setForceStopped(false);\n    this.setCallStop(false); // still in transition\n\n    if (pending) {\n      this.setPending(false);\n      cancelAnimationFrame(this.timer);\n\n      var _a = this.translater.getComputedPosition(),\n          x = _a.x,\n          y = _a.y;\n\n      this.transitionTime();\n      this.translate({\n        x: x,\n        y: y\n      });\n      this.setForceStopped(true);\n      this.setCallStop(true);\n      this.hooks.trigger(this.hooks.eventTypes.forceStop, {\n        x: x,\n        y: y\n      });\n    }\n\n    return pending;\n  };\n\n  Transition.prototype.stop = function () {\n    var stopFromTransition = this.doStop();\n\n    if (stopFromTransition) {\n      this.hooks.trigger(this.hooks.eventTypes.callStop);\n    }\n  };\n\n  return Transition;\n}(Base);\n\nvar Animation =\n/** @class */\nfunction (_super) {\n  __extends(Animation, _super);\n\n  function Animation() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Animation.prototype.move = function (startPoint, endPoint, time, easingFn) {\n    // time is 0\n    if (!time) {\n      this.translate(endPoint);\n\n      if (this.options.probeType === 3\n      /* Realtime */\n      ) {\n        this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\n      }\n\n      this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\n      return;\n    }\n\n    this.animate(startPoint, endPoint, time, easingFn);\n  };\n\n  Animation.prototype.animate = function (startPoint, endPoint, duration, easingFn) {\n    var _this = this;\n\n    var startTime = getNow();\n    var destTime = startTime + duration;\n    var isRealtimeProbeType = this.options.probeType === 3\n    /* Realtime */\n    ;\n\n    var step = function step() {\n      var now = getNow(); // js animation end\n\n      if (now >= destTime) {\n        _this.translate(endPoint);\n\n        if (isRealtimeProbeType) {\n          _this.hooks.trigger(_this.hooks.eventTypes.move, endPoint);\n        }\n\n        _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\n\n        return;\n      }\n\n      now = (now - startTime) / duration;\n      var easing = easingFn(now);\n      var newPoint = {};\n      Object.keys(endPoint).forEach(function (key) {\n        var startValue = startPoint[key];\n        var endValue = endPoint[key];\n        newPoint[key] = (endValue - startValue) * easing + startValue;\n      });\n\n      _this.translate(newPoint);\n\n      if (isRealtimeProbeType) {\n        _this.hooks.trigger(_this.hooks.eventTypes.move, newPoint);\n      }\n\n      if (_this.pending) {\n        _this.timer = requestAnimationFrame(step);\n      } // call bs.stop() should not dispatch end hook again.\n      // forceStop hook will do this.\n\n      /* istanbul ignore if  */\n\n\n      if (!_this.pending) {\n        if (_this.callStopWhenPending) {\n          _this.callStopWhenPending = false;\n        } else {\n          // raf ends should dispatch end hook.\n          _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\n        }\n      }\n    };\n\n    this.setPending(true); // when manually call bs.stop(), then bs.scrollTo()\n    // we should reset callStopWhenPending to dispatch end hook\n\n    if (this.callStopWhenPending) {\n      this.setCallStop(false);\n    }\n\n    cancelAnimationFrame(this.timer);\n    step();\n  };\n\n  Animation.prototype.doStop = function () {\n    var pending = this.pending;\n    this.setForceStopped(false);\n    this.setCallStop(false); // still in requestFrameAnimation\n\n    if (pending) {\n      this.setPending(false);\n      cancelAnimationFrame(this.timer);\n      var pos = this.translater.getComputedPosition();\n      this.setForceStopped(true);\n      this.setCallStop(true);\n      this.hooks.trigger(this.hooks.eventTypes.forceStop, pos);\n    }\n\n    return pending;\n  };\n\n  Animation.prototype.stop = function () {\n    var stopFromAnimation = this.doStop();\n\n    if (stopFromAnimation) {\n      this.hooks.trigger(this.hooks.eventTypes.callStop);\n    }\n  };\n\n  return Animation;\n}(Base);\n\nfunction createAnimater(element, translater, options) {\n  var useTransition = options.useTransition;\n  var animaterOptions = {};\n  Object.defineProperty(animaterOptions, 'probeType', {\n    enumerable: true,\n    configurable: false,\n    get: function get() {\n      return options.probeType;\n    }\n  });\n\n  if (useTransition) {\n    return new Transition(element, translater, animaterOptions);\n  } else {\n    return new Animation(element, translater, animaterOptions);\n  }\n}\n\nvar Behavior =\n/** @class */\nfunction () {\n  function Behavior(wrapper, content, options) {\n    this.wrapper = wrapper;\n    this.options = options;\n    this.hooks = new EventEmitter(['beforeComputeBoundary', 'computeBoundary', 'momentum', 'end', 'ignoreHasScroll']);\n    this.refresh(content);\n  }\n\n  Behavior.prototype.start = function () {\n    this.dist = 0;\n    this.setMovingDirection(0\n    /* Default */\n    );\n    this.setDirection(0\n    /* Default */\n    );\n  };\n\n  Behavior.prototype.move = function (delta) {\n    delta = this.hasScroll ? delta : 0;\n    this.setMovingDirection(delta);\n    return this.performDampingAlgorithm(delta, this.options.outOfBoundaryDampingFactor);\n  };\n\n  Behavior.prototype.setMovingDirection = function (delta) {\n    this.movingDirection = delta > 0 ? -1\n    /* Negative */\n    : delta < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n  };\n\n  Behavior.prototype.setDirection = function (delta) {\n    this.direction = delta > 0 ? -1\n    /* Negative */\n    : delta < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n  };\n\n  Behavior.prototype.performDampingAlgorithm = function (delta, dampingFactor) {\n    var newPos = this.currentPos + delta; // Slow down or stop if outside of the boundaries\n\n    if (newPos > this.minScrollPos || newPos < this.maxScrollPos) {\n      if (newPos > this.minScrollPos && this.options.bounces[0] || newPos < this.maxScrollPos && this.options.bounces[1]) {\n        newPos = this.currentPos + delta * dampingFactor;\n      } else {\n        newPos = newPos > this.minScrollPos ? this.minScrollPos : this.maxScrollPos;\n      }\n    }\n\n    return newPos;\n  };\n\n  Behavior.prototype.end = function (duration) {\n    var momentumInfo = {\n      duration: 0\n    };\n    var absDist = Math.abs(this.currentPos - this.startPos); // start momentum animation if needed\n\n    if (this.options.momentum && duration < this.options.momentumLimitTime && absDist > this.options.momentumLimitDistance) {\n      var wrapperSize = this.direction === -1\n      /* Negative */\n      && this.options.bounces[0] || this.direction === 1\n      /* Positive */\n      && this.options.bounces[1] ? this.wrapperSize : 0;\n      momentumInfo = this.hasScroll ? this.momentum(this.currentPos, this.startPos, duration, this.maxScrollPos, this.minScrollPos, wrapperSize, this.options) : {\n        destination: this.currentPos,\n        duration: 0\n      };\n    } else {\n      this.hooks.trigger(this.hooks.eventTypes.end, momentumInfo);\n    }\n\n    return momentumInfo;\n  };\n\n  Behavior.prototype.momentum = function (current, start, time, lowerMargin, upperMargin, wrapperSize, options) {\n    if (options === void 0) {\n      options = this.options;\n    }\n\n    var distance = current - start;\n    var speed = Math.abs(distance) / time;\n    var deceleration = options.deceleration,\n        swipeBounceTime = options.swipeBounceTime,\n        swipeTime = options.swipeTime;\n    var duration = Math.min(swipeTime, speed * 2 / deceleration);\n    var momentumData = {\n      destination: current + speed * speed / deceleration * (distance < 0 ? -1 : 1),\n      duration: duration,\n      rate: 15\n    };\n    this.hooks.trigger(this.hooks.eventTypes.momentum, momentumData, distance);\n\n    if (momentumData.destination < lowerMargin) {\n      momentumData.destination = wrapperSize ? Math.max(lowerMargin - wrapperSize / 4, lowerMargin - wrapperSize / momentumData.rate * speed) : lowerMargin;\n      momentumData.duration = swipeBounceTime;\n    } else if (momentumData.destination > upperMargin) {\n      momentumData.destination = wrapperSize ? Math.min(upperMargin + wrapperSize / 4, upperMargin + wrapperSize / momentumData.rate * speed) : upperMargin;\n      momentumData.duration = swipeBounceTime;\n    }\n\n    momentumData.destination = Math.round(momentumData.destination);\n    return momentumData;\n  };\n\n  Behavior.prototype.updateDirection = function () {\n    var absDist = this.currentPos - this.absStartPos;\n    this.setDirection(absDist);\n  };\n\n  Behavior.prototype.refresh = function (content) {\n    var _a = this.options.rect,\n        size = _a.size,\n        position = _a.position;\n    var isWrapperStatic = window.getComputedStyle(this.wrapper, null).position === 'static'; // Force reflow\n\n    var wrapperRect = getRect(this.wrapper); // use client is more fair than offset\n\n    this.wrapperSize = this.wrapper[size === 'width' ? 'clientWidth' : 'clientHeight'];\n    this.setContent(content);\n    var contentRect = getRect(this.content);\n    this.contentSize = contentRect[size];\n    this.relativeOffset = contentRect[position];\n    /* istanbul ignore if  */\n\n    if (isWrapperStatic) {\n      this.relativeOffset -= wrapperRect[position];\n    }\n\n    this.computeBoundary();\n    this.setDirection(0\n    /* Default */\n    );\n  };\n\n  Behavior.prototype.setContent = function (content) {\n    if (content !== this.content) {\n      this.content = content;\n      this.resetState();\n    }\n  };\n\n  Behavior.prototype.resetState = function () {\n    this.currentPos = 0;\n    this.startPos = 0;\n    this.dist = 0;\n    this.setDirection(0\n    /* Default */\n    );\n    this.setMovingDirection(0\n    /* Default */\n    );\n    this.resetStartPos();\n  };\n\n  Behavior.prototype.computeBoundary = function () {\n    this.hooks.trigger(this.hooks.eventTypes.beforeComputeBoundary);\n    var boundary = {\n      minScrollPos: 0,\n      maxScrollPos: this.wrapperSize - this.contentSize\n    };\n\n    if (boundary.maxScrollPos < 0) {\n      boundary.maxScrollPos -= this.relativeOffset;\n\n      if (this.options.specifiedIndexAsContent === 0) {\n        boundary.minScrollPos = -this.relativeOffset;\n      }\n    }\n\n    this.hooks.trigger(this.hooks.eventTypes.computeBoundary, boundary);\n    this.minScrollPos = boundary.minScrollPos;\n    this.maxScrollPos = boundary.maxScrollPos;\n    this.hasScroll = this.options.scrollable && this.maxScrollPos < this.minScrollPos;\n\n    if (!this.hasScroll && this.minScrollPos < this.maxScrollPos) {\n      this.maxScrollPos = this.minScrollPos;\n      this.contentSize = this.wrapperSize;\n    }\n  };\n\n  Behavior.prototype.updatePosition = function (pos) {\n    this.currentPos = pos;\n  };\n\n  Behavior.prototype.getCurrentPos = function () {\n    return this.currentPos;\n  };\n\n  Behavior.prototype.checkInBoundary = function () {\n    var position = this.adjustPosition(this.currentPos);\n    var inBoundary = position === this.getCurrentPos();\n    return {\n      position: position,\n      inBoundary: inBoundary\n    };\n  }; // adjust position when out of boundary\n\n\n  Behavior.prototype.adjustPosition = function (pos) {\n    if (!this.hasScroll && !this.hooks.trigger(this.hooks.eventTypes.ignoreHasScroll)) {\n      pos = this.minScrollPos;\n    } else if (pos > this.minScrollPos) {\n      pos = this.minScrollPos;\n    } else if (pos < this.maxScrollPos) {\n      pos = this.maxScrollPos;\n    }\n\n    return pos;\n  };\n\n  Behavior.prototype.updateStartPos = function () {\n    this.startPos = this.currentPos;\n  };\n\n  Behavior.prototype.updateAbsStartPos = function () {\n    this.absStartPos = this.currentPos;\n  };\n\n  Behavior.prototype.resetStartPos = function () {\n    this.updateStartPos();\n    this.updateAbsStartPos();\n  };\n\n  Behavior.prototype.getAbsDist = function (delta) {\n    this.dist += delta;\n    return Math.abs(this.dist);\n  };\n\n  Behavior.prototype.destroy = function () {\n    this.hooks.destroy();\n  };\n\n  return Behavior;\n}();\n\nvar _a, _b, _c, _d;\n\nvar PassthroughHandlers = (_a = {}, _a[\"yes\"\n/* Yes */\n] = function (e) {\n  return true;\n}, _a[\"no\"\n/* No */\n] = function (e) {\n  e.preventDefault();\n  return false;\n}, _a);\nvar DirectionMap = (_b = {}, _b[\"horizontal\"\n/* Horizontal */\n] = (_c = {}, _c[\"yes\"\n/* Yes */\n] = \"horizontal\"\n/* Horizontal */\n, _c[\"no\"\n/* No */\n] = \"vertical\"\n/* Vertical */\n, _c), _b[\"vertical\"\n/* Vertical */\n] = (_d = {}, _d[\"yes\"\n/* Yes */\n] = \"vertical\"\n/* Vertical */\n, _d[\"no\"\n/* No */\n] = \"horizontal\"\n/* Horizontal */\n, _d), _b);\n\nvar DirectionLockAction =\n/** @class */\nfunction () {\n  function DirectionLockAction(directionLockThreshold, freeScroll, eventPassthrough) {\n    this.directionLockThreshold = directionLockThreshold;\n    this.freeScroll = freeScroll;\n    this.eventPassthrough = eventPassthrough;\n    this.reset();\n  }\n\n  DirectionLockAction.prototype.reset = function () {\n    this.directionLocked = \"\"\n    /* Default */\n    ;\n  };\n\n  DirectionLockAction.prototype.checkMovingDirection = function (absDistX, absDistY, e) {\n    this.computeDirectionLock(absDistX, absDistY);\n    return this.handleEventPassthrough(e);\n  };\n\n  DirectionLockAction.prototype.adjustDelta = function (deltaX, deltaY) {\n    if (this.directionLocked === \"horizontal\"\n    /* Horizontal */\n    ) {\n      deltaY = 0;\n    } else if (this.directionLocked === \"vertical\"\n    /* Vertical */\n    ) {\n      deltaX = 0;\n    }\n\n    return {\n      deltaX: deltaX,\n      deltaY: deltaY\n    };\n  };\n\n  DirectionLockAction.prototype.computeDirectionLock = function (absDistX, absDistY) {\n    // If you are scrolling in one direction, lock it\n    if (this.directionLocked === \"\"\n    /* Default */\n    && !this.freeScroll) {\n      if (absDistX > absDistY + this.directionLockThreshold) {\n        this.directionLocked = \"horizontal\"\n        /* Horizontal */\n        ; // lock horizontally\n      } else if (absDistY >= absDistX + this.directionLockThreshold) {\n        this.directionLocked = \"vertical\"\n        /* Vertical */\n        ; // lock vertically\n      } else {\n        this.directionLocked = \"none\"\n        /* None */\n        ; // no lock\n      }\n    }\n  };\n\n  DirectionLockAction.prototype.handleEventPassthrough = function (e) {\n    var handleMap = DirectionMap[this.directionLocked];\n\n    if (handleMap) {\n      if (this.eventPassthrough === handleMap[\"yes\"\n      /* Yes */\n      ]) {\n        return PassthroughHandlers[\"yes\"\n        /* Yes */\n        ](e);\n      } else if (this.eventPassthrough === handleMap[\"no\"\n      /* No */\n      ]) {\n        return PassthroughHandlers[\"no\"\n        /* No */\n        ](e);\n      }\n    }\n\n    return false;\n  };\n\n  return DirectionLockAction;\n}();\n\nvar applyQuadrantTransformation = function applyQuadrantTransformation(deltaX, deltaY, quadrant) {\n  if (quadrant === 2\n  /* Second */\n  ) {\n    return [deltaY, -deltaX];\n  } else if (quadrant === 3\n  /* Third */\n  ) {\n    return [-deltaX, -deltaY];\n  } else if (quadrant === 4\n  /* Forth */\n  ) {\n    return [-deltaY, deltaX];\n  } else {\n    return [deltaX, deltaY];\n  }\n};\n\nvar ScrollerActions =\n/** @class */\nfunction () {\n  function ScrollerActions(scrollBehaviorX, scrollBehaviorY, actionsHandler, animater, options) {\n    this.hooks = new EventEmitter(['start', 'beforeMove', 'scrollStart', 'scroll', 'beforeEnd', 'end', 'scrollEnd', 'contentNotMoved', 'detectMovingDirection', 'coordinateTransformation']);\n    this.scrollBehaviorX = scrollBehaviorX;\n    this.scrollBehaviorY = scrollBehaviorY;\n    this.actionsHandler = actionsHandler;\n    this.animater = animater;\n    this.options = options;\n    this.directionLockAction = new DirectionLockAction(options.directionLockThreshold, options.freeScroll, options.eventPassthrough);\n    this.enabled = true;\n    this.bindActionsHandler();\n  }\n\n  ScrollerActions.prototype.bindActionsHandler = function () {\n    var _this = this; // [mouse|touch]start event\n\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.start, function (e) {\n      if (!_this.enabled) return true;\n      return _this.handleStart(e);\n    }); // [mouse|touch]move event\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.move, function (_a) {\n      var deltaX = _a.deltaX,\n          deltaY = _a.deltaY,\n          e = _a.e;\n      if (!_this.enabled) return true;\n\n      var _b = applyQuadrantTransformation(deltaX, deltaY, _this.options.quadrant),\n          transformateDeltaX = _b[0],\n          transformateDeltaY = _b[1];\n\n      var transformateDeltaData = {\n        deltaX: transformateDeltaX,\n        deltaY: transformateDeltaY\n      };\n\n      _this.hooks.trigger(_this.hooks.eventTypes.coordinateTransformation, transformateDeltaData);\n\n      return _this.handleMove(transformateDeltaData.deltaX, transformateDeltaData.deltaY, e);\n    }); // [mouse|touch]end event\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.end, function (e) {\n      if (!_this.enabled) return true;\n      return _this.handleEnd(e);\n    }); // click\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.click, function (e) {\n      // handle native click event\n      if (_this.enabled && !e._constructed) {\n        _this.handleClick(e);\n      }\n    });\n  };\n\n  ScrollerActions.prototype.handleStart = function (e) {\n    var timestamp = getNow();\n    this.fingerMoved = false;\n    this.contentMoved = false;\n    this.startTime = timestamp;\n    this.directionLockAction.reset();\n    this.scrollBehaviorX.start();\n    this.scrollBehaviorY.start(); // force stopping last transition or animation\n\n    this.animater.doStop();\n    this.scrollBehaviorX.resetStartPos();\n    this.scrollBehaviorY.resetStartPos();\n    this.hooks.trigger(this.hooks.eventTypes.start, e);\n  };\n\n  ScrollerActions.prototype.handleMove = function (deltaX, deltaY, e) {\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeMove, e)) {\n      return;\n    }\n\n    var absDistX = this.scrollBehaviorX.getAbsDist(deltaX);\n    var absDistY = this.scrollBehaviorY.getAbsDist(deltaY);\n    var timestamp = getNow(); // We need to move at least momentumLimitDistance pixels\n    // for the scrolling to initiate\n\n    if (this.checkMomentum(absDistX, absDistY, timestamp)) {\n      return true;\n    }\n\n    if (this.directionLockAction.checkMovingDirection(absDistX, absDistY, e)) {\n      this.actionsHandler.setInitiated();\n      return true;\n    }\n\n    var delta = this.directionLockAction.adjustDelta(deltaX, deltaY);\n    var prevX = this.scrollBehaviorX.getCurrentPos();\n    var newX = this.scrollBehaviorX.move(delta.deltaX);\n    var prevY = this.scrollBehaviorY.getCurrentPos();\n    var newY = this.scrollBehaviorY.move(delta.deltaY);\n\n    if (this.hooks.trigger(this.hooks.eventTypes.detectMovingDirection)) {\n      return;\n    }\n\n    if (!this.fingerMoved) {\n      this.fingerMoved = true;\n    }\n\n    var positionChanged = newX !== prevX || newY !== prevY;\n\n    if (!this.contentMoved && !positionChanged) {\n      this.hooks.trigger(this.hooks.eventTypes.contentNotMoved);\n    }\n\n    if (!this.contentMoved && positionChanged) {\n      this.contentMoved = true;\n      this.hooks.trigger(this.hooks.eventTypes.scrollStart);\n    }\n\n    if (this.contentMoved && positionChanged) {\n      this.animater.translate({\n        x: newX,\n        y: newY\n      });\n      this.dispatchScroll(timestamp);\n    }\n  };\n\n  ScrollerActions.prototype.dispatchScroll = function (timestamp) {\n    // dispatch scroll in interval time\n    if (timestamp - this.startTime > this.options.momentumLimitTime) {\n      // refresh time and starting position to initiate a momentum\n      this.startTime = timestamp;\n      this.scrollBehaviorX.updateStartPos();\n      this.scrollBehaviorY.updateStartPos();\n\n      if (this.options.probeType === 1\n      /* Throttle */\n      ) {\n        this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\n      }\n    } // dispatch scroll all the time\n\n\n    if (this.options.probeType > 1\n    /* Throttle */\n    ) {\n      this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\n    }\n  };\n\n  ScrollerActions.prototype.checkMomentum = function (absDistX, absDistY, timestamp) {\n    return timestamp - this.endTime > this.options.momentumLimitTime && absDistY < this.options.momentumLimitDistance && absDistX < this.options.momentumLimitDistance;\n  };\n\n  ScrollerActions.prototype.handleEnd = function (e) {\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeEnd, e)) {\n      return;\n    }\n\n    var currentPos = this.getCurrentPos();\n    this.scrollBehaviorX.updateDirection();\n    this.scrollBehaviorY.updateDirection();\n\n    if (this.hooks.trigger(this.hooks.eventTypes.end, e, currentPos)) {\n      return true;\n    }\n\n    currentPos = this.ensureIntegerPos(currentPos);\n    this.animater.translate(currentPos);\n    this.endTime = getNow();\n    var duration = this.endTime - this.startTime;\n    this.hooks.trigger(this.hooks.eventTypes.scrollEnd, currentPos, duration);\n  };\n\n  ScrollerActions.prototype.ensureIntegerPos = function (currentPos) {\n    this.ensuringInteger = true;\n    var x = currentPos.x,\n        y = currentPos.y;\n    var _a = this.scrollBehaviorX,\n        minScrollPosX = _a.minScrollPos,\n        maxScrollPosX = _a.maxScrollPos;\n    var _b = this.scrollBehaviorY,\n        minScrollPosY = _b.minScrollPos,\n        maxScrollPosY = _b.maxScrollPos;\n    x = x > 0 ? Math.ceil(x) : Math.floor(x);\n    y = y > 0 ? Math.ceil(y) : Math.floor(y);\n    x = between(x, maxScrollPosX, minScrollPosX);\n    y = between(y, maxScrollPosY, minScrollPosY);\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  ScrollerActions.prototype.handleClick = function (e) {\n    if (!preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  };\n\n  ScrollerActions.prototype.getCurrentPos = function () {\n    return {\n      x: this.scrollBehaviorX.getCurrentPos(),\n      y: this.scrollBehaviorY.getCurrentPos()\n    };\n  };\n\n  ScrollerActions.prototype.refresh = function () {\n    this.endTime = 0;\n  };\n\n  ScrollerActions.prototype.destroy = function () {\n    this.hooks.destroy();\n  };\n\n  return ScrollerActions;\n}();\n\nfunction createActionsHandlerOptions(bsOptions) {\n  var options = ['click', 'bindToWrapper', 'disableMouse', 'disableTouch', 'preventDefault', 'stopPropagation', 'tagException', 'preventDefaultException', 'autoEndDistance'].reduce(function (prev, cur) {\n    prev[cur] = bsOptions[cur];\n    return prev;\n  }, {});\n  return options;\n}\n\nfunction createBehaviorOptions(bsOptions, extraProp, bounces, rect) {\n  var options = ['momentum', 'momentumLimitTime', 'momentumLimitDistance', 'deceleration', 'swipeBounceTime', 'swipeTime', 'outOfBoundaryDampingFactor', 'specifiedIndexAsContent'].reduce(function (prev, cur) {\n    prev[cur] = bsOptions[cur];\n    return prev;\n  }, {}); // add extra property\n\n  options.scrollable = !!bsOptions[extraProp];\n  options.bounces = bounces;\n  options.rect = rect;\n  return options;\n}\n\nfunction bubbling(source, target, events) {\n  events.forEach(function (event) {\n    var sourceEvent;\n    var targetEvent;\n\n    if (typeof event === 'string') {\n      sourceEvent = targetEvent = event;\n    } else {\n      sourceEvent = event.source;\n      targetEvent = event.target;\n    }\n\n    source.on(sourceEvent, function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return target.trigger.apply(target, __spreadArrays([targetEvent], args));\n    });\n  });\n}\n\nfunction isSamePoint(startPoint, endPoint) {\n  // keys of startPoint and endPoint should be equal\n  var keys = Object.keys(startPoint);\n\n  for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n    var key = keys_1[_i];\n    if (startPoint[key] !== endPoint[key]) return false;\n  }\n\n  return true;\n}\n\nvar MIN_SCROLL_DISTANCE = 1;\n\nvar Scroller =\n/** @class */\nfunction () {\n  function Scroller(wrapper, content, options) {\n    this.wrapper = wrapper;\n    this.content = content;\n    this.resizeTimeout = 0;\n    this.hooks = new EventEmitter(['beforeStart', 'beforeMove', 'beforeScrollStart', 'scrollStart', 'scroll', 'beforeEnd', 'scrollEnd', 'resize', 'touchEnd', 'end', 'flick', 'scrollCancel', 'momentum', 'scrollTo', 'minDistanceScroll', 'scrollToElement', 'beforeRefresh']);\n    this.options = options;\n    var _a = this.options.bounce,\n        left = _a.left,\n        right = _a.right,\n        top = _a.top,\n        bottom = _a.bottom; // direction X\n\n    this.scrollBehaviorX = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollX', [left, right], {\n      size: 'width',\n      position: 'left'\n    })); // direction Y\n\n    this.scrollBehaviorY = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollY', [top, bottom], {\n      size: 'height',\n      position: 'top'\n    }));\n    this.translater = new Translater(this.content);\n    this.animater = createAnimater(this.content, this.translater, this.options);\n    this.actionsHandler = new ActionsHandler(this.options.bindToTarget ? this.content : wrapper, createActionsHandlerOptions(this.options));\n    this.actions = new ScrollerActions(this.scrollBehaviorX, this.scrollBehaviorY, this.actionsHandler, this.animater, this.options);\n    var resizeHandler = this.resize.bind(this);\n    this.resizeRegister = new EventRegister(window, [{\n      name: 'orientationchange',\n      handler: resizeHandler\n    }, {\n      name: 'resize',\n      handler: resizeHandler\n    }]);\n    this.registerTransitionEnd();\n    this.init();\n  }\n\n  Scroller.prototype.init = function () {\n    var _this = this;\n\n    this.bindTranslater();\n    this.bindAnimater();\n    this.bindActions(); // enable pointer events when scrolling ends\n\n    this.hooks.on(this.hooks.eventTypes.scrollEnd, function () {\n      _this.togglePointerEvents(true);\n    });\n  };\n\n  Scroller.prototype.registerTransitionEnd = function () {\n    this.transitionEndRegister = new EventRegister(this.content, [{\n      name: style.transitionEnd,\n      handler: this.transitionEnd.bind(this)\n    }]);\n  };\n\n  Scroller.prototype.bindTranslater = function () {\n    var _this = this;\n\n    var hooks = this.translater.hooks;\n    hooks.on(hooks.eventTypes.beforeTranslate, function (transformStyle) {\n      if (_this.options.translateZ) {\n        transformStyle.push(_this.options.translateZ);\n      }\n    }); // disable pointer events when scrolling\n\n    hooks.on(hooks.eventTypes.translate, function (pos) {\n      var prevPos = _this.getCurrentPos();\n\n      _this.updatePositions(pos); // scrollEnd will dispatch when scroll is force stopping in touchstart handler\n      // so in touchend handler, don't toggle pointer-events\n\n\n      if (_this.actions.ensuringInteger === true) {\n        _this.actions.ensuringInteger = false;\n        return;\n      } // a valid translate\n\n\n      if (pos.x !== prevPos.x || pos.y !== prevPos.y) {\n        _this.togglePointerEvents(false);\n      }\n    });\n  };\n\n  Scroller.prototype.bindAnimater = function () {\n    var _this = this; // reset position\n\n\n    this.animater.hooks.on(this.animater.hooks.eventTypes.end, function (pos) {\n      if (!_this.resetPosition(_this.options.bounceTime)) {\n        _this.animater.setPending(false);\n\n        _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\n      }\n    });\n    bubbling(this.animater.hooks, this.hooks, [{\n      source: this.animater.hooks.eventTypes.move,\n      target: this.hooks.eventTypes.scroll\n    }, {\n      source: this.animater.hooks.eventTypes.forceStop,\n      target: this.hooks.eventTypes.scrollEnd\n    }]);\n  };\n\n  Scroller.prototype.bindActions = function () {\n    var _this = this;\n\n    var actions = this.actions;\n    bubbling(actions.hooks, this.hooks, [{\n      source: actions.hooks.eventTypes.start,\n      target: this.hooks.eventTypes.beforeStart\n    }, {\n      source: actions.hooks.eventTypes.start,\n      target: this.hooks.eventTypes.beforeScrollStart\n    }, {\n      source: actions.hooks.eventTypes.beforeMove,\n      target: this.hooks.eventTypes.beforeMove\n    }, {\n      source: actions.hooks.eventTypes.scrollStart,\n      target: this.hooks.eventTypes.scrollStart\n    }, {\n      source: actions.hooks.eventTypes.scroll,\n      target: this.hooks.eventTypes.scroll\n    }, {\n      source: actions.hooks.eventTypes.beforeEnd,\n      target: this.hooks.eventTypes.beforeEnd\n    }]);\n    actions.hooks.on(actions.hooks.eventTypes.end, function (e, pos) {\n      _this.hooks.trigger(_this.hooks.eventTypes.touchEnd, pos);\n\n      if (_this.hooks.trigger(_this.hooks.eventTypes.end, pos)) {\n        return true;\n      } // check if it is a click operation\n\n\n      if (!actions.fingerMoved) {\n        _this.hooks.trigger(_this.hooks.eventTypes.scrollCancel);\n\n        if (_this.checkClick(e)) {\n          return true;\n        }\n      } // reset if we are outside of the boundaries\n\n\n      if (_this.resetPosition(_this.options.bounceTime, ease.bounce)) {\n        _this.animater.setForceStopped(false);\n\n        return true;\n      }\n    });\n    actions.hooks.on(actions.hooks.eventTypes.scrollEnd, function (pos, duration) {\n      var deltaX = Math.abs(pos.x - _this.scrollBehaviorX.startPos);\n      var deltaY = Math.abs(pos.y - _this.scrollBehaviorY.startPos);\n\n      if (_this.checkFlick(duration, deltaX, deltaY)) {\n        _this.animater.setForceStopped(false);\n\n        _this.hooks.trigger(_this.hooks.eventTypes.flick);\n\n        return;\n      }\n\n      if (_this.momentum(pos, duration)) {\n        _this.animater.setForceStopped(false);\n\n        return;\n      }\n\n      if (actions.contentMoved) {\n        _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\n      }\n\n      if (_this.animater.forceStopped) {\n        _this.animater.setForceStopped(false);\n      }\n    });\n  };\n\n  Scroller.prototype.checkFlick = function (duration, deltaX, deltaY) {\n    var flickMinMovingDistance = 1; // distinguish flick from click\n\n    if (this.hooks.events.flick.length > 1 && duration < this.options.flickLimitTime && deltaX < this.options.flickLimitDistance && deltaY < this.options.flickLimitDistance && (deltaY > flickMinMovingDistance || deltaX > flickMinMovingDistance)) {\n      return true;\n    }\n  };\n\n  Scroller.prototype.momentum = function (pos, duration) {\n    var meta = {\n      time: 0,\n      easing: ease.swiper,\n      newX: pos.x,\n      newY: pos.y\n    }; // start momentum animation if needed\n\n    var momentumX = this.scrollBehaviorX.end(duration);\n    var momentumY = this.scrollBehaviorY.end(duration);\n    meta.newX = isUndef(momentumX.destination) ? meta.newX : momentumX.destination;\n    meta.newY = isUndef(momentumY.destination) ? meta.newY : momentumY.destination;\n    meta.time = Math.max(momentumX.duration, momentumY.duration);\n    this.hooks.trigger(this.hooks.eventTypes.momentum, meta, this); // when x or y changed, do momentum animation now!\n\n    if (meta.newX !== pos.x || meta.newY !== pos.y) {\n      // change easing function when scroller goes out of the boundaries\n      if (meta.newX > this.scrollBehaviorX.minScrollPos || meta.newX < this.scrollBehaviorX.maxScrollPos || meta.newY > this.scrollBehaviorY.minScrollPos || meta.newY < this.scrollBehaviorY.maxScrollPos) {\n        meta.easing = ease.swipeBounce;\n      }\n\n      this.scrollTo(meta.newX, meta.newY, meta.time, meta.easing);\n      return true;\n    }\n  };\n\n  Scroller.prototype.checkClick = function (e) {\n    var cancelable = {\n      preventClick: this.animater.forceStopped\n    }; // we scrolled less than momentumLimitDistance pixels\n\n    if (this.hooks.trigger(this.hooks.eventTypes.checkClick)) {\n      this.animater.setForceStopped(false);\n      return true;\n    }\n\n    if (!cancelable.preventClick) {\n      var _dblclick = this.options.dblclick;\n      var dblclickTrigged = false;\n\n      if (_dblclick && this.lastClickTime) {\n        var _a = _dblclick.delay,\n            delay = _a === void 0 ? 300 : _a;\n\n        if (getNow() - this.lastClickTime < delay) {\n          dblclickTrigged = true;\n          dblclick(e);\n        }\n      }\n\n      if (this.options.tap) {\n        tap(e, this.options.tap);\n      }\n\n      if (this.options.click && !preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\n        click(e);\n      }\n\n      this.lastClickTime = dblclickTrigged ? null : getNow();\n      return true;\n    }\n\n    return false;\n  };\n\n  Scroller.prototype.resize = function () {\n    var _this = this;\n\n    if (!this.actions.enabled) {\n      return;\n    } // fix a scroll problem under Android condition\n\n    /* istanbul ignore if  */\n\n\n    if (isAndroid) {\n      this.wrapper.scrollTop = 0;\n    }\n\n    clearTimeout(this.resizeTimeout);\n    this.resizeTimeout = window.setTimeout(function () {\n      _this.hooks.trigger(_this.hooks.eventTypes.resize);\n    }, this.options.resizePolling);\n  };\n  /* istanbul ignore next */\n\n\n  Scroller.prototype.transitionEnd = function (e) {\n    if (e.target !== this.content || !this.animater.pending) {\n      return;\n    }\n\n    var animater = this.animater;\n    animater.transitionTime();\n\n    if (!this.resetPosition(this.options.bounceTime, ease.bounce)) {\n      this.animater.setPending(false);\n\n      if (this.options.probeType !== 3\n      /* Realtime */\n      ) {\n        this.hooks.trigger(this.hooks.eventTypes.scrollEnd, this.getCurrentPos());\n      }\n    }\n  };\n\n  Scroller.prototype.togglePointerEvents = function (enabled) {\n    if (enabled === void 0) {\n      enabled = true;\n    }\n\n    var el = this.content.children.length ? this.content.children : [this.content];\n    var pointerEvents = enabled ? 'auto' : 'none';\n\n    for (var i = 0; i < el.length; i++) {\n      var node = el[i]; // ignore BetterScroll instance's wrapper DOM\n\n      /* istanbul ignore if  */\n\n      if (node.isBScrollContainer) {\n        continue;\n      }\n\n      node.style.pointerEvents = pointerEvents;\n    }\n  };\n\n  Scroller.prototype.refresh = function (content) {\n    var contentChanged = this.setContent(content);\n    this.hooks.trigger(this.hooks.eventTypes.beforeRefresh);\n    this.scrollBehaviorX.refresh(content);\n    this.scrollBehaviorY.refresh(content);\n\n    if (contentChanged) {\n      this.translater.setContent(content);\n      this.animater.setContent(content);\n      this.transitionEndRegister.destroy();\n      this.registerTransitionEnd();\n\n      if (this.options.bindToTarget) {\n        this.actionsHandler.setContent(content);\n      }\n    }\n\n    this.actions.refresh();\n    this.wrapperOffset = offset(this.wrapper);\n  };\n\n  Scroller.prototype.setContent = function (content) {\n    var contentChanged = content !== this.content;\n\n    if (contentChanged) {\n      this.content = content;\n    }\n\n    return contentChanged;\n  };\n\n  Scroller.prototype.scrollBy = function (deltaX, deltaY, time, easing) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    var _a = this.getCurrentPos(),\n        x = _a.x,\n        y = _a.y;\n\n    easing = !easing ? ease.bounce : easing;\n    deltaX += x;\n    deltaY += y;\n    this.scrollTo(deltaX, deltaY, time, easing);\n  };\n\n  Scroller.prototype.scrollTo = function (x, y, time, easing, extraTransform) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    if (easing === void 0) {\n      easing = ease.bounce;\n    }\n\n    if (extraTransform === void 0) {\n      extraTransform = {\n        start: {},\n        end: {}\n      };\n    }\n\n    var easingFn = this.options.useTransition ? easing.style : easing.fn;\n    var currentPos = this.getCurrentPos();\n\n    var startPoint = _assign({\n      x: currentPos.x,\n      y: currentPos.y\n    }, extraTransform.start);\n\n    var endPoint = _assign({\n      x: x,\n      y: y\n    }, extraTransform.end);\n\n    this.hooks.trigger(this.hooks.eventTypes.scrollTo, endPoint); // it is an useless move\n\n    if (isSamePoint(startPoint, endPoint)) return;\n    var deltaX = Math.abs(endPoint.x - startPoint.x);\n    var deltaY = Math.abs(endPoint.y - startPoint.y); // considering of browser compatibility for decimal transform value\n    // force translating immediately\n\n    if (deltaX < MIN_SCROLL_DISTANCE && deltaY < MIN_SCROLL_DISTANCE) {\n      time = 0;\n      this.hooks.trigger(this.hooks.eventTypes.minDistanceScroll);\n    }\n\n    this.animater.move(startPoint, endPoint, time, easingFn);\n  };\n\n  Scroller.prototype.scrollToElement = function (el, time, offsetX, offsetY, easing) {\n    var targetEle = getElement(el);\n    var pos = offset(targetEle);\n\n    var getOffset = function getOffset(offset, size, wrapperSize) {\n      if (typeof offset === 'number') {\n        return offset;\n      } // if offsetX/Y are true we center the element to the screen\n\n\n      return offset ? Math.round(size / 2 - wrapperSize / 2) : 0;\n    };\n\n    offsetX = getOffset(offsetX, targetEle.offsetWidth, this.wrapper.offsetWidth);\n    offsetY = getOffset(offsetY, targetEle.offsetHeight, this.wrapper.offsetHeight);\n\n    var getPos = function getPos(pos, wrapperPos, offset, scrollBehavior) {\n      pos -= wrapperPos;\n      pos = scrollBehavior.adjustPosition(pos - offset);\n      return pos;\n    };\n\n    pos.left = getPos(pos.left, this.wrapperOffset.left, offsetX, this.scrollBehaviorX);\n    pos.top = getPos(pos.top, this.wrapperOffset.top, offsetY, this.scrollBehaviorY);\n\n    if (this.hooks.trigger(this.hooks.eventTypes.scrollToElement, targetEle, pos)) {\n      return;\n    }\n\n    this.scrollTo(pos.left, pos.top, time, easing);\n  };\n\n  Scroller.prototype.resetPosition = function (time, easing) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    if (easing === void 0) {\n      easing = ease.bounce;\n    }\n\n    var _a = this.scrollBehaviorX.checkInBoundary(),\n        x = _a.position,\n        xInBoundary = _a.inBoundary;\n\n    var _b = this.scrollBehaviorY.checkInBoundary(),\n        y = _b.position,\n        yInBoundary = _b.inBoundary;\n\n    if (xInBoundary && yInBoundary) {\n      return false;\n    }\n    /* istanbul ignore if  */\n\n\n    if (isIOSBadVersion) {\n      // fix ios 13.4 bouncing\n      // see it in issues 982\n      this.reflow();\n    } // out of boundary\n\n\n    this.scrollTo(x, y, time, easing);\n    return true;\n  };\n  /* istanbul ignore next */\n\n\n  Scroller.prototype.reflow = function () {\n    this._reflow = this.content.offsetHeight;\n  };\n\n  Scroller.prototype.updatePositions = function (pos) {\n    this.scrollBehaviorX.updatePosition(pos.x);\n    this.scrollBehaviorY.updatePosition(pos.y);\n  };\n\n  Scroller.prototype.getCurrentPos = function () {\n    return this.actions.getCurrentPos();\n  };\n\n  Scroller.prototype.enable = function () {\n    this.actions.enabled = true;\n  };\n\n  Scroller.prototype.disable = function () {\n    cancelAnimationFrame(this.animater.timer);\n    this.actions.enabled = false;\n  };\n\n  Scroller.prototype.destroy = function () {\n    var _this = this;\n\n    var keys = ['resizeRegister', 'transitionEndRegister', 'actionsHandler', 'actions', 'hooks', 'animater', 'translater', 'scrollBehaviorX', 'scrollBehaviorY'];\n    keys.forEach(function (key) {\n      return _this[key].destroy();\n    });\n  };\n\n  return Scroller;\n}();\n\nvar BScrollConstructor =\n/** @class */\nfunction (_super) {\n  __extends(BScrollConstructor, _super);\n\n  function BScrollConstructor(el, options) {\n    var _this = _super.call(this, ['refresh', 'contentChanged', 'enable', 'disable', 'beforeScrollStart', 'scrollStart', 'scroll', 'scrollEnd', 'scrollCancel', 'touchEnd', 'flick', 'destroy']) || this;\n\n    var wrapper = getElement(el);\n\n    if (!wrapper) {\n      warn('Can not resolve the wrapper DOM.');\n      return _this;\n    }\n\n    _this.plugins = {};\n    _this.options = new OptionsConstructor().merge(options).process();\n\n    if (!_this.setContent(wrapper).valid) {\n      return _this;\n    }\n\n    _this.hooks = new EventEmitter(['refresh', 'enable', 'disable', 'destroy', 'beforeInitialScrollTo', 'contentChanged']);\n\n    _this.init(wrapper);\n\n    return _this;\n  }\n\n  BScrollConstructor.use = function (ctor) {\n    var name = ctor.pluginName;\n    var installed = BScrollConstructor.plugins.some(function (plugin) {\n      return ctor === plugin.ctor;\n    });\n    if (installed) return BScrollConstructor;\n\n    if (isUndef(name)) {\n      warn(\"Plugin Class must specify plugin's name in static property by 'pluginName' field.\");\n      return BScrollConstructor;\n    }\n\n    BScrollConstructor.pluginsMap[name] = true;\n    BScrollConstructor.plugins.push({\n      name: name,\n      applyOrder: ctor.applyOrder,\n      ctor: ctor\n    });\n    return BScrollConstructor;\n  };\n\n  BScrollConstructor.prototype.setContent = function (wrapper) {\n    var contentChanged = false;\n    var valid = true;\n    var content = wrapper.children[this.options.specifiedIndexAsContent];\n\n    if (!content) {\n      warn('The wrapper need at least one child element to be content element to scroll.');\n      valid = false;\n    } else {\n      contentChanged = this.content !== content;\n\n      if (contentChanged) {\n        this.content = content;\n      }\n    }\n\n    return {\n      valid: valid,\n      contentChanged: contentChanged\n    };\n  };\n\n  BScrollConstructor.prototype.init = function (wrapper) {\n    var _this = this;\n\n    this.wrapper = wrapper; // mark wrapper to recognize bs instance by DOM attribute\n\n    wrapper.isBScrollContainer = true;\n    this.scroller = new Scroller(wrapper, this.content, this.options);\n    this.scroller.hooks.on(this.scroller.hooks.eventTypes.resize, function () {\n      _this.refresh();\n    });\n    this.eventBubbling();\n    this.handleAutoBlur();\n    this.enable();\n    this.proxy(propertiesConfig$7);\n    this.applyPlugins(); // maybe boundary has changed, should refresh\n\n    this.refreshWithoutReset(this.content);\n    var _a = this.options,\n        startX = _a.startX,\n        startY = _a.startY;\n    var position = {\n      x: startX,\n      y: startY\n    }; // maybe plugins want to control scroll position\n\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeInitialScrollTo, position)) {\n      return;\n    }\n\n    this.scroller.scrollTo(position.x, position.y);\n  };\n\n  BScrollConstructor.prototype.applyPlugins = function () {\n    var _this = this;\n\n    var options = this.options;\n    BScrollConstructor.plugins.sort(function (a, b) {\n      var _a;\n\n      var applyOrderMap = (_a = {}, _a[\"pre\"\n      /* Pre */\n      ] = -1, _a[\"post\"\n      /* Post */\n      ] = 1, _a);\n      var aOrder = a.applyOrder ? applyOrderMap[a.applyOrder] : 0;\n      var bOrder = b.applyOrder ? applyOrderMap[b.applyOrder] : 0;\n      return aOrder - bOrder;\n    }).forEach(function (item) {\n      var ctor = item.ctor;\n\n      if (options[item.name] && typeof ctor === 'function') {\n        _this.plugins[item.name] = new ctor(_this);\n      }\n    });\n  };\n\n  BScrollConstructor.prototype.handleAutoBlur = function () {\n    /* istanbul ignore if  */\n    if (this.options.autoBlur) {\n      this.on(this.eventTypes.beforeScrollStart, function () {\n        var activeElement = document.activeElement;\n\n        if (activeElement && (activeElement.tagName === 'INPUT' || activeElement.tagName === 'TEXTAREA')) {\n          activeElement.blur();\n        }\n      });\n    }\n  };\n\n  BScrollConstructor.prototype.eventBubbling = function () {\n    bubbling(this.scroller.hooks, this, [this.eventTypes.beforeScrollStart, this.eventTypes.scrollStart, this.eventTypes.scroll, this.eventTypes.scrollEnd, this.eventTypes.scrollCancel, this.eventTypes.touchEnd, this.eventTypes.flick]);\n  };\n\n  BScrollConstructor.prototype.refreshWithoutReset = function (content) {\n    this.scroller.refresh(content);\n    this.hooks.trigger(this.hooks.eventTypes.refresh, content);\n    this.trigger(this.eventTypes.refresh, content);\n  };\n\n  BScrollConstructor.prototype.proxy = function (propertiesConfig) {\n    var _this = this;\n\n    propertiesConfig.forEach(function (_a) {\n      var key = _a.key,\n          sourceKey = _a.sourceKey;\n      propertiesProxy(_this, sourceKey, key);\n    });\n  };\n\n  BScrollConstructor.prototype.refresh = function () {\n    var _a = this.setContent(this.wrapper),\n        contentChanged = _a.contentChanged,\n        valid = _a.valid;\n\n    if (valid) {\n      var content = this.content;\n      this.refreshWithoutReset(content);\n\n      if (contentChanged) {\n        this.hooks.trigger(this.hooks.eventTypes.contentChanged, content);\n        this.trigger(this.eventTypes.contentChanged, content);\n      }\n\n      this.scroller.resetPosition();\n    }\n  };\n\n  BScrollConstructor.prototype.enable = function () {\n    this.scroller.enable();\n    this.hooks.trigger(this.hooks.eventTypes.enable);\n    this.trigger(this.eventTypes.enable);\n  };\n\n  BScrollConstructor.prototype.disable = function () {\n    this.scroller.disable();\n    this.hooks.trigger(this.hooks.eventTypes.disable);\n    this.trigger(this.eventTypes.disable);\n  };\n\n  BScrollConstructor.prototype.destroy = function () {\n    this.hooks.trigger(this.hooks.eventTypes.destroy);\n    this.trigger(this.eventTypes.destroy);\n    this.scroller.destroy();\n  };\n\n  BScrollConstructor.prototype.eventRegister = function (names) {\n    this.registerType(names);\n  };\n\n  BScrollConstructor.plugins = [];\n  BScrollConstructor.pluginsMap = {};\n  return BScrollConstructor;\n}(EventEmitter);\n\nfunction createBScroll(el, options) {\n  var bs = new BScrollConstructor(el, options);\n  return bs;\n}\n\ncreateBScroll.use = BScrollConstructor.use;\ncreateBScroll.plugins = BScrollConstructor.plugins;\ncreateBScroll.pluginsMap = BScrollConstructor.pluginsMap;\nvar BScroll = createBScroll;\n\nvar MouseWheel =\n/** @class */\nfunction () {\n  function MouseWheel(scroll) {\n    this.scroll = scroll;\n    this.wheelEndTimer = 0;\n    this.wheelMoveTimer = 0;\n    this.wheelStart = false;\n    this.init();\n  }\n\n  MouseWheel.prototype.init = function () {\n    this.handleBScroll();\n    this.handleOptions();\n    this.handleHooks();\n    this.registerEvent();\n  };\n\n  MouseWheel.prototype.handleBScroll = function () {\n    this.scroll.registerType(['alterOptions', 'mousewheelStart', 'mousewheelMove', 'mousewheelEnd']);\n  };\n\n  MouseWheel.prototype.handleOptions = function () {\n    var userOptions = this.scroll.options.mouseWheel === true ? {} : this.scroll.options.mouseWheel;\n    var defaultOptions = {\n      speed: 20,\n      invert: false,\n      easeTime: 300,\n      discreteTime: 400,\n      throttleTime: 0,\n      dampingFactor: 0.1\n    };\n    this.mouseWheelOpt = extend(defaultOptions, userOptions);\n  };\n\n  MouseWheel.prototype.handleHooks = function () {\n    this.hooksFn = [];\n    this.registerHooks(this.scroll.hooks, 'destroy', this.destroy);\n  };\n\n  MouseWheel.prototype.registerEvent = function () {\n    this.eventRegister = new EventRegister(this.scroll.scroller.wrapper, [{\n      name: 'wheel',\n      handler: this.wheelHandler.bind(this)\n    }, {\n      name: 'mousewheel',\n      handler: this.wheelHandler.bind(this)\n    }, {\n      name: 'DOMMouseScroll',\n      handler: this.wheelHandler.bind(this)\n    }]);\n  };\n\n  MouseWheel.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  MouseWheel.prototype.wheelHandler = function (e) {\n    if (!this.scroll.enabled) {\n      return;\n    }\n\n    this.beforeHandler(e); // start\n\n    if (!this.wheelStart) {\n      this.wheelStartHandler(e);\n      this.wheelStart = true;\n    } // move\n\n\n    var delta = this.getWheelDelta(e);\n    this.wheelMoveHandler(delta); // end\n\n    this.wheelEndDetector(delta);\n  };\n\n  MouseWheel.prototype.wheelStartHandler = function (e) {\n    this.cleanCache();\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n    scrollBehaviorX.setMovingDirection(0\n    /* Default */\n    );\n    scrollBehaviorY.setMovingDirection(0\n    /* Default */\n    );\n    scrollBehaviorX.setDirection(0\n    /* Default */\n    );\n    scrollBehaviorY.setDirection(0\n    /* Default */\n    );\n    this.scroll.trigger(this.scroll.eventTypes.alterOptions, this.mouseWheelOpt);\n    this.scroll.trigger(this.scroll.eventTypes.mousewheelStart);\n  };\n\n  MouseWheel.prototype.cleanCache = function () {\n    this.deltaCache = [];\n  };\n\n  MouseWheel.prototype.wheelMoveHandler = function (delta) {\n    var _this = this;\n\n    var _a = this.mouseWheelOpt,\n        throttleTime = _a.throttleTime,\n        dampingFactor = _a.dampingFactor;\n\n    if (throttleTime && this.wheelMoveTimer) {\n      this.deltaCache.push(delta);\n    } else {\n      var cachedDelta = this.deltaCache.reduce(function (prev, current) {\n        return {\n          x: prev.x + current.x,\n          y: prev.y + current.y\n        };\n      }, {\n        x: 0,\n        y: 0\n      });\n      this.cleanCache();\n      var _b = this.scroll.scroller,\n          scrollBehaviorX = _b.scrollBehaviorX,\n          scrollBehaviorY = _b.scrollBehaviorY;\n      scrollBehaviorX.setMovingDirection(-delta.directionX);\n      scrollBehaviorY.setMovingDirection(-delta.directionY);\n      scrollBehaviorX.setDirection(delta.x);\n      scrollBehaviorY.setDirection(delta.y); // when out of boundary, perform a damping scroll\n\n      var newX = scrollBehaviorX.performDampingAlgorithm(Math.round(delta.x) + cachedDelta.x, dampingFactor);\n      var newY = scrollBehaviorY.performDampingAlgorithm(Math.round(delta.y) + cachedDelta.x, dampingFactor);\n\n      if (!this.scroll.trigger(this.scroll.eventTypes.mousewheelMove, {\n        x: newX,\n        y: newY\n      })) {\n        var easeTime = this.getEaseTime();\n\n        if (newX !== this.scroll.x || newY !== this.scroll.y) {\n          this.scroll.scrollTo(newX, newY, easeTime);\n        }\n      }\n\n      if (throttleTime) {\n        this.wheelMoveTimer = window.setTimeout(function () {\n          _this.wheelMoveTimer = 0;\n        }, throttleTime);\n      }\n    }\n  };\n\n  MouseWheel.prototype.wheelEndDetector = function (delta) {\n    var _this = this;\n\n    window.clearTimeout(this.wheelEndTimer);\n    this.wheelEndTimer = window.setTimeout(function () {\n      _this.wheelStart = false;\n      window.clearTimeout(_this.wheelMoveTimer);\n      _this.wheelMoveTimer = 0;\n\n      _this.scroll.trigger(_this.scroll.eventTypes.mousewheelEnd, delta);\n    }, this.mouseWheelOpt.discreteTime);\n  };\n\n  MouseWheel.prototype.getWheelDelta = function (e) {\n    var _a = this.mouseWheelOpt,\n        speed = _a.speed,\n        invert = _a.invert;\n    var wheelDeltaX = 0;\n    var wheelDeltaY = 0;\n    var direction = invert ? -1\n    /* Negative */\n    : 1\n    /* Positive */\n    ;\n\n    switch (true) {\n      case 'deltaX' in e:\n        if (e.deltaMode === 1) {\n          wheelDeltaX = -e.deltaX * speed;\n          wheelDeltaY = -e.deltaY * speed;\n        } else {\n          wheelDeltaX = -e.deltaX;\n          wheelDeltaY = -e.deltaY;\n        }\n\n        break;\n\n      case 'wheelDeltaX' in e:\n        wheelDeltaX = e.wheelDeltaX / 120 * speed;\n        wheelDeltaY = e.wheelDeltaY / 120 * speed;\n        break;\n\n      case 'wheelDelta' in e:\n        wheelDeltaX = wheelDeltaY = e.wheelDelta / 120 * speed;\n        break;\n\n      case 'detail' in e:\n        wheelDeltaX = wheelDeltaY = -e.detail / 3 * speed;\n        break;\n    }\n\n    wheelDeltaX *= direction;\n    wheelDeltaY *= direction;\n\n    if (!this.scroll.hasVerticalScroll) {\n      if (Math.abs(wheelDeltaY) > Math.abs(wheelDeltaX)) {\n        wheelDeltaX = wheelDeltaY;\n      }\n\n      wheelDeltaY = 0;\n    }\n\n    if (!this.scroll.hasHorizontalScroll) {\n      wheelDeltaX = 0;\n    }\n\n    var directionX = wheelDeltaX > 0 ? -1\n    /* Negative */\n    : wheelDeltaX < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n    var directionY = wheelDeltaY > 0 ? -1\n    /* Negative */\n    : wheelDeltaY < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n    return {\n      x: wheelDeltaX,\n      y: wheelDeltaY,\n      directionX: directionX,\n      directionY: directionY\n    };\n  };\n\n  MouseWheel.prototype.beforeHandler = function (e) {\n    var _a = this.scroll.options,\n        preventDefault = _a.preventDefault,\n        stopPropagation = _a.stopPropagation,\n        preventDefaultException = _a.preventDefaultException;\n\n    if (preventDefault && !preventDefaultExceptionFn(e.target, preventDefaultException)) {\n      e.preventDefault();\n    }\n\n    if (stopPropagation) {\n      e.stopPropagation();\n    }\n  };\n\n  MouseWheel.prototype.getEaseTime = function () {\n    var SAFE_EASETIME = 100;\n    var easeTime = this.mouseWheelOpt.easeTime; // scrollEnd event will be triggered in every calling of scrollTo when easeTime is too small\n    // easeTime needs to be greater than 100\n\n    if (easeTime < SAFE_EASETIME) {\n      warn(\"easeTime should be greater than 100.\" + \"If mouseWheel easeTime is too small,\" + \"scrollEnd will be triggered many times.\");\n    }\n\n    return Math.max(easeTime, SAFE_EASETIME);\n  };\n\n  MouseWheel.prototype.destroy = function () {\n    this.eventRegister.destroy();\n    window.clearTimeout(this.wheelEndTimer);\n    window.clearTimeout(this.wheelMoveTimer);\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n  };\n\n  MouseWheel.pluginName = 'mouseWheel';\n  MouseWheel.applyOrder = \"pre\"\n  /* Pre */\n  ;\n  return MouseWheel;\n}();\n\nvar ObserveDOM =\n/** @class */\nfunction () {\n  function ObserveDOM(scroll) {\n    this.scroll = scroll;\n    this.stopObserver = false;\n    this.init();\n  }\n\n  ObserveDOM.prototype.init = function () {\n    this.handleMutationObserver();\n    this.handleHooks();\n  };\n\n  ObserveDOM.prototype.handleMutationObserver = function () {\n    var _this = this;\n\n    if (typeof MutationObserver !== 'undefined') {\n      var timer_1 = 0;\n      this.observer = new MutationObserver(function (mutations) {\n        _this.mutationObserverHandler(mutations, timer_1);\n      });\n      this.startObserve(this.observer);\n    } else {\n      this.checkDOMUpdate();\n    }\n  };\n\n  ObserveDOM.prototype.handleHooks = function () {\n    var _this = this;\n\n    this.hooksFn = [];\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.contentChanged, function () {\n      _this.stopObserve(); // launch a new mutationObserver\n\n\n      _this.handleMutationObserver();\n    });\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.enable, function () {\n      if (_this.stopObserver) {\n        _this.handleMutationObserver();\n      }\n    });\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.disable, function () {\n      _this.stopObserve();\n    });\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.destroy, function () {\n      _this.destroy();\n    });\n  };\n\n  ObserveDOM.prototype.mutationObserverHandler = function (mutations, timer) {\n    var _this = this;\n\n    if (this.shouldNotRefresh()) {\n      return;\n    }\n\n    var immediateRefresh = false;\n    var deferredRefresh = false;\n\n    for (var i = 0; i < mutations.length; i++) {\n      var mutation = mutations[i];\n\n      if (mutation.type !== 'attributes') {\n        immediateRefresh = true;\n        break;\n      } else {\n        if (mutation.target !== this.scroll.scroller.content) {\n          deferredRefresh = true;\n          break;\n        }\n      }\n    }\n\n    if (immediateRefresh) {\n      this.scroll.refresh();\n    } else if (deferredRefresh) {\n      // attributes changes too often\n      clearTimeout(timer);\n      timer = window.setTimeout(function () {\n        if (!_this.shouldNotRefresh()) {\n          _this.scroll.refresh();\n        }\n      }, 60);\n    }\n  };\n\n  ObserveDOM.prototype.startObserve = function (observer) {\n    var config = {\n      attributes: true,\n      childList: true,\n      subtree: true\n    };\n    observer.observe(this.scroll.scroller.content, config);\n  };\n\n  ObserveDOM.prototype.shouldNotRefresh = function () {\n    var scroller = this.scroll.scroller;\n    var scrollBehaviorX = scroller.scrollBehaviorX,\n        scrollBehaviorY = scroller.scrollBehaviorY;\n    var outsideBoundaries = scrollBehaviorX.currentPos > scrollBehaviorX.minScrollPos || scrollBehaviorX.currentPos < scrollBehaviorX.maxScrollPos || scrollBehaviorY.currentPos > scrollBehaviorY.minScrollPos || scrollBehaviorY.currentPos < scrollBehaviorY.maxScrollPos;\n    return scroller.animater.pending || outsideBoundaries;\n  };\n\n  ObserveDOM.prototype.checkDOMUpdate = function () {\n    var _this = this;\n\n    var content = this.scroll.scroller.content;\n    var contentRect = getRect(content);\n    var oldWidth = contentRect.width;\n    var oldHeight = contentRect.height;\n\n    var check = function check() {\n      if (_this.stopObserver) {\n        return;\n      }\n\n      contentRect = getRect(content);\n      var newWidth = contentRect.width;\n      var newHeight = contentRect.height;\n\n      if (oldWidth !== newWidth || oldHeight !== newHeight) {\n        _this.scroll.refresh();\n      }\n\n      oldWidth = newWidth;\n      oldHeight = newHeight;\n      next();\n    };\n\n    var next = function next() {\n      setTimeout(function () {\n        check();\n      }, 1000);\n    };\n\n    next();\n  };\n\n  ObserveDOM.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  ObserveDOM.prototype.stopObserve = function () {\n    this.stopObserver = true;\n\n    if (this.observer) {\n      this.observer.disconnect();\n    }\n  };\n\n  ObserveDOM.prototype.destroy = function () {\n    this.stopObserve();\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n    this.hooksFn.length = 0;\n  };\n\n  ObserveDOM.pluginName = 'observeDOM';\n  return ObserveDOM;\n}();\n\nvar sourcePrefix$6 = 'plugins.pullDownRefresh';\nvar propertiesMap$6 = [{\n  key: 'finishPullDown',\n  name: 'finishPullDown'\n}, {\n  key: 'openPullDown',\n  name: 'openPullDown'\n}, {\n  key: 'closePullDown',\n  name: 'closePullDown'\n}, {\n  key: 'autoPullDownRefresh',\n  name: 'autoPullDownRefresh'\n}];\nvar propertiesConfig$6 = propertiesMap$6.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$6 + \".\" + item.name\n  };\n});\nvar PULLING_DOWN_EVENT = 'pullingDown';\nvar ENTER_THRESHOLD_EVENT = 'enterThreshold';\nvar LEAVE_THRESHOLD_EVENT = 'leaveThreshold';\n\nvar PullDown =\n/** @class */\nfunction () {\n  function PullDown(scroll) {\n    this.scroll = scroll;\n    this.pulling = 0\n    /* DEFAULT */\n    ;\n    this.thresholdBoundary = 0\n    /* DEFAULT */\n    ;\n    this.init();\n  }\n\n  PullDown.prototype.setPulling = function (status) {\n    this.pulling = status;\n  };\n\n  PullDown.prototype.setThresholdBoundary = function (boundary) {\n    this.thresholdBoundary = boundary;\n  };\n\n  PullDown.prototype.init = function () {\n    this.handleBScroll();\n    this.handleOptions(this.scroll.options.pullDownRefresh);\n    this.handleHooks();\n    this.watch();\n  };\n\n  PullDown.prototype.handleBScroll = function () {\n    this.scroll.registerType([PULLING_DOWN_EVENT, ENTER_THRESHOLD_EVENT, LEAVE_THRESHOLD_EVENT]);\n    this.scroll.proxy(propertiesConfig$6);\n  };\n\n  PullDown.prototype.handleOptions = function (userOptions) {\n    if (userOptions === void 0) {\n      userOptions = {};\n    }\n\n    userOptions = userOptions === true ? {} : userOptions;\n    var defaultOptions = {\n      threshold: 90,\n      stop: 40\n    };\n    this.options = extend(defaultOptions, userOptions);\n    this.scroll.options.probeType = 3\n    /* Realtime */\n    ;\n  };\n\n  PullDown.prototype.handleHooks = function () {\n    var _this = this;\n\n    this.hooksFn = [];\n    var scroller = this.scroll.scroller;\n    var scrollBehaviorY = scroller.scrollBehaviorY;\n    this.currentMinScrollY = this.cachedOriginanMinScrollY = scrollBehaviorY.minScrollPos;\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.contentChanged, function () {\n      _this.finishPullDown();\n    });\n    this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\n      // content is smaller than wrapper\n      if (boundary.maxScrollPos > 0) {\n        // allow scrolling when content is not full of wrapper\n        boundary.maxScrollPos = -1;\n      }\n\n      boundary.minScrollPos = _this.currentMinScrollY;\n    }); // integrate with mousewheel\n\n    if (this.hasMouseWheelPlugin()) {\n      this.registerHooks(this.scroll, this.scroll.eventTypes.alterOptions, function (mouseWheelOptions) {\n        var SANE_DISCRETE_TIME = 300;\n        var SANE_EASE_TIME = 350;\n        mouseWheelOptions.discreteTime = SANE_DISCRETE_TIME; // easeTime > discreteTime ensure goInto checkPullDown function\n\n        mouseWheelOptions.easeTime = SANE_EASE_TIME;\n      });\n      this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelEnd, function () {\n        // mouseWheel need trigger checkPullDown manually\n        scroller.hooks.trigger(scroller.hooks.eventTypes.end);\n      });\n    }\n  };\n\n  PullDown.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  PullDown.prototype.hasMouseWheelPlugin = function () {\n    return !!this.scroll.eventTypes.alterOptions;\n  };\n\n  PullDown.prototype.watch = function () {\n    var scroller = this.scroll.scroller;\n    this.watching = true;\n    this.registerHooks(scroller.hooks, scroller.hooks.eventTypes.end, this.checkPullDown);\n    this.registerHooks(this.scroll, this.scroll.eventTypes.scrollStart, this.resetStateBeforeScrollStart);\n    this.registerHooks(this.scroll, this.scroll.eventTypes.scroll, this.checkLocationOfThresholdBoundary);\n\n    if (this.hasMouseWheelPlugin()) {\n      this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelStart, this.resetStateBeforeScrollStart);\n    }\n  };\n\n  PullDown.prototype.resetStateBeforeScrollStart = function () {\n    // current fetching pulldownRefresh has ended\n    if (!this.isFetchingStatus()) {\n      this.setPulling(1\n      /* MOVING */\n      );\n      this.setThresholdBoundary(0\n      /* DEFAULT */\n      );\n    }\n  };\n\n  PullDown.prototype.checkLocationOfThresholdBoundary = function () {\n    // pulldownRefresh is in the phase of Moving\n    if (this.pulling === 1\n    /* MOVING */\n    ) {\n      var scroll_1 = this.scroll; // enter threshold boundary\n\n      var enteredThresholdBoundary = this.thresholdBoundary !== 1\n      /* INSIDE */\n      && this.locateInsideThresholdBoundary(); // leave threshold boundary\n\n      var leftThresholdBoundary = this.thresholdBoundary !== 2\n      /* OUTSIDE */\n      && !this.locateInsideThresholdBoundary();\n\n      if (enteredThresholdBoundary) {\n        this.setThresholdBoundary(1\n        /* INSIDE */\n        );\n        scroll_1.trigger(ENTER_THRESHOLD_EVENT);\n      }\n\n      if (leftThresholdBoundary) {\n        this.setThresholdBoundary(2\n        /* OUTSIDE */\n        );\n        scroll_1.trigger(LEAVE_THRESHOLD_EVENT);\n      }\n    }\n  };\n\n  PullDown.prototype.locateInsideThresholdBoundary = function () {\n    return this.scroll.y <= this.options.threshold;\n  };\n\n  PullDown.prototype.unwatch = function () {\n    var scroll = this.scroll;\n    var scroller = scroll.scroller;\n    this.watching = false;\n    scroller.hooks.off(scroller.hooks.eventTypes.end, this.checkPullDown);\n    scroll.off(scroll.eventTypes.scrollStart, this.resetStateBeforeScrollStart);\n    scroll.off(scroll.eventTypes.scroll, this.checkLocationOfThresholdBoundary);\n\n    if (this.hasMouseWheelPlugin()) {\n      scroll.off(scroll.eventTypes.mousewheelStart, this.resetStateBeforeScrollStart);\n    }\n  };\n\n  PullDown.prototype.checkPullDown = function () {\n    var _a = this.options,\n        threshold = _a.threshold,\n        stop = _a.stop; // check if a real pull down action\n\n    if (this.scroll.y < threshold) {\n      return false;\n    }\n\n    if (this.pulling === 1\n    /* MOVING */\n    ) {\n      this.modifyBehaviorYBoundary(stop);\n      this.setPulling(2\n      /* FETCHING */\n      );\n      this.scroll.trigger(PULLING_DOWN_EVENT);\n    }\n\n    this.scroll.scrollTo(this.scroll.x, stop, this.scroll.options.bounceTime, ease.bounce);\n    return this.isFetchingStatus();\n  };\n\n  PullDown.prototype.isFetchingStatus = function () {\n    return this.pulling === 2\n    /* FETCHING */\n    ;\n  };\n\n  PullDown.prototype.modifyBehaviorYBoundary = function (stopDistance) {\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY; // manually modify minScrollPos for a hang animation\n    // to prevent from resetPosition\n\n    this.cachedOriginanMinScrollY = scrollBehaviorY.minScrollPos;\n    this.currentMinScrollY = stopDistance;\n    scrollBehaviorY.computeBoundary();\n  };\n\n  PullDown.prototype.finishPullDown = function () {\n    if (this.isFetchingStatus()) {\n      var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY; // restore minScrollY since the hang animation has ended\n\n      this.currentMinScrollY = this.cachedOriginanMinScrollY;\n      scrollBehaviorY.computeBoundary();\n      this.setPulling(0\n      /* DEFAULT */\n      );\n      this.scroll.resetPosition(this.scroll.options.bounceTime, ease.bounce);\n    }\n  }; // allow 'true' type is compat for beta version implements\n\n\n  PullDown.prototype.openPullDown = function (config) {\n    if (config === void 0) {\n      config = {};\n    }\n\n    this.handleOptions(config);\n\n    if (!this.watching) {\n      this.watch();\n    }\n  };\n\n  PullDown.prototype.closePullDown = function () {\n    this.unwatch();\n  };\n\n  PullDown.prototype.autoPullDownRefresh = function () {\n    var _a = this.options,\n        threshold = _a.threshold,\n        stop = _a.stop;\n\n    if (this.isFetchingStatus() || !this.watching) {\n      return;\n    }\n\n    this.modifyBehaviorYBoundary(stop);\n    this.scroll.trigger(this.scroll.eventTypes.scrollStart);\n    this.scroll.scrollTo(this.scroll.x, threshold);\n    this.setPulling(2\n    /* FETCHING */\n    );\n    this.scroll.trigger(PULLING_DOWN_EVENT);\n    this.scroll.scrollTo(this.scroll.x, stop, this.scroll.options.bounceTime, ease.bounce);\n  };\n\n  PullDown.pluginName = 'pullDownRefresh';\n  return PullDown;\n}();\n\nvar sourcePrefix$5 = 'plugins.pullUpLoad';\nvar propertiesMap$5 = [{\n  key: 'finishPullUp',\n  name: 'finishPullUp'\n}, {\n  key: 'openPullUp',\n  name: 'openPullUp'\n}, {\n  key: 'closePullUp',\n  name: 'closePullUp'\n}, {\n  key: 'autoPullUpLoad',\n  name: 'autoPullUpLoad'\n}];\nvar propertiesConfig$5 = propertiesMap$5.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$5 + \".\" + item.name\n  };\n});\nvar PULL_UP_HOOKS_NAME = 'pullingUp';\n\nvar PullUp =\n/** @class */\nfunction () {\n  function PullUp(scroll) {\n    this.scroll = scroll;\n    this.pulling = false;\n    this.watching = false;\n    this.init();\n  }\n\n  PullUp.prototype.init = function () {\n    this.handleBScroll();\n    this.handleOptions(this.scroll.options.pullUpLoad);\n    this.handleHooks();\n    this.watch();\n  };\n\n  PullUp.prototype.handleBScroll = function () {\n    this.scroll.registerType([PULL_UP_HOOKS_NAME]);\n    this.scroll.proxy(propertiesConfig$5);\n  };\n\n  PullUp.prototype.handleOptions = function (userOptions) {\n    if (userOptions === void 0) {\n      userOptions = {};\n    }\n\n    userOptions = userOptions === true ? {} : userOptions;\n    var defaultOptions = {\n      threshold: 0\n    };\n    this.options = extend(defaultOptions, userOptions);\n    this.scroll.options.probeType = 3\n    /* Realtime */\n    ;\n  };\n\n  PullUp.prototype.handleHooks = function () {\n    var _this = this;\n\n    this.hooksFn = [];\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.contentChanged, function () {\n      _this.finishPullUp();\n    });\n    this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\n      // content is smaller than wrapper\n      if (boundary.maxScrollPos > 0) {\n        // allow scrolling when content is not full of wrapper\n        boundary.maxScrollPos = -1;\n      }\n    });\n  };\n\n  PullUp.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  PullUp.prototype.watch = function () {\n    if (this.watching) {\n      return;\n    }\n\n    this.watching = true;\n    this.registerHooks(this.scroll, this.scroll.eventTypes.scroll, this.checkPullUp);\n  };\n\n  PullUp.prototype.unwatch = function () {\n    this.watching = false;\n    this.scroll.off(this.scroll.eventTypes.scroll, this.checkPullUp);\n  };\n\n  PullUp.prototype.checkPullUp = function (pos) {\n    var _this = this;\n\n    var threshold = this.options.threshold;\n\n    if (this.scroll.movingDirectionY === 1\n    /* Positive */\n    && pos.y <= this.scroll.maxScrollY + threshold) {\n      this.pulling = true; // must reset pulling after scrollEnd\n\n      this.scroll.once(this.scroll.eventTypes.scrollEnd, function () {\n        _this.pulling = false;\n      });\n      this.unwatch();\n      this.scroll.trigger(PULL_UP_HOOKS_NAME);\n    }\n  };\n\n  PullUp.prototype.finishPullUp = function () {\n    var _this = this; // reset Direction, fix #936\n\n\n    this.scroll.scroller.scrollBehaviorY.setMovingDirection(0\n    /* Default */\n    );\n\n    if (this.pulling) {\n      this.scroll.once(this.scroll.eventTypes.scrollEnd, function () {\n        _this.watch();\n      });\n    } else {\n      this.watch();\n    }\n  }; // allow 'true' type is compat for beta version implements\n\n\n  PullUp.prototype.openPullUp = function (config) {\n    if (config === void 0) {\n      config = {};\n    }\n\n    this.handleOptions(config);\n    this.watch();\n  };\n\n  PullUp.prototype.closePullUp = function () {\n    this.unwatch();\n  };\n\n  PullUp.prototype.autoPullUpLoad = function () {\n    var threshold = this.options.threshold;\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\n\n    if (this.pulling || !this.watching) {\n      return;\n    } // simulate a pullUp action\n\n\n    var NEGATIVE_VALUE = -1;\n    var outOfBoundaryPos = scrollBehaviorY.maxScrollPos + threshold + NEGATIVE_VALUE;\n    this.scroll.scroller.scrollBehaviorY.setMovingDirection(NEGATIVE_VALUE);\n    this.scroll.scrollTo(this.scroll.x, outOfBoundaryPos, this.scroll.options.bounceTime);\n  };\n\n  PullUp.pluginName = 'pullUpLoad';\n  return PullUp;\n}();\n\nvar EventHandler =\n/** @class */\nfunction () {\n  function EventHandler(indicator, options) {\n    this.indicator = indicator;\n    this.options = options;\n    this.hooks = new EventEmitter(['touchStart', 'touchMove', 'touchEnd']);\n    this.registerEvents();\n  }\n\n  EventHandler.prototype.registerEvents = function () {\n    var _a = this.options,\n        disableMouse = _a.disableMouse,\n        disableTouch = _a.disableTouch;\n    var startEvents = [];\n    var moveEvents = [];\n    var endEvents = [];\n\n    if (!disableMouse) {\n      startEvents.push({\n        name: 'mousedown',\n        handler: this.start.bind(this)\n      });\n      moveEvents.push({\n        name: 'mousemove',\n        handler: this.move.bind(this)\n      });\n      endEvents.push({\n        name: 'mouseup',\n        handler: this.end.bind(this)\n      });\n    }\n\n    if (!disableTouch) {\n      startEvents.push({\n        name: 'touchstart',\n        handler: this.start.bind(this)\n      });\n      moveEvents.push({\n        name: 'touchmove',\n        handler: this.move.bind(this)\n      });\n      endEvents.push({\n        name: 'touchend',\n        handler: this.end.bind(this)\n      }, {\n        name: 'touchcancel',\n        handler: this.end.bind(this)\n      });\n    }\n\n    this.startEventRegister = new EventRegister(this.indicator.indicatorEl, startEvents);\n    this.moveEventRegister = new EventRegister(window, moveEvents);\n    this.endEventRegister = new EventRegister(window, endEvents);\n  };\n\n  EventHandler.prototype.BScrollIsDisabled = function () {\n    return !this.indicator.scroll.enabled;\n  };\n\n  EventHandler.prototype.start = function (e) {\n    if (this.BScrollIsDisabled()) {\n      return;\n    }\n\n    var point = e.touches ? e.touches[0] : e;\n    e.preventDefault();\n    e.stopPropagation();\n    this.initiated = true;\n    this.lastPoint = point[this.indicator.keysMap.point];\n    this.hooks.trigger(this.hooks.eventTypes.touchStart);\n  };\n\n  EventHandler.prototype.move = function (e) {\n    if (!this.initiated) {\n      return;\n    }\n\n    var point = e.touches ? e.touches[0] : e;\n    var pointPos = point[this.indicator.keysMap.point];\n    e.preventDefault();\n    e.stopPropagation();\n    var delta = pointPos - this.lastPoint;\n    this.lastPoint = pointPos;\n    this.hooks.trigger(this.hooks.eventTypes.touchMove, delta);\n  };\n\n  EventHandler.prototype.end = function (e) {\n    if (!this.initiated) {\n      return;\n    }\n\n    this.initiated = false;\n    e.preventDefault();\n    e.stopPropagation();\n    this.hooks.trigger(this.hooks.eventTypes.touchEnd);\n  };\n\n  EventHandler.prototype.destroy = function () {\n    this.startEventRegister.destroy();\n    this.moveEventRegister.destroy();\n    this.endEventRegister.destroy();\n  };\n\n  return EventHandler;\n}();\n\nvar Indicator$1 =\n/** @class */\nfunction () {\n  function Indicator(scroll, options) {\n    this.scroll = scroll;\n    this.options = options;\n    this.hooksFn = [];\n    this.wrapper = options.wrapper;\n    this.direction = options.direction;\n    this.indicatorEl = this.wrapper.children[0];\n    this.keysMap = this.getKeysMap();\n    this.handleFade();\n    this.handleHooks();\n  }\n\n  Indicator.prototype.handleFade = function () {\n    if (this.options.fade) {\n      this.wrapper.style.opacity = '0';\n    }\n  };\n\n  Indicator.prototype.handleHooks = function () {\n    var _this = this;\n\n    var _a = this.options,\n        fade = _a.fade,\n        interactive = _a.interactive,\n        scrollbarTrackClickable = _a.scrollbarTrackClickable;\n    var scroll = this.scroll;\n    var scrollHooks = scroll.hooks;\n    var translaterHooks = scroll.scroller.translater.hooks;\n    var animaterHooks = scroll.scroller.animater.hooks;\n    this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refresh);\n    this.registerHooks(translaterHooks, translaterHooks.eventTypes.translate, function (pos) {\n      var hasScrollKey = _this.keysMap.hasScroll;\n\n      if (_this.scroll[hasScrollKey]) {\n        _this.updatePosition(pos);\n      }\n    });\n    this.registerHooks(animaterHooks, animaterHooks.eventTypes.time, this.transitionTime);\n    this.registerHooks(animaterHooks, animaterHooks.eventTypes.timeFunction, this.transitionTimingFunction);\n\n    if (fade) {\n      this.registerHooks(scroll, scroll.eventTypes.scrollEnd, function () {\n        _this.fade();\n      });\n      this.registerHooks(scroll, scroll.eventTypes.scrollStart, function () {\n        _this.fade(true);\n      }); // for mousewheel event\n\n      if (scroll.eventTypes.mousewheelStart && scroll.eventTypes.mousewheelEnd) {\n        this.registerHooks(scroll, scroll.eventTypes.mousewheelStart, function () {\n          _this.fade(true);\n        });\n        this.registerHooks(scroll, scroll.eventTypes.mousewheelMove, function () {\n          _this.fade(true);\n        });\n        this.registerHooks(scroll, scroll.eventTypes.mousewheelEnd, function () {\n          _this.fade();\n        });\n      }\n    }\n\n    if (interactive) {\n      var _b = this.scroll.options,\n          disableMouse = _b.disableMouse,\n          disableTouch = _b.disableTouch;\n      this.eventHandler = new EventHandler(this, {\n        disableMouse: disableMouse,\n        disableTouch: disableTouch\n      });\n      var eventHandlerHooks = this.eventHandler.hooks;\n      this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchStart, this.startHandler);\n      this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchMove, this.moveHandler);\n      this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchEnd, this.endHandler);\n    }\n\n    if (scrollbarTrackClickable) {\n      this.bindClick();\n    }\n  };\n\n  Indicator.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  Indicator.prototype.bindClick = function () {\n    var wrapper = this.wrapper;\n    this.clickEventRegister = new EventRegister(wrapper, [{\n      name: 'click',\n      handler: this.handleClick.bind(this)\n    }]);\n  };\n\n  Indicator.prototype.handleClick = function (e) {\n    var newPos = this.calculateclickOffsetPos(e);\n    var _a = this.scroll,\n        x = _a.x,\n        y = _a.y;\n    x = this.direction === \"horizontal\"\n    /* Horizontal */\n    ? newPos : x;\n    y = this.direction === \"vertical\"\n    /* Vertical */\n    ? newPos : y;\n    this.scroll.scrollTo(x, y, this.options.scrollbarTrackOffsetTime);\n  };\n\n  Indicator.prototype.calculateclickOffsetPos = function (e) {\n    var _a = this.keysMap,\n        poinKey = _a.point,\n        domRectKey = _a.domRect;\n    var scrollbarTrackOffsetType = this.options.scrollbarTrackOffsetType;\n    var clickPointOffset = e[poinKey] - this.wrapperRect[domRectKey];\n    var scrollToWhere = clickPointOffset < this.currentPos ? -1\n    /* Up */\n    : 1\n    /* Down */\n    ;\n    var delta = 0;\n    var currentPos = this.currentPos;\n\n    if (scrollbarTrackOffsetType === \"step\"\n    /* Step */\n    ) {\n      delta = this.scrollInfo.baseSize * scrollToWhere;\n    } else {\n      delta = 0;\n      currentPos = clickPointOffset;\n    }\n\n    return this.newPos(currentPos, delta, this.scrollInfo);\n  };\n\n  Indicator.prototype.getKeysMap = function () {\n    if (this.direction === \"vertical\"\n    /* Vertical */\n    ) {\n      return {\n        hasScroll: 'hasVerticalScroll',\n        size: 'height',\n        wrapperSize: 'clientHeight',\n        scrollerSize: 'scrollerHeight',\n        maxScrollPos: 'maxScrollY',\n        pos: 'y',\n        point: 'pageY',\n        translateProperty: 'translateY',\n        domRect: 'top'\n      };\n    }\n\n    return {\n      hasScroll: 'hasHorizontalScroll',\n      size: 'width',\n      wrapperSize: 'clientWidth',\n      scrollerSize: 'scrollerWidth',\n      maxScrollPos: 'maxScrollX',\n      pos: 'x',\n      point: 'pageX',\n      translateProperty: 'translateX',\n      domRect: 'left'\n    };\n  };\n\n  Indicator.prototype.fade = function (visible) {\n    var _a = this.options,\n        fadeInTime = _a.fadeInTime,\n        fadeOutTime = _a.fadeOutTime;\n    var time = visible ? fadeInTime : fadeOutTime;\n    var wrapper = this.wrapper;\n    wrapper.style[style.transitionDuration] = time + 'ms';\n    wrapper.style.opacity = visible ? '1' : '0';\n  };\n\n  Indicator.prototype.refresh = function () {\n    var hasScrollKey = this.keysMap.hasScroll;\n    var scroll = this.scroll;\n    var x = scroll.x,\n        y = scroll.y;\n    this.wrapperRect = this.wrapper.getBoundingClientRect();\n\n    if (this.canScroll(scroll[hasScrollKey])) {\n      var _a = this.keysMap,\n          wrapperSizeKey = _a.wrapperSize,\n          scrollerSizeKey = _a.scrollerSize,\n          maxScrollPosKey = _a.maxScrollPos;\n      this.scrollInfo = this.refreshScrollInfo(this.wrapper[wrapperSizeKey], scroll[scrollerSizeKey], scroll[maxScrollPosKey], this.indicatorEl[wrapperSizeKey]);\n      this.updatePosition({\n        x: x,\n        y: y\n      });\n    }\n  };\n\n  Indicator.prototype.transitionTime = function (time) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    this.indicatorEl.style[style.transitionDuration] = time + 'ms';\n  };\n\n  Indicator.prototype.transitionTimingFunction = function (easing) {\n    this.indicatorEl.style[style.transitionTimingFunction] = easing;\n  };\n\n  Indicator.prototype.canScroll = function (hasScroll) {\n    this.wrapper.style.display = hasScroll ? 'block' : 'none';\n    return hasScroll;\n  };\n\n  Indicator.prototype.refreshScrollInfo = function (wrapperSize, scrollerSize, maxScrollPos, indicatorElSize) {\n    var baseSize = Math.max(Math.round(wrapperSize * wrapperSize / (scrollerSize || wrapperSize || 1)), this.options.minSize);\n\n    if (this.options.isCustom) {\n      baseSize = indicatorElSize;\n    }\n\n    var maxIndicatorScrollPos = wrapperSize - baseSize; // sizeRatio is negative\n\n    var sizeRatio = maxIndicatorScrollPos / maxScrollPos;\n    return {\n      baseSize: baseSize,\n      maxScrollPos: maxIndicatorScrollPos,\n      minScrollPos: 0,\n      sizeRatio: sizeRatio\n    };\n  };\n\n  Indicator.prototype.updatePosition = function (point) {\n    var _a = this.caculatePosAndSize(point, this.scrollInfo),\n        pos = _a.pos,\n        size = _a.size;\n\n    this.refreshStyle(size, pos);\n    this.currentPos = pos;\n  };\n\n  Indicator.prototype.caculatePosAndSize = function (point, scrollInfo) {\n    var posKey = this.keysMap.pos;\n    var sizeRatio = scrollInfo.sizeRatio,\n        baseSize = scrollInfo.baseSize,\n        maxScrollPos = scrollInfo.maxScrollPos,\n        minScrollPos = scrollInfo.minScrollPos;\n    var minSize = this.options.minSize;\n    var pos = Math.round(sizeRatio * point[posKey]);\n    var size; // when out of boundary, slow down size reduction\n\n    if (pos < minScrollPos) {\n      size = Math.max(baseSize + pos * 3, minSize);\n      pos = minScrollPos;\n    } else if (pos > maxScrollPos) {\n      size = Math.max(baseSize - (pos - maxScrollPos) * 3, minSize);\n      pos = maxScrollPos + baseSize - size;\n    } else {\n      size = baseSize;\n    }\n\n    return {\n      pos: pos,\n      size: size\n    };\n  };\n\n  Indicator.prototype.refreshStyle = function (size, pos) {\n    var _a = this.keysMap,\n        translatePropertyKey = _a.translateProperty,\n        sizeKey = _a.size;\n    var translateZ = this.scroll.options.translateZ;\n    this.indicatorEl.style[sizeKey] = size + \"px\";\n    this.indicatorEl.style[style.transform] = translatePropertyKey + \"(\" + pos + \"px)\" + translateZ;\n  };\n\n  Indicator.prototype.startHandler = function () {\n    this.moved = false;\n    this.startTime = getNow();\n    this.transitionTime();\n    this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.beforeScrollStart);\n  };\n\n  Indicator.prototype.moveHandler = function (delta) {\n    if (!this.moved && !this.indicatorNotMoved(delta)) {\n      this.moved = true;\n      this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollStart);\n    }\n\n    if (this.moved) {\n      var newPos = this.newPos(this.currentPos, delta, this.scrollInfo);\n      this.syncBScroll(newPos);\n    }\n  };\n\n  Indicator.prototype.endHandler = function () {\n    if (this.moved) {\n      var _a = this.scroll,\n          x = _a.x,\n          y = _a.y;\n      this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollEnd, {\n        x: x,\n        y: y\n      });\n    }\n  };\n\n  Indicator.prototype.indicatorNotMoved = function (delta) {\n    var currentPos = this.currentPos;\n    var _a = this.scrollInfo,\n        maxScrollPos = _a.maxScrollPos,\n        minScrollPos = _a.minScrollPos;\n    var notMoved = currentPos === minScrollPos && delta <= 0 || currentPos === maxScrollPos && delta >= 0;\n    return notMoved;\n  };\n\n  Indicator.prototype.syncBScroll = function (newPos) {\n    var timestamp = getNow();\n    var _a = this.scroll,\n        x = _a.x,\n        y = _a.y,\n        options = _a.options,\n        scroller = _a.scroller,\n        maxScrollY = _a.maxScrollY,\n        minScrollY = _a.minScrollY,\n        maxScrollX = _a.maxScrollX,\n        minScrollX = _a.minScrollX;\n    var probeType = options.probeType,\n        momentumLimitTime = options.momentumLimitTime;\n    var position = {\n      x: x,\n      y: y\n    };\n\n    if (this.direction === \"vertical\"\n    /* Vertical */\n    ) {\n      position.y = between(newPos, maxScrollY, minScrollY);\n    } else {\n      position.x = between(newPos, maxScrollX, minScrollX);\n    }\n\n    scroller.translater.translate(position); // dispatch scroll in interval time\n\n    if (timestamp - this.startTime > momentumLimitTime) {\n      this.startTime = timestamp;\n\n      if (probeType === 1\n      /* Throttle */\n      ) {\n        scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, position);\n      }\n    } // dispatch scroll all the time\n\n\n    if (probeType > 1\n    /* Throttle */\n    ) {\n      scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, position);\n    }\n  };\n\n  Indicator.prototype.newPos = function (currentPos, delta, scrollInfo) {\n    var maxScrollPos = scrollInfo.maxScrollPos,\n        sizeRatio = scrollInfo.sizeRatio,\n        minScrollPos = scrollInfo.minScrollPos;\n    var newPos = currentPos + delta;\n    newPos = between(newPos, minScrollPos, maxScrollPos);\n    return Math.round(newPos / sizeRatio);\n  };\n\n  Indicator.prototype.destroy = function () {\n    var _a = this.options,\n        interactive = _a.interactive,\n        scrollbarTrackClickable = _a.scrollbarTrackClickable,\n        isCustom = _a.isCustom;\n\n    if (interactive) {\n      this.eventHandler.destroy();\n    }\n\n    if (scrollbarTrackClickable) {\n      this.clickEventRegister.destroy();\n    }\n\n    if (!isCustom) {\n      this.wrapper.parentNode.removeChild(this.wrapper);\n    }\n\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n    this.hooksFn.length = 0;\n  };\n\n  return Indicator;\n}();\n\nvar ScrollBar =\n/** @class */\nfunction () {\n  function ScrollBar(scroll) {\n    this.scroll = scroll;\n    this.handleOptions();\n    this.createIndicators();\n    this.handleHooks();\n  }\n\n  ScrollBar.prototype.handleHooks = function () {\n    var _this = this;\n\n    var scroll = this.scroll;\n    scroll.hooks.on(scroll.hooks.eventTypes.destroy, function () {\n      for (var _i = 0, _a = _this.indicators; _i < _a.length; _i++) {\n        var indicator = _a[_i];\n        indicator.destroy();\n      }\n    });\n  };\n\n  ScrollBar.prototype.handleOptions = function () {\n    var userOptions = this.scroll.options.scrollbar === true ? {} : this.scroll.options.scrollbar;\n    var defaultOptions = {\n      fade: true,\n      fadeInTime: 250,\n      fadeOutTime: 500,\n      interactive: false,\n      customElements: [],\n      minSize: 8,\n      scrollbarTrackClickable: false,\n      scrollbarTrackOffsetType: \"step\"\n      /* Step */\n      ,\n      scrollbarTrackOffsetTime: 300\n    };\n    this.options = extend(defaultOptions, userOptions);\n  };\n\n  ScrollBar.prototype.createIndicators = function () {\n    var indicatorOptions;\n    var scroll = this.scroll;\n    var indicators = [];\n    var scrollDirectionConfigKeys = ['scrollX', 'scrollY'];\n    var indicatorDirections = [\"horizontal\"\n    /* Horizontal */\n    , \"vertical\"\n    /* Vertical */\n    ];\n    var customScrollbarEls = this.options.customElements;\n\n    for (var i = 0; i < scrollDirectionConfigKeys.length; i++) {\n      var key = scrollDirectionConfigKeys[i]; // wanna scroll in specified direction\n\n      if (scroll.options[key]) {\n        var customElement = customScrollbarEls.shift();\n        var direction = indicatorDirections[i];\n        var isCustom = false;\n        var scrollbarWrapper = customElement ? customElement : this.createScrollbarElement(direction); // internal scrollbar\n\n        if (scrollbarWrapper !== customElement) {\n          scroll.wrapper.appendChild(scrollbarWrapper);\n        } else {\n          // custom scrollbar passed by users\n          isCustom = true;\n        }\n\n        indicatorOptions = _assign(_assign({\n          wrapper: scrollbarWrapper,\n          direction: direction\n        }, this.options), {\n          isCustom: isCustom\n        });\n        indicators.push(new Indicator$1(scroll, indicatorOptions));\n      }\n    }\n\n    this.indicators = indicators;\n  };\n\n  ScrollBar.prototype.createScrollbarElement = function (direction, scrollbarTrackClickable) {\n    if (scrollbarTrackClickable === void 0) {\n      scrollbarTrackClickable = this.options.scrollbarTrackClickable;\n    }\n\n    var scrollbarWrapperEl = document.createElement('div');\n    var scrollbarIndicatorEl = document.createElement('div');\n    scrollbarWrapperEl.style.cssText = 'position:absolute;z-index:9999;overflow:hidden;';\n    scrollbarIndicatorEl.style.cssText = 'box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px;';\n    scrollbarIndicatorEl.className = 'bscroll-indicator';\n\n    if (direction === \"horizontal\"\n    /* Horizontal */\n    ) {\n      scrollbarWrapperEl.style.cssText += 'height:7px;left:2px;right:2px;bottom:0;';\n      scrollbarIndicatorEl.style.height = '100%';\n      scrollbarWrapperEl.className = 'bscroll-horizontal-scrollbar';\n    } else {\n      scrollbarWrapperEl.style.cssText += 'width:7px;bottom:2px;top:2px;right:1px;';\n      scrollbarIndicatorEl.style.width = '100%';\n      scrollbarWrapperEl.className = 'bscroll-vertical-scrollbar';\n    }\n\n    if (!scrollbarTrackClickable) {\n      scrollbarWrapperEl.style.cssText += 'pointer-events:none;';\n    }\n\n    scrollbarWrapperEl.appendChild(scrollbarIndicatorEl);\n    return scrollbarWrapperEl;\n  };\n\n  ScrollBar.pluginName = 'scrollbar';\n  return ScrollBar;\n}();\n\nvar PagesMatrix =\n/** @class */\nfunction () {\n  function PagesMatrix(scroll) {\n    this.scroll = scroll;\n    this.init();\n  }\n\n  PagesMatrix.prototype.init = function () {\n    var scroller = this.scroll.scroller;\n    var scrollBehaviorX = scroller.scrollBehaviorX,\n        scrollBehaviorY = scroller.scrollBehaviorY;\n    this.wrapperWidth = scrollBehaviorX.wrapperSize;\n    this.wrapperHeight = scrollBehaviorY.wrapperSize;\n    this.scrollerHeight = scrollBehaviorY.contentSize;\n    this.scrollerWidth = scrollBehaviorX.contentSize;\n    this.pages = this.buildPagesMatrix(this.wrapperWidth, this.wrapperHeight);\n    this.pageLengthOfX = this.pages ? this.pages.length : 0;\n    this.pageLengthOfY = this.pages && this.pages[0] ? this.pages[0].length : 0;\n  };\n\n  PagesMatrix.prototype.getPageStats = function (pageX, pageY) {\n    return this.pages[pageX][pageY];\n  };\n\n  PagesMatrix.prototype.getNearestPageIndex = function (x, y) {\n    var pageX = 0;\n    var pageY = 0;\n    var l = this.pages.length;\n\n    for (; pageX < l - 1; pageX++) {\n      if (x >= this.pages[pageX][0].cx) {\n        break;\n      }\n    }\n\n    l = this.pages[pageX].length;\n\n    for (; pageY < l - 1; pageY++) {\n      if (y >= this.pages[0][pageY].cy) {\n        break;\n      }\n    }\n\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }; // (n x 1) matrix for horizontal scroll or\n  // (1 * n) matrix for vertical scroll\n\n\n  PagesMatrix.prototype.buildPagesMatrix = function (stepX, stepY) {\n    var pages = [];\n    var x = 0;\n    var y;\n    var cx;\n    var cy;\n    var i = 0;\n    var l;\n    var maxScrollPosX = this.scroll.scroller.scrollBehaviorX.maxScrollPos;\n    var maxScrollPosY = this.scroll.scroller.scrollBehaviorY.maxScrollPos;\n    cx = Math.round(stepX / 2);\n    cy = Math.round(stepY / 2);\n\n    while (x > -this.scrollerWidth) {\n      pages[i] = [];\n      l = 0;\n      y = 0;\n\n      while (y > -this.scrollerHeight) {\n        pages[i][l] = {\n          x: Math.max(x, maxScrollPosX),\n          y: Math.max(y, maxScrollPosY),\n          width: stepX,\n          height: stepY,\n          cx: x - cx,\n          cy: y - cy\n        };\n        y -= stepY;\n        l++;\n      }\n\n      x -= stepX;\n      i++;\n    }\n\n    return pages;\n  };\n\n  return PagesMatrix;\n}();\n\nvar BASE_PAGE = {\n  pageX: 0,\n  pageY: 0,\n  x: 0,\n  y: 0\n};\n\nvar SlidePages =\n/** @class */\nfunction () {\n  function SlidePages(scroll, slideOptions) {\n    this.scroll = scroll;\n    this.slideOptions = slideOptions;\n    this.slideX = false;\n    this.slideY = false;\n    this.currentPage = extend({}, BASE_PAGE);\n  }\n\n  SlidePages.prototype.refresh = function () {\n    this.pagesMatrix = new PagesMatrix(this.scroll);\n    this.checkSlideLoop();\n    this.currentPage = this.getAdjustedCurrentPage();\n  };\n\n  SlidePages.prototype.getAdjustedCurrentPage = function () {\n    var _a = this.currentPage,\n        pageX = _a.pageX,\n        pageY = _a.pageY; // page index should be handled\n    // because page counts may reduce\n\n    pageX = Math.min(pageX, this.pagesMatrix.pageLengthOfX - 1);\n    pageY = Math.min(pageY, this.pagesMatrix.pageLengthOfY - 1); // loop scene should also be respected\n    // because clonedNode will cause pageLength increasing\n\n    if (this.loopX) {\n      pageX = Math.min(pageX, this.pagesMatrix.pageLengthOfX - 2);\n    }\n\n    if (this.loopY) {\n      pageY = Math.min(pageY, this.pagesMatrix.pageLengthOfY - 2);\n    }\n\n    var _b = this.pagesMatrix.getPageStats(pageX, pageY),\n        x = _b.x,\n        y = _b.y;\n\n    return {\n      pageX: pageX,\n      pageY: pageY,\n      x: x,\n      y: y\n    };\n  };\n\n  SlidePages.prototype.setCurrentPage = function (newPage) {\n    this.currentPage = newPage;\n  };\n\n  SlidePages.prototype.getInternalPage = function (pageX, pageY) {\n    if (pageX >= this.pagesMatrix.pageLengthOfX) {\n      pageX = this.pagesMatrix.pageLengthOfX - 1;\n    } else if (pageX < 0) {\n      pageX = 0;\n    }\n\n    if (pageY >= this.pagesMatrix.pageLengthOfY) {\n      pageY = this.pagesMatrix.pageLengthOfY - 1;\n    } else if (pageY < 0) {\n      pageY = 0;\n    }\n\n    var _a = this.pagesMatrix.getPageStats(pageX, pageY),\n        x = _a.x,\n        y = _a.y;\n\n    return {\n      pageX: pageX,\n      pageY: pageY,\n      x: x,\n      y: y\n    };\n  };\n\n  SlidePages.prototype.getInitialPage = function (showFirstPage, firstInitialised) {\n    if (showFirstPage === void 0) {\n      showFirstPage = false;\n    }\n\n    if (firstInitialised === void 0) {\n      firstInitialised = false;\n    }\n\n    var _a = this.slideOptions,\n        startPageXIndex = _a.startPageXIndex,\n        startPageYIndex = _a.startPageYIndex;\n    var firstPageX = this.loopX ? 1 : 0;\n    var firstPageY = this.loopY ? 1 : 0;\n    var pageX = showFirstPage ? firstPageX : this.currentPage.pageX;\n    var pageY = showFirstPage ? firstPageY : this.currentPage.pageY;\n\n    if (firstInitialised) {\n      pageX = this.loopX ? startPageXIndex + 1 : startPageXIndex;\n      pageY = this.loopY ? startPageYIndex + 1 : startPageYIndex;\n    } else {\n      pageX = showFirstPage ? firstPageX : this.currentPage.pageX;\n      pageY = showFirstPage ? firstPageY : this.currentPage.pageY;\n    }\n\n    var _b = this.pagesMatrix.getPageStats(pageX, pageY),\n        x = _b.x,\n        y = _b.y;\n\n    return {\n      pageX: pageX,\n      pageY: pageY,\n      x: x,\n      y: y\n    };\n  };\n\n  SlidePages.prototype.getExposedPage = function (page) {\n    var exposedPage = extend({}, page); // only pageX or pageY need fix\n\n    if (this.loopX) {\n      exposedPage.pageX = this.fixedPage(exposedPage.pageX, this.pagesMatrix.pageLengthOfX - 2);\n    }\n\n    if (this.loopY) {\n      exposedPage.pageY = this.fixedPage(exposedPage.pageY, this.pagesMatrix.pageLengthOfY - 2);\n    }\n\n    return exposedPage;\n  };\n\n  SlidePages.prototype.getExposedPageByPageIndex = function (pageIndexX, pageIndexY) {\n    var page = {\n      pageX: pageIndexX,\n      pageY: pageIndexY\n    };\n\n    if (this.loopX) {\n      page.pageX = pageIndexX + 1;\n    }\n\n    if (this.loopY) {\n      page.pageY = pageIndexY + 1;\n    }\n\n    var _a = this.pagesMatrix.getPageStats(page.pageX, page.pageY),\n        x = _a.x,\n        y = _a.y;\n\n    return {\n      x: x,\n      y: y,\n      pageX: pageIndexX,\n      pageY: pageIndexY\n    };\n  };\n\n  SlidePages.prototype.getWillChangedPage = function (page) {\n    page = extend({}, page); // Page need fix\n\n    if (this.loopX) {\n      page.pageX = this.fixedPage(page.pageX, this.pagesMatrix.pageLengthOfX - 2);\n      page.x = this.pagesMatrix.getPageStats(page.pageX + 1, 0).x;\n    }\n\n    if (this.loopY) {\n      page.pageY = this.fixedPage(page.pageY, this.pagesMatrix.pageLengthOfY - 2);\n      page.y = this.pagesMatrix.getPageStats(0, page.pageY + 1).y;\n    }\n\n    return page;\n  };\n\n  SlidePages.prototype.fixedPage = function (page, realPageLen) {\n    var pageIndex = [];\n\n    for (var i = 0; i < realPageLen; i++) {\n      pageIndex.push(i);\n    }\n\n    pageIndex.unshift(realPageLen - 1);\n    pageIndex.push(0);\n    return pageIndex[page];\n  };\n\n  SlidePages.prototype.getPageStats = function () {\n    return this.pagesMatrix.getPageStats(this.currentPage.pageX, this.currentPage.pageY);\n  };\n\n  SlidePages.prototype.getValidPageIndex = function (x, y) {\n    var lastX = this.pagesMatrix.pageLengthOfX - 1;\n    var lastY = this.pagesMatrix.pageLengthOfY - 1;\n    var firstX = 0;\n    var firstY = 0;\n\n    if (this.loopX) {\n      x += 1;\n      firstX = firstX + 1;\n      lastX = lastX - 1;\n    }\n\n    if (this.loopY) {\n      y += 1;\n      firstY = firstY + 1;\n      lastY = lastY - 1;\n    }\n\n    x = between(x, firstX, lastX);\n    y = between(y, firstY, lastY);\n    return {\n      pageX: x,\n      pageY: y\n    };\n  };\n\n  SlidePages.prototype.nextPageIndex = function () {\n    return this.getPageIndexByDirection(\"positive\"\n    /* Positive */\n    );\n  };\n\n  SlidePages.prototype.prevPageIndex = function () {\n    return this.getPageIndexByDirection(\"negative\"\n    /* Negative */\n    );\n  };\n\n  SlidePages.prototype.getNearestPage = function (x, y) {\n    var pageIndex = this.pagesMatrix.getNearestPageIndex(x, y);\n    var pageX = pageIndex.pageX,\n        pageY = pageIndex.pageY;\n    var newX = this.pagesMatrix.getPageStats(pageX, 0).x;\n    var newY = this.pagesMatrix.getPageStats(0, pageY).y;\n    return {\n      x: newX,\n      y: newY,\n      pageX: pageX,\n      pageY: pageY\n    };\n  };\n\n  SlidePages.prototype.getPageByDirection = function (page, directionX, directionY) {\n    var pageX = page.pageX,\n        pageY = page.pageY;\n\n    if (pageX === this.currentPage.pageX) {\n      pageX = between(pageX + directionX, 0, this.pagesMatrix.pageLengthOfX - 1);\n    }\n\n    if (pageY === this.currentPage.pageY) {\n      pageY = between(pageY + directionY, 0, this.pagesMatrix.pageLengthOfY - 1);\n    }\n\n    var x = this.pagesMatrix.getPageStats(pageX, 0).x;\n    var y = this.pagesMatrix.getPageStats(0, pageY).y;\n    return {\n      x: x,\n      y: y,\n      pageX: pageX,\n      pageY: pageY\n    };\n  };\n\n  SlidePages.prototype.resetLoopPage = function () {\n    if (this.loopX) {\n      if (this.currentPage.pageX === 0) {\n        return {\n          pageX: this.pagesMatrix.pageLengthOfX - 2,\n          pageY: this.currentPage.pageY\n        };\n      }\n\n      if (this.currentPage.pageX === this.pagesMatrix.pageLengthOfX - 1) {\n        return {\n          pageX: 1,\n          pageY: this.currentPage.pageY\n        };\n      }\n    }\n\n    if (this.loopY) {\n      if (this.currentPage.pageY === 0) {\n        return {\n          pageX: this.currentPage.pageX,\n          pageY: this.pagesMatrix.pageLengthOfY - 2\n        };\n      }\n\n      if (this.currentPage.pageY === this.pagesMatrix.pageLengthOfY - 1) {\n        return {\n          pageX: this.currentPage.pageX,\n          pageY: 1\n        };\n      }\n    }\n  };\n\n  SlidePages.prototype.getPageIndexByDirection = function (direction) {\n    var x = this.currentPage.pageX;\n    var y = this.currentPage.pageY;\n\n    if (this.slideX) {\n      x = direction === \"negative\"\n      /* Negative */\n      ? x - 1 : x + 1;\n    }\n\n    if (this.slideY) {\n      y = direction === \"negative\"\n      /* Negative */\n      ? y - 1 : y + 1;\n    }\n\n    return {\n      pageX: x,\n      pageY: y\n    };\n  };\n\n  SlidePages.prototype.checkSlideLoop = function () {\n    this.wannaLoop = this.slideOptions.loop;\n\n    if (this.pagesMatrix.pageLengthOfX > 1) {\n      this.slideX = true;\n    } else {\n      this.slideX = false;\n    }\n\n    if (this.pagesMatrix.pages[0] && this.pagesMatrix.pageLengthOfY > 1) {\n      this.slideY = true;\n    } else {\n      this.slideY = false;\n    }\n\n    this.loopX = this.wannaLoop && this.slideX;\n    this.loopY = this.wannaLoop && this.slideY;\n\n    if (this.slideX && this.slideY) {\n      warn('slide does not support two direction at the same time.');\n    }\n  };\n\n  return SlidePages;\n}();\n\nvar sourcePrefix$4 = 'plugins.slide';\nvar propertiesMap$4 = [{\n  key: 'next',\n  name: 'next'\n}, {\n  key: 'prev',\n  name: 'prev'\n}, {\n  key: 'goToPage',\n  name: 'goToPage'\n}, {\n  key: 'getCurrentPage',\n  name: 'getCurrentPage'\n}, {\n  key: 'startPlay',\n  name: 'startPlay'\n}, {\n  key: 'pausePlay',\n  name: 'pausePlay'\n}];\nvar propertiesConfig$4 = propertiesMap$4.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$4 + \".\" + item.name\n  };\n});\n\nvar samePage = function samePage(p1, p2) {\n  return p1.pageX === p2.pageX && p1.pageY === p2.pageY;\n};\n\nvar Slide =\n/** @class */\nfunction () {\n  function Slide(scroll) {\n    this.scroll = scroll;\n    this.cachedClonedPageDOM = [];\n    this.resetLooping = false;\n    this.autoplayTimer = 0;\n\n    if (!this.satisfyInitialization()) {\n      return;\n    }\n\n    this.init();\n  }\n\n  Slide.prototype.satisfyInitialization = function () {\n    if (this.scroll.scroller.content.children.length <= 0) {\n      warn(\"slide need at least one slide page to be initialised.\" + \"please check your DOM layout.\");\n      return false;\n    }\n\n    return true;\n  };\n\n  Slide.prototype.init = function () {\n    this.willChangeToPage = extend({}, BASE_PAGE);\n    this.handleBScroll();\n    this.handleOptions();\n    this.handleHooks();\n    this.createPages();\n  };\n\n  Slide.prototype.createPages = function () {\n    this.pages = new SlidePages(this.scroll, this.options);\n  };\n\n  Slide.prototype.handleBScroll = function () {\n    this.scroll.registerType(['slideWillChange', 'slidePageChanged']);\n    this.scroll.proxy(propertiesConfig$4);\n  };\n\n  Slide.prototype.handleOptions = function () {\n    var userOptions = this.scroll.options.slide === true ? {} : this.scroll.options.slide;\n    var defaultOptions = {\n      loop: true,\n      threshold: 0.1,\n      speed: 400,\n      easing: ease.bounce,\n      listenFlick: true,\n      autoplay: true,\n      interval: 3000,\n      startPageXIndex: 0,\n      startPageYIndex: 0\n    };\n    this.options = extend(defaultOptions, userOptions);\n  };\n\n  Slide.prototype.handleLoop = function (prevSlideContent) {\n    var loop = this.options.loop;\n    var slideContent = this.scroll.scroller.content;\n    var currentSlidePagesLength = slideContent.children.length; // only should respect loop scene\n\n    if (loop) {\n      if (slideContent !== prevSlideContent) {\n        this.resetLoopChangedStatus();\n        this.removeClonedSlidePage(prevSlideContent);\n        currentSlidePagesLength > 1 && this.cloneFirstAndLastSlidePage(slideContent);\n      } else {\n        // many pages reduce to one page\n        if (currentSlidePagesLength === 3 && this.initialised) {\n          this.removeClonedSlidePage(slideContent);\n          this.moreToOnePageInLoop = true;\n          this.oneToMorePagesInLoop = false;\n        } else if (currentSlidePagesLength > 1) {\n          // one page increases to many page\n          if (this.initialised && this.cachedClonedPageDOM.length === 0) {\n            this.oneToMorePagesInLoop = true;\n            this.moreToOnePageInLoop = false;\n          } else {\n            this.removeClonedSlidePage(slideContent);\n            this.resetLoopChangedStatus();\n          }\n\n          this.cloneFirstAndLastSlidePage(slideContent);\n        } else {\n          this.resetLoopChangedStatus();\n        }\n      }\n    }\n  };\n\n  Slide.prototype.resetLoopChangedStatus = function () {\n    this.moreToOnePageInLoop = false;\n    this.oneToMorePagesInLoop = false;\n  };\n\n  Slide.prototype.handleHooks = function () {\n    var _this = this;\n\n    var scrollHooks = this.scroll.hooks;\n    var scrollerHooks = this.scroll.scroller.hooks;\n    var listenFlick = this.options.listenFlick;\n    this.prevContent = this.scroll.scroller.content;\n    this.hooksFn = []; // scroll\n\n    this.registerHooks(this.scroll, this.scroll.eventTypes.beforeScrollStart, this.pausePlay);\n    this.registerHooks(this.scroll, this.scroll.eventTypes.scrollEnd, this.modifyCurrentPage);\n    this.registerHooks(this.scroll, this.scroll.eventTypes.scrollEnd, this.startPlay); // for mousewheel event\n\n    if (this.scroll.eventTypes.mousewheelMove) {\n      this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelMove, function () {\n        // prevent default action of mousewheelMove\n        return true;\n      });\n      this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelEnd, function (delta) {\n        if (delta.directionX === 1\n        /* Positive */\n        || delta.directionY === 1\n        /* Positive */\n        ) {\n          _this.next();\n        }\n\n        if (delta.directionX === -1\n        /* Negative */\n        || delta.directionY === -1\n        /* Negative */\n        ) {\n          _this.prev();\n        }\n      });\n    } // scrollHooks\n\n\n    this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refreshHandler);\n    this.registerHooks(scrollHooks, scrollHooks.eventTypes.destroy, this.destroy); // scroller\n\n    this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.beforeRefresh, function () {\n      _this.handleLoop(_this.prevContent);\n\n      _this.setSlideInlineStyle();\n    });\n    this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.momentum, this.modifyScrollMetaHandler);\n    this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.scroll, this.scrollHandler); // a click operation will clearTimer, so restart a new one\n\n    this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.checkClick, this.startPlay);\n\n    if (listenFlick) {\n      this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.flick, this.flickHandler);\n    }\n  };\n\n  Slide.prototype.startPlay = function () {\n    var _this = this;\n\n    var _a = this.options,\n        interval = _a.interval,\n        autoplay = _a.autoplay;\n\n    if (autoplay) {\n      clearTimeout(this.autoplayTimer);\n      this.autoplayTimer = window.setTimeout(function () {\n        _this.next();\n      }, interval);\n    }\n  };\n\n  Slide.prototype.pausePlay = function () {\n    if (this.options.autoplay) {\n      clearTimeout(this.autoplayTimer);\n    }\n  };\n\n  Slide.prototype.setSlideInlineStyle = function () {\n    var styleConfigurations = [{\n      direction: 'scrollX',\n      sizeType: 'offsetWidth',\n      styleType: 'width'\n    }, {\n      direction: 'scrollY',\n      sizeType: 'offsetHeight',\n      styleType: 'height'\n    }];\n    var _a = this.scroll.scroller,\n        slideContent = _a.content,\n        slideWrapper = _a.wrapper;\n    var scrollOptions = this.scroll.options;\n    styleConfigurations.forEach(function (_a) {\n      var direction = _a.direction,\n          sizeType = _a.sizeType,\n          styleType = _a.styleType; // wanna scroll in this direction\n\n      if (scrollOptions[direction]) {\n        var size = slideWrapper[sizeType];\n        var children = slideContent.children;\n        var length_1 = children.length;\n\n        for (var i = 0; i < length_1; i++) {\n          var slidePageDOM = children[i];\n          slidePageDOM.style[styleType] = size + 'px';\n        }\n\n        slideContent.style[styleType] = size * length_1 + 'px';\n      }\n    });\n  };\n\n  Slide.prototype.next = function (time, easing) {\n    var _a = this.pages.nextPageIndex(),\n        pageX = _a.pageX,\n        pageY = _a.pageY;\n\n    this.goTo(pageX, pageY, time, easing);\n  };\n\n  Slide.prototype.prev = function (time, easing) {\n    var _a = this.pages.prevPageIndex(),\n        pageX = _a.pageX,\n        pageY = _a.pageY;\n\n    this.goTo(pageX, pageY, time, easing);\n  };\n\n  Slide.prototype.goToPage = function (pageX, pageY, time, easing) {\n    var pageIndex = this.pages.getValidPageIndex(pageX, pageY);\n    this.goTo(pageIndex.pageX, pageIndex.pageY, time, easing);\n  };\n\n  Slide.prototype.getCurrentPage = function () {\n    return this.exposedPage || this.pages.getInitialPage(false, true);\n  };\n\n  Slide.prototype.setCurrentPage = function (page) {\n    this.pages.setCurrentPage(page);\n    this.exposedPage = this.pages.getExposedPage(page);\n  };\n\n  Slide.prototype.nearestPage = function (x, y) {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n    var maxScrollPosX = scrollBehaviorX.maxScrollPos,\n        minScrollPosX = scrollBehaviorX.minScrollPos;\n    var maxScrollPosY = scrollBehaviorY.maxScrollPos,\n        minScrollPosY = scrollBehaviorY.minScrollPos;\n    return this.pages.getNearestPage(between(x, maxScrollPosX, minScrollPosX), between(y, maxScrollPosY, minScrollPosY));\n  };\n\n  Slide.prototype.satisfyThreshold = function (x, y) {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n    var satisfied = true;\n\n    if (Math.abs(x - scrollBehaviorX.absStartPos) <= this.thresholdX && Math.abs(y - scrollBehaviorY.absStartPos) <= this.thresholdY) {\n      satisfied = false;\n    }\n\n    return satisfied;\n  };\n\n  Slide.prototype.refreshHandler = function (content) {\n    var _this = this;\n\n    if (!this.satisfyInitialization()) {\n      return;\n    }\n\n    this.pages.refresh();\n    this.computeThreshold();\n    var contentChanged = this.contentChanged = this.prevContent !== content;\n\n    if (contentChanged) {\n      this.prevContent = content;\n    }\n\n    var initPage = this.pages.getInitialPage(this.oneToMorePagesInLoop || this.moreToOnePageInLoop, contentChanged || !this.initialised);\n\n    if (this.initialised) {\n      this.goTo(initPage.pageX, initPage.pageY, 0);\n    } else {\n      this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.beforeInitialScrollTo, function (position) {\n        _this.initialised = true;\n        position.x = initPage.x;\n        position.y = initPage.y;\n      });\n    }\n\n    this.startPlay();\n  };\n\n  Slide.prototype.computeThreshold = function () {\n    var threshold = this.options.threshold; // Integer\n\n    if (threshold % 1 === 0) {\n      this.thresholdX = threshold;\n      this.thresholdY = threshold;\n    } else {\n      // decimal\n      var _a = this.pages.getPageStats(),\n          width = _a.width,\n          height = _a.height;\n\n      this.thresholdX = Math.round(width * threshold);\n      this.thresholdY = Math.round(height * threshold);\n    }\n  };\n\n  Slide.prototype.cloneFirstAndLastSlidePage = function (slideContent) {\n    var children = slideContent.children;\n    var preprendDOM = children[children.length - 1].cloneNode(true);\n    var appendDOM = children[0].cloneNode(true);\n    prepend(preprendDOM, slideContent);\n    slideContent.appendChild(appendDOM);\n    this.cachedClonedPageDOM = [preprendDOM, appendDOM];\n  };\n\n  Slide.prototype.removeClonedSlidePage = function (slideContent) {\n    // maybe slideContent has removed from DOM Tree\n    var slidePages = slideContent && slideContent.children || [];\n\n    if (slidePages.length) {\n      this.cachedClonedPageDOM.forEach(function (el) {\n        removeChild(slideContent, el);\n      });\n    }\n\n    this.cachedClonedPageDOM = [];\n  };\n\n  Slide.prototype.modifyCurrentPage = function (point) {\n    var _a = this.getCurrentPage(),\n        prevExposedPageX = _a.pageX,\n        prevExposedPageY = _a.pageY;\n\n    var newPage = this.nearestPage(point.x, point.y);\n    this.setCurrentPage(newPage);\n    /* istanbul ignore if */\n\n    if (this.contentChanged) {\n      this.contentChanged = false;\n      return true;\n    }\n\n    var _b = this.getCurrentPage(),\n        currentExposedPageX = _b.pageX,\n        currentExposedPageY = _b.pageY;\n\n    this.pageWillChangeTo(newPage); // loop is true, and one page becomes many pages when call bs.refresh\n\n    if (this.oneToMorePagesInLoop) {\n      this.oneToMorePagesInLoop = false;\n      return true;\n    } // loop is true, and many page becomes one page when call bs.refresh\n    // if prevPage > 0, dispatch slidePageChanged and scrollEnd events\n\n    /* istanbul ignore if */\n\n\n    if (this.moreToOnePageInLoop && prevExposedPageX === 0 && prevExposedPageY === 0) {\n      this.moreToOnePageInLoop = false;\n      return true;\n    }\n\n    if (prevExposedPageX !== currentExposedPageX || prevExposedPageY !== currentExposedPageY) {\n      // only trust pageX & pageY when loop is true\n      var page = this.pages.getExposedPageByPageIndex(currentExposedPageX, currentExposedPageY);\n      this.scroll.trigger(this.scroll.eventTypes.slidePageChanged, page);\n    } // triggered by resetLoop\n\n\n    if (this.resetLooping) {\n      this.resetLooping = false;\n      return;\n    }\n\n    var changePage = this.pages.resetLoopPage();\n\n    if (changePage) {\n      this.resetLooping = true;\n      this.goTo(changePage.pageX, changePage.pageY, 0); // stop user's scrollEnd\n      // since it is a seamless scroll\n\n      return true;\n    }\n  };\n\n  Slide.prototype.goTo = function (pageX, pageY, time, easing) {\n    var newPage = this.pages.getInternalPage(pageX, pageY);\n    var scrollEasing = easing || this.options.easing || ease.bounce;\n    var x = newPage.x,\n        y = newPage.y;\n    var deltaX = x - this.scroll.scroller.scrollBehaviorX.currentPos;\n    var deltaY = y - this.scroll.scroller.scrollBehaviorY.currentPos;\n    /* istanbul ignore if */\n\n    if (!deltaX && !deltaY) {\n      this.scroll.scroller.togglePointerEvents(true);\n      return;\n    }\n\n    time = time === undefined ? this.getEaseTime(deltaX, deltaY) : time;\n    this.scroll.scroller.scrollTo(x, y, time, scrollEasing);\n  };\n\n  Slide.prototype.flickHandler = function () {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n    var currentPosX = scrollBehaviorX.currentPos,\n        startPosX = scrollBehaviorX.startPos,\n        directionX = scrollBehaviorX.direction;\n    var currentPosY = scrollBehaviorY.currentPos,\n        startPosY = scrollBehaviorY.startPos,\n        directionY = scrollBehaviorY.direction;\n    var _b = this.pages.currentPage,\n        pageX = _b.pageX,\n        pageY = _b.pageY;\n    var time = this.getEaseTime(currentPosX - startPosX, currentPosY - startPosY);\n    this.goTo(pageX + directionX, pageY + directionY, time);\n  };\n\n  Slide.prototype.getEaseTime = function (deltaX, deltaY) {\n    return this.options.speed || Math.max(Math.max(Math.min(Math.abs(deltaX), 1000), Math.min(Math.abs(deltaY), 1000)), 300);\n  };\n\n  Slide.prototype.modifyScrollMetaHandler = function (scrollMeta) {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY,\n        animater = _a.animater;\n    var newX = scrollMeta.newX;\n    var newY = scrollMeta.newY;\n    var newPage = this.satisfyThreshold(newX, newY) || animater.forceStopped ? this.pages.getPageByDirection(this.nearestPage(newX, newY), scrollBehaviorX.direction, scrollBehaviorY.direction) : this.pages.currentPage;\n    scrollMeta.time = this.getEaseTime(scrollMeta.newX - newPage.x, scrollMeta.newY - newPage.y);\n    scrollMeta.newX = newPage.x;\n    scrollMeta.newY = newPage.y;\n    scrollMeta.easing = this.options.easing || ease.bounce;\n  };\n\n  Slide.prototype.scrollHandler = function (_a) {\n    var x = _a.x,\n        y = _a.y;\n\n    if (this.satisfyThreshold(x, y)) {\n      var newPage = this.nearestPage(x, y);\n      this.pageWillChangeTo(newPage);\n    }\n  };\n\n  Slide.prototype.pageWillChangeTo = function (newPage) {\n    var changeToPage = this.pages.getWillChangedPage(newPage);\n\n    if (!samePage(this.willChangeToPage, changeToPage)) {\n      this.willChangeToPage = changeToPage;\n      this.scroll.trigger(this.scroll.eventTypes.slideWillChange, this.willChangeToPage);\n    }\n  };\n\n  Slide.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  Slide.prototype.destroy = function () {\n    var slideContent = this.scroll.scroller.content;\n    var _a = this.options,\n        loop = _a.loop,\n        autoplay = _a.autoplay;\n\n    if (loop) {\n      this.removeClonedSlidePage(slideContent);\n    }\n\n    if (autoplay) {\n      clearTimeout(this.autoplayTimer);\n    }\n\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n\n      if (hooks.eventTypes[hooksName]) {\n        hooks.off(hooksName, handlerFn);\n      }\n    });\n    this.hooksFn.length = 0;\n  };\n\n  Slide.pluginName = 'slide';\n  return Slide;\n}();\n\nvar sourcePrefix$3 = 'plugins.wheel';\nvar propertiesMap$3 = [{\n  key: 'wheelTo',\n  name: 'wheelTo'\n}, {\n  key: 'getSelectedIndex',\n  name: 'getSelectedIndex'\n}, {\n  key: 'restorePosition',\n  name: 'restorePosition'\n}];\nvar propertiesConfig$3 = propertiesMap$3.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$3 + \".\" + item.name\n  };\n});\nvar WHEEL_INDEX_CHANGED_EVENT_NAME = 'wheelIndexChanged';\nvar CONSTANTS = {\n  rate: 4\n};\n\nvar Wheel =\n/** @class */\nfunction () {\n  function Wheel(scroll) {\n    this.scroll = scroll;\n    this.init();\n  }\n\n  Wheel.prototype.init = function () {\n    this.handleBScroll();\n    this.handleOptions();\n    this.handleHooks(); // init boundary for Wheel\n\n    this.refreshBoundary();\n    this.setSelectedIndex(this.options.selectedIndex);\n  };\n\n  Wheel.prototype.handleBScroll = function () {\n    this.scroll.proxy(propertiesConfig$3);\n    this.scroll.registerType([WHEEL_INDEX_CHANGED_EVENT_NAME]);\n  };\n\n  Wheel.prototype.handleOptions = function () {\n    var userOptions = this.scroll.options.wheel === true ? {} : this.scroll.options.wheel;\n    var defaultOptions = {\n      wheelWrapperClass: 'wheel-scroll',\n      wheelItemClass: 'wheel-item',\n      rotate: 25,\n      adjustTime: 400,\n      selectedIndex: 0,\n      wheelDisabledItemClass: 'wheel-disabled-item'\n    };\n    this.options = extend(defaultOptions, userOptions);\n  };\n\n  Wheel.prototype.handleHooks = function () {\n    var _this = this;\n\n    var scroll = this.scroll;\n    var scroller = this.scroll.scroller;\n    var actionsHandler = scroller.actionsHandler,\n        scrollBehaviorX = scroller.scrollBehaviorX,\n        scrollBehaviorY = scroller.scrollBehaviorY,\n        animater = scroller.animater;\n    var prevContent = scroller.content; // BScroll\n\n    scroll.on(scroll.eventTypes.scrollEnd, function (position) {\n      var index = _this.findNearestValidWheel(position.y).index;\n\n      if (scroller.animater.forceStopped && !_this.isAdjustingPosition) {\n        _this.target = _this.items[index]; // since stopped from an animation.\n        // prevent user's scrollEnd callback triggered twice\n\n        return true;\n      } else {\n        _this.setSelectedIndex(index);\n\n        if (_this.isAdjustingPosition) {\n          _this.isAdjustingPosition = false;\n        }\n      }\n    }); // BScroll.hooks\n\n    this.scroll.hooks.on(this.scroll.hooks.eventTypes.refresh, function (content) {\n      if (content !== prevContent) {\n        prevContent = content;\n\n        _this.setSelectedIndex(_this.options.selectedIndex, true);\n      } // rotate all wheel-items\n      // because position may not change\n\n\n      _this.rotateX(_this.scroll.y); // check we are stop at a disable item or not\n\n\n      _this.wheelTo(_this.selectedIndex, 0);\n    });\n    this.scroll.hooks.on(this.scroll.hooks.eventTypes.beforeInitialScrollTo, function (position) {\n      // selectedIndex has higher priority than bs.options.startY\n      position.x = 0;\n      position.y = -(_this.selectedIndex * _this.itemHeight);\n    }); // Scroller\n\n    scroller.hooks.on(scroller.hooks.eventTypes.checkClick, function () {\n      var index = HTMLCollectionToArray(_this.items).indexOf(_this.target);\n      if (index === -1) return true;\n\n      _this.wheelTo(index, _this.options.adjustTime, ease.swipe);\n\n      return true;\n    });\n    scroller.hooks.on(scroller.hooks.eventTypes.scrollTo, function (endPoint) {\n      endPoint.y = _this.findNearestValidWheel(endPoint.y).y;\n    }); // when content is scrolling\n    // click wheel-item DOM repeatedly and crazily will cause scrollEnd not triggered\n    // so reset forceStopped\n\n    scroller.hooks.on(scroller.hooks.eventTypes.minDistanceScroll, function () {\n      var animater = scroller.animater;\n\n      if (animater.forceStopped === true) {\n        animater.forceStopped = false;\n      }\n    });\n    scroller.hooks.on(scroller.hooks.eventTypes.scrollToElement, function (el, pos) {\n      if (!hasClass(el, _this.options.wheelItemClass)) {\n        return true;\n      } else {\n        pos.top = _this.findNearestValidWheel(pos.top).y;\n      }\n    }); // ActionsHandler\n\n    actionsHandler.hooks.on(actionsHandler.hooks.eventTypes.beforeStart, function (e) {\n      _this.target = e.target;\n    }); // ScrollBehaviorX\n    // Wheel has no x direction now\n\n    scrollBehaviorX.hooks.on(scrollBehaviorX.hooks.eventTypes.computeBoundary, function (boundary) {\n      boundary.maxScrollPos = 0;\n      boundary.minScrollPos = 0;\n    }); // ScrollBehaviorY\n\n    scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\n      _this.items = _this.scroll.scroller.content.children;\n\n      _this.checkWheelAllDisabled();\n\n      _this.itemHeight = _this.items.length > 0 ? scrollBehaviorY.contentSize / _this.items.length : 0;\n      boundary.maxScrollPos = -_this.itemHeight * (_this.items.length - 1);\n      boundary.minScrollPos = 0;\n    });\n    scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.momentum, function (momentumInfo) {\n      momentumInfo.rate = CONSTANTS.rate;\n      momentumInfo.destination = _this.findNearestValidWheel(momentumInfo.destination).y;\n    });\n    scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.end, function (momentumInfo) {\n      var validWheel = _this.findNearestValidWheel(scrollBehaviorY.currentPos);\n\n      momentumInfo.destination = validWheel.y;\n      momentumInfo.duration = _this.options.adjustTime;\n    }); // Animater\n\n    animater.hooks.on(animater.hooks.eventTypes.time, function (time) {\n      _this.transitionDuration(time);\n    });\n    animater.hooks.on(animater.hooks.eventTypes.timeFunction, function (easing) {\n      _this.timeFunction(easing);\n    }); // bs.stop() to make wheel stop at a correct position when pending\n\n    animater.hooks.on(animater.hooks.eventTypes.callStop, function () {\n      var index = _this.findNearestValidWheel(_this.scroll.y).index;\n\n      _this.isAdjustingPosition = true;\n\n      _this.wheelTo(index, 0);\n    }); // Translater\n\n    animater.translater.hooks.on(animater.translater.hooks.eventTypes.translate, function (endPoint) {\n      _this.rotateX(endPoint.y);\n    });\n  };\n\n  Wheel.prototype.refreshBoundary = function () {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY,\n        content = _a.content;\n    scrollBehaviorX.refresh(content);\n    scrollBehaviorY.refresh(content);\n  };\n\n  Wheel.prototype.setSelectedIndex = function (index, contentChanged) {\n    if (contentChanged === void 0) {\n      contentChanged = false;\n    }\n\n    var prevSelectedIndex = this.selectedIndex;\n    this.selectedIndex = index; // if content DOM changed, should not trigger event\n\n    if (prevSelectedIndex !== index && !contentChanged) {\n      this.scroll.trigger(WHEEL_INDEX_CHANGED_EVENT_NAME, index);\n    }\n  };\n\n  Wheel.prototype.getSelectedIndex = function () {\n    return this.selectedIndex;\n  };\n\n  Wheel.prototype.wheelTo = function (index, time, ease) {\n    if (index === void 0) {\n      index = 0;\n    }\n\n    if (time === void 0) {\n      time = 0;\n    }\n\n    var y = -index * this.itemHeight;\n    this.scroll.scrollTo(0, y, time, ease);\n  };\n\n  Wheel.prototype.restorePosition = function () {\n    // bs is scrolling\n    var isPending = this.scroll.pending;\n\n    if (isPending) {\n      var selectedIndex = this.getSelectedIndex();\n      this.scroll.scroller.animater.clearTimer();\n      this.wheelTo(selectedIndex, 0);\n    }\n  };\n\n  Wheel.prototype.transitionDuration = function (time) {\n    for (var i = 0; i < this.items.length; i++) {\n      this.items[i].style[style.transitionDuration] = time + 'ms';\n    }\n  };\n\n  Wheel.prototype.timeFunction = function (easing) {\n    for (var i = 0; i < this.items.length; i++) {\n      this.items[i].style[style.transitionTimingFunction] = easing;\n    }\n  };\n\n  Wheel.prototype.rotateX = function (y) {\n    var _a = this.options.rotate,\n        rotate = _a === void 0 ? 25 : _a;\n\n    for (var i = 0; i < this.items.length; i++) {\n      var deg = rotate * (y / this.itemHeight + i); // Too small value is invalid in some phones, issue 1026\n\n      var SafeDeg = deg.toFixed(3);\n      this.items[i].style[style.transform] = \"rotateX(\" + SafeDeg + \"deg)\";\n    }\n  };\n\n  Wheel.prototype.findNearestValidWheel = function (y) {\n    y = y > 0 ? 0 : y < this.scroll.maxScrollY ? this.scroll.maxScrollY : y;\n    var currentIndex = Math.abs(Math.round(-y / this.itemHeight));\n    var cacheIndex = currentIndex;\n    var items = this.items;\n    var wheelDisabledItemClassName = this.options.wheelDisabledItemClass; // implement web native select element\n    // first, check whether there is a enable item whose index is smaller than currentIndex\n    // then, check whether there is a enable item whose index is bigger than currentIndex\n    // otherwise, there are all disabled items, just keep currentIndex unchange\n\n    while (currentIndex >= 0) {\n      if (!hasClass(items[currentIndex], wheelDisabledItemClassName)) {\n        break;\n      }\n\n      currentIndex--;\n    }\n\n    if (currentIndex < 0) {\n      currentIndex = cacheIndex;\n\n      while (currentIndex <= items.length - 1) {\n        if (!hasClass(items[currentIndex], wheelDisabledItemClassName)) {\n          break;\n        }\n\n        currentIndex++;\n      }\n    } // keep it unchange when all the items are disabled\n\n\n    if (currentIndex === items.length) {\n      currentIndex = cacheIndex;\n    } // when all the items are disabled, selectedIndex should always be -1\n\n\n    return {\n      index: this.wheelItemsAllDisabled ? -1 : currentIndex,\n      y: -currentIndex * this.itemHeight\n    };\n  };\n\n  Wheel.prototype.checkWheelAllDisabled = function () {\n    var wheelDisabledItemClassName = this.options.wheelDisabledItemClass;\n    var items = this.items;\n    this.wheelItemsAllDisabled = true;\n\n    for (var i = 0; i < items.length; i++) {\n      if (!hasClass(items[i], wheelDisabledItemClassName)) {\n        this.wheelItemsAllDisabled = false;\n        break;\n      }\n    }\n  };\n\n  Wheel.pluginName = 'wheel';\n  return Wheel;\n}();\n\nvar sourcePrefix$2 = 'plugins.zoom';\nvar propertiesMap$2 = [{\n  key: 'zoomTo',\n  name: 'zoomTo'\n}];\nvar propertiesConfig$2 = propertiesMap$2.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$2 + \".\" + item.name\n  };\n});\nvar TWO_FINGERS = 2;\nvar RAW_SCALE = 1;\n\nvar Zoom =\n/** @class */\nfunction () {\n  function Zoom(scroll) {\n    this.scroll = scroll;\n    this.scale = RAW_SCALE;\n    this.prevScale = 1;\n    this.init();\n  }\n\n  Zoom.prototype.init = function () {\n    this.handleBScroll();\n    this.handleOptions();\n    this.handleHooks();\n    this.tryInitialZoomTo(this.zoomOpt);\n  };\n\n  Zoom.prototype.zoomTo = function (scale, x, y, bounceTime) {\n    var _a = this.resolveOrigin(x, y),\n        originX = _a.originX,\n        originY = _a.originY;\n\n    var origin = {\n      x: originX,\n      y: originY,\n      baseScale: this.scale\n    };\n\n    this._doZoomTo(scale, origin, bounceTime, true);\n  };\n\n  Zoom.prototype.handleBScroll = function () {\n    this.scroll.proxy(propertiesConfig$2);\n    this.scroll.registerType(['beforeZoomStart', 'zoomStart', 'zooming', 'zoomEnd']);\n  };\n\n  Zoom.prototype.handleOptions = function () {\n    var userOptions = this.scroll.options.zoom === true ? {} : this.scroll.options.zoom;\n    var defaultOptions = {\n      start: 1,\n      min: 1,\n      max: 4,\n      initialOrigin: [0, 0],\n      minimalZoomDistance: 5,\n      bounceTime: 800\n    };\n    this.zoomOpt = extend(defaultOptions, userOptions);\n  };\n\n  Zoom.prototype.handleHooks = function () {\n    var _this = this;\n\n    var scroll = this.scroll;\n    var scroller = this.scroll.scroller;\n    this.wrapper = this.scroll.scroller.wrapper;\n    this.setTransformOrigin(this.scroll.scroller.content);\n    var scrollBehaviorX = scroller.scrollBehaviorX;\n    var scrollBehaviorY = scroller.scrollBehaviorY;\n    this.hooksFn = []; // BScroll\n\n    this.registerHooks(scroll.hooks, scroll.hooks.eventTypes.contentChanged, function (content) {\n      _this.setTransformOrigin(content);\n\n      _this.scale = RAW_SCALE;\n\n      _this.tryInitialZoomTo(_this.zoomOpt);\n    });\n    this.registerHooks(scroll.hooks, scroll.hooks.eventTypes.beforeInitialScrollTo, function () {\n      // if perform a zoom action, we should prevent initial scroll when initialised\n      if (_this.zoomOpt.start !== RAW_SCALE) {\n        return true;\n      }\n    }); // enlarge boundary\n\n    this.registerHooks(scrollBehaviorX.hooks, scrollBehaviorX.hooks.eventTypes.beforeComputeBoundary, function () {\n      // content may change, don't cache it's size\n      var contentSize = getRect(_this.scroll.scroller.content);\n      scrollBehaviorX.contentSize = Math.floor(contentSize.width * _this.scale);\n    });\n    this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.beforeComputeBoundary, function () {\n      // content may change, don't cache it's size\n      var contentSize = getRect(_this.scroll.scroller.content);\n      scrollBehaviorY.contentSize = Math.floor(contentSize.height * _this.scale);\n    }); // touch event\n\n    this.registerHooks(scroller.actions.hooks, scroller.actions.hooks.eventTypes.start, function (e) {\n      var numberOfFingers = e.touches && e.touches.length || 0;\n\n      _this.fingersOperation(numberOfFingers);\n\n      if (numberOfFingers === TWO_FINGERS) {\n        _this.zoomStart(e);\n      }\n    });\n    this.registerHooks(scroller.actions.hooks, scroller.actions.hooks.eventTypes.beforeMove, function (e) {\n      var numberOfFingers = e.touches && e.touches.length || 0;\n\n      _this.fingersOperation(numberOfFingers);\n\n      if (numberOfFingers === TWO_FINGERS) {\n        _this.zoom(e);\n\n        return true;\n      }\n    });\n    this.registerHooks(scroller.actions.hooks, scroller.actions.hooks.eventTypes.beforeEnd, function (e) {\n      var numberOfFingers = _this.fingersOperation();\n\n      if (numberOfFingers === TWO_FINGERS) {\n        _this.zoomEnd();\n\n        return true;\n      }\n    });\n    this.registerHooks(scroller.translater.hooks, scroller.translater.hooks.eventTypes.beforeTranslate, function (transformStyle, point) {\n      var scale = point.scale ? point.scale : _this.prevScale;\n      _this.prevScale = scale;\n      transformStyle.push(\"scale(\" + scale + \")\");\n    });\n    this.registerHooks(scroller.hooks, scroller.hooks.eventTypes.scrollEnd, function () {\n      if (_this.fingersOperation() === TWO_FINGERS) {\n        _this.scroll.trigger(_this.scroll.eventTypes.zoomEnd, {\n          scale: _this.scale\n        });\n      }\n    });\n    this.registerHooks(this.scroll.hooks, 'destroy', this.destroy);\n  };\n\n  Zoom.prototype.setTransformOrigin = function (content) {\n    content.style[style.transformOrigin] = '0 0';\n  };\n\n  Zoom.prototype.tryInitialZoomTo = function (options) {\n    var start = options.start,\n        initialOrigin = options.initialOrigin;\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n\n    if (start !== RAW_SCALE) {\n      // Movable plugin may wanna modify minScrollPos or maxScrollPos\n      // so we force Movable to caculate them\n      this.resetBoundaries([scrollBehaviorX, scrollBehaviorY]);\n      this.zoomTo(start, initialOrigin[0], initialOrigin[1], 0);\n    }\n  }; // getter or setter operation\n\n\n  Zoom.prototype.fingersOperation = function (amounts) {\n    if (typeof amounts === 'number') {\n      this.numberOfFingers = amounts;\n    } else {\n      return this.numberOfFingers;\n    }\n  };\n\n  Zoom.prototype._doZoomTo = function (scale, origin, time, useCurrentPos) {\n    var _this = this;\n\n    if (time === void 0) {\n      time = this.zoomOpt.bounceTime;\n    }\n\n    if (useCurrentPos === void 0) {\n      useCurrentPos = false;\n    }\n\n    var _a = this.zoomOpt,\n        min = _a.min,\n        max = _a.max;\n    var fromScale = this.scale;\n    var toScale = between(scale, min, max);\n\n    (function () {\n      if (time === 0) {\n        _this.scroll.trigger(_this.scroll.eventTypes.zooming, {\n          scale: toScale\n        });\n\n        return;\n      }\n\n      if (time > 0) {\n        var timer_1;\n        var startTime_1 = getNow();\n        var endTime_1 = startTime_1 + time;\n\n        var scheduler_1 = function scheduler_1() {\n          var now = getNow();\n\n          if (now >= endTime_1) {\n            _this.scroll.trigger(_this.scroll.eventTypes.zooming, {\n              scale: toScale\n            });\n\n            cancelAnimationFrame(timer_1);\n            return;\n          }\n\n          var ratio = ease.bounce.fn((now - startTime_1) / time);\n          var currentScale = ratio * (toScale - fromScale) + fromScale;\n\n          _this.scroll.trigger(_this.scroll.eventTypes.zooming, {\n            scale: currentScale\n          });\n\n          timer_1 = requestAnimationFrame(scheduler_1);\n        }; // start scheduler job\n\n\n        scheduler_1();\n      }\n    })(); // suppose you are zooming by two fingers\n\n\n    this.fingersOperation(2);\n\n    this._zoomTo(toScale, fromScale, origin, time, useCurrentPos);\n  };\n\n  Zoom.prototype._zoomTo = function (toScale, fromScale, origin, time, useCurrentPos) {\n    if (useCurrentPos === void 0) {\n      useCurrentPos = false;\n    }\n\n    var ratio = toScale / origin.baseScale;\n    this.setScale(toScale);\n    var scroller = this.scroll.scroller;\n    var scrollBehaviorX = scroller.scrollBehaviorX,\n        scrollBehaviorY = scroller.scrollBehaviorY;\n    this.resetBoundaries([scrollBehaviorX, scrollBehaviorY]); // position is restrained in boundary\n\n    var newX = this.getNewPos(origin.x, ratio, scrollBehaviorX, true, useCurrentPos);\n    var newY = this.getNewPos(origin.y, ratio, scrollBehaviorY, true, useCurrentPos);\n\n    if (scrollBehaviorX.currentPos !== Math.round(newX) || scrollBehaviorY.currentPos !== Math.round(newY) || toScale !== fromScale) {\n      scroller.scrollTo(newX, newY, time, ease.bounce, {\n        start: {\n          scale: fromScale\n        },\n        end: {\n          scale: toScale\n        }\n      });\n    }\n  };\n\n  Zoom.prototype.resolveOrigin = function (x, y) {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n    var resolveFormula = {\n      left: function left() {\n        return 0;\n      },\n      top: function top() {\n        return 0;\n      },\n      right: function right() {\n        return scrollBehaviorX.contentSize;\n      },\n      bottom: function bottom() {\n        return scrollBehaviorY.contentSize;\n      },\n      center: function center(index) {\n        var baseSize = index === 0 ? scrollBehaviorX.contentSize : scrollBehaviorY.contentSize;\n        return baseSize / 2;\n      }\n    };\n    return {\n      originX: typeof x === 'number' ? x : resolveFormula[x](0),\n      originY: typeof y === 'number' ? y : resolveFormula[y](1)\n    };\n  };\n\n  Zoom.prototype.zoomStart = function (e) {\n    var firstFinger = e.touches[0];\n    var secondFinger = e.touches[1];\n    this.startDistance = this.getFingerDistance(e);\n    this.startScale = this.scale;\n\n    var _a = offsetToBody(this.wrapper),\n        left = _a.left,\n        top = _a.top;\n\n    this.origin = {\n      x: Math.abs(firstFinger.pageX + secondFinger.pageX) / 2 + left - this.scroll.x,\n      y: Math.abs(firstFinger.pageY + secondFinger.pageY) / 2 + top - this.scroll.y,\n      baseScale: this.startScale\n    };\n    this.scroll.trigger(this.scroll.eventTypes.beforeZoomStart);\n  };\n\n  Zoom.prototype.zoom = function (e) {\n    var currentDistance = this.getFingerDistance(e); // at least minimalZoomDistance pixels for the zoom to initiate\n\n    if (!this.zoomed && Math.abs(currentDistance - this.startDistance) < this.zoomOpt.minimalZoomDistance) {\n      return;\n    } // when out of boundary , perform a damping algorithm\n\n\n    var endScale = this.dampingScale(currentDistance / this.startDistance * this.startScale);\n    var ratio = endScale / this.startScale;\n    this.setScale(endScale);\n\n    if (!this.zoomed) {\n      this.zoomed = true;\n      this.scroll.trigger(this.scroll.eventTypes.zoomStart);\n    }\n\n    var scroller = this.scroll.scroller;\n    var scrollBehaviorX = scroller.scrollBehaviorX,\n        scrollBehaviorY = scroller.scrollBehaviorY;\n    var x = this.getNewPos(this.origin.x, ratio, scrollBehaviorX, false, false);\n    var y = this.getNewPos(this.origin.y, ratio, scrollBehaviorY, false, false);\n    this.scroll.trigger(this.scroll.eventTypes.zooming, {\n      scale: this.scale\n    });\n    scroller.translater.translate({\n      x: x,\n      y: y,\n      scale: endScale\n    });\n  };\n\n  Zoom.prototype.zoomEnd = function () {\n    if (!this.zoomed) return; // if out of boundary, do rebound!\n\n    if (this.shouldRebound()) {\n      this._doZoomTo(this.scale, this.origin, this.zoomOpt.bounceTime);\n\n      return;\n    }\n\n    this.scroll.trigger(this.scroll.eventTypes.zoomEnd, {\n      scale: this.scale\n    });\n  };\n\n  Zoom.prototype.getFingerDistance = function (e) {\n    var firstFinger = e.touches[0];\n    var secondFinger = e.touches[1];\n    var deltaX = Math.abs(firstFinger.pageX - secondFinger.pageX);\n    var deltaY = Math.abs(firstFinger.pageY - secondFinger.pageY);\n    return getDistance(deltaX, deltaY);\n  };\n\n  Zoom.prototype.shouldRebound = function () {\n    var _a = this.zoomOpt,\n        min = _a.min,\n        max = _a.max;\n    var currentScale = this.scale; // scale exceeded!\n\n    if (currentScale !== between(currentScale, min, max)) {\n      return true;\n    }\n\n    var _b = this.scroll.scroller,\n        scrollBehaviorX = _b.scrollBehaviorX,\n        scrollBehaviorY = _b.scrollBehaviorY; // enlarge boundaries manually when zoom is end\n\n    this.resetBoundaries([scrollBehaviorX, scrollBehaviorY]);\n    var xInBoundary = scrollBehaviorX.checkInBoundary().inBoundary;\n    var yInBoundary = scrollBehaviorX.checkInBoundary().inBoundary;\n    return !(xInBoundary && yInBoundary);\n  };\n\n  Zoom.prototype.dampingScale = function (scale) {\n    var _a = this.zoomOpt,\n        min = _a.min,\n        max = _a.max;\n\n    if (scale < min) {\n      scale = 0.5 * min * Math.pow(2.0, scale / min);\n    } else if (scale > max) {\n      scale = 2.0 * max * Math.pow(0.5, max / scale);\n    }\n\n    return scale;\n  };\n\n  Zoom.prototype.setScale = function (scale) {\n    this.scale = scale;\n  };\n\n  Zoom.prototype.resetBoundaries = function (scrollBehaviorPairs) {\n    scrollBehaviorPairs.forEach(function (behavior) {\n      return behavior.computeBoundary();\n    });\n  };\n\n  Zoom.prototype.getNewPos = function (origin, lastScale, scrollBehavior, shouldInBoundary, useCurrentPos) {\n    if (useCurrentPos === void 0) {\n      useCurrentPos = false;\n    }\n\n    var newPos = origin - origin * lastScale + (useCurrentPos ? scrollBehavior.currentPos : scrollBehavior.startPos);\n\n    if (shouldInBoundary) {\n      newPos = between(newPos, scrollBehavior.maxScrollPos, scrollBehavior.minScrollPos);\n    } // maxScrollPos or minScrollPos maybe a negative or positive digital\n\n\n    return newPos > 0 ? Math.floor(newPos) : Math.ceil(newPos);\n  };\n\n  Zoom.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  Zoom.prototype.destroy = function () {\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n    this.hooksFn.length = 0;\n  };\n\n  Zoom.pluginName = 'zoom';\n  return Zoom;\n}();\n\nvar BScrollFamily =\n/** @class */\nfunction () {\n  function BScrollFamily(scroll) {\n    this.ancestors = [];\n    this.descendants = [];\n    this.hooksManager = [];\n    this.analyzed = false;\n    this.selfScroll = scroll;\n  }\n\n  BScrollFamily.create = function (scroll) {\n    return new BScrollFamily(scroll);\n  };\n\n  BScrollFamily.prototype.hasAncestors = function (bscrollFamily) {\n    var index = findIndex(this.ancestors, function (_a) {\n      var item = _a[0];\n      return item === bscrollFamily;\n    });\n    return index > -1;\n  };\n\n  BScrollFamily.prototype.hasDescendants = function (bscrollFamily) {\n    var index = findIndex(this.descendants, function (_a) {\n      var item = _a[0];\n      return item === bscrollFamily;\n    });\n    return index > -1;\n  };\n\n  BScrollFamily.prototype.addAncestor = function (bscrollFamily, distance) {\n    var ancestors = this.ancestors;\n    ancestors.push([bscrollFamily, distance]); // by ascend\n\n    ancestors.sort(function (a, b) {\n      return a[1] - b[1];\n    });\n  };\n\n  BScrollFamily.prototype.addDescendant = function (bscrollFamily, distance) {\n    var descendants = this.descendants;\n    descendants.push([bscrollFamily, distance]); // by ascend\n\n    descendants.sort(function (a, b) {\n      return a[1] - b[1];\n    });\n  };\n\n  BScrollFamily.prototype.removeAncestor = function (bscrollFamily) {\n    var ancestors = this.ancestors;\n\n    if (ancestors.length) {\n      var index = findIndex(this.ancestors, function (_a) {\n        var item = _a[0];\n        return item === bscrollFamily;\n      });\n\n      if (index > -1) {\n        return ancestors.splice(index, 1);\n      }\n    }\n  };\n\n  BScrollFamily.prototype.removeDescendant = function (bscrollFamily) {\n    var descendants = this.descendants;\n\n    if (descendants.length) {\n      var index = findIndex(this.descendants, function (_a) {\n        var item = _a[0];\n        return item === bscrollFamily;\n      });\n\n      if (index > -1) {\n        return descendants.splice(index, 1);\n      }\n    }\n  };\n\n  BScrollFamily.prototype.registerHooks = function (hook, eventType, handler) {\n    hook.on(eventType, handler);\n    this.hooksManager.push([hook, eventType, handler]);\n  };\n\n  BScrollFamily.prototype.setAnalyzed = function (flag) {\n    if (flag === void 0) {\n      flag = false;\n    }\n\n    this.analyzed = flag;\n  };\n\n  BScrollFamily.prototype.purge = function () {\n    var _this = this; // remove self from graph\n\n\n    this.ancestors.forEach(function (_a) {\n      var bscrollFamily = _a[0];\n      bscrollFamily.removeDescendant(_this);\n    });\n    this.descendants.forEach(function (_a) {\n      var bscrollFamily = _a[0];\n      bscrollFamily.removeAncestor(_this);\n    }); // remove all hook handlers\n\n    this.hooksManager.forEach(function (_a) {\n      var hooks = _a[0],\n          eventType = _a[1],\n          handler = _a[2];\n      hooks.off(eventType, handler);\n    });\n    this.hooksManager = [];\n  };\n\n  return BScrollFamily;\n}();\n\nvar sourcePrefix$1 = 'plugins.nestedScroll';\nvar propertiesMap$1 = [{\n  key: 'purgeNestedScroll',\n  name: 'purgeNestedScroll'\n}];\nvar propertiesConfig$1 = propertiesMap$1.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$1 + \".\" + item.name\n  };\n});\nvar DEFAUL_GROUP_ID = 'INTERNAL_NESTED_SCROLL';\n\nvar forceScrollStopHandler = function forceScrollStopHandler(scrolls) {\n  scrolls.forEach(function (scroll) {\n    if (scroll.pending) {\n      scroll.stop();\n      scroll.resetPosition();\n    }\n  });\n};\n\nvar enableScrollHander = function enableScrollHander(scrolls) {\n  scrolls.forEach(function (scroll) {\n    scroll.enable();\n  });\n};\n\nvar disableScrollHander = function disableScrollHander(scrolls, currentScroll) {\n  scrolls.forEach(function (scroll) {\n    if (scroll.hasHorizontalScroll === currentScroll.hasHorizontalScroll || scroll.hasVerticalScroll === currentScroll.hasVerticalScroll) {\n      scroll.disable();\n    }\n  });\n};\n\nvar syncTouchstartData = function syncTouchstartData(scrolls) {\n  scrolls.forEach(function (scroll) {\n    var _a = scroll.scroller,\n        actions = _a.actions,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY; // prevent click triggering many times\n\n    actions.fingerMoved = true;\n    actions.contentMoved = false;\n    actions.directionLockAction.reset();\n    scrollBehaviorX.start();\n    scrollBehaviorY.start();\n    scrollBehaviorX.resetStartPos();\n    scrollBehaviorY.resetStartPos();\n    actions.startTime = +new Date();\n  });\n};\n\nvar isOutOfBoundary = function isOutOfBoundary(scroll) {\n  var hasHorizontalScroll = scroll.hasHorizontalScroll,\n      hasVerticalScroll = scroll.hasVerticalScroll,\n      x = scroll.x,\n      y = scroll.y,\n      minScrollX = scroll.minScrollX,\n      maxScrollX = scroll.maxScrollX,\n      minScrollY = scroll.minScrollY,\n      maxScrollY = scroll.maxScrollY,\n      movingDirectionX = scroll.movingDirectionX,\n      movingDirectionY = scroll.movingDirectionY;\n  var ret = false;\n  var outOfLeftBoundary = x >= minScrollX && movingDirectionX === -1\n  /* Negative */\n  ;\n  var outOfRightBoundary = x <= maxScrollX && movingDirectionX === 1\n  /* Positive */\n  ;\n  var outOfTopBoundary = y >= minScrollY && movingDirectionY === -1\n  /* Negative */\n  ;\n  var outOfBottomBoundary = y <= maxScrollY && movingDirectionY === 1\n  /* Positive */\n  ;\n\n  if (hasVerticalScroll) {\n    ret = outOfTopBoundary || outOfBottomBoundary;\n  } else if (hasHorizontalScroll) {\n    ret = outOfLeftBoundary || outOfRightBoundary;\n  }\n\n  return ret;\n};\n\nvar isResettingPosition = function isResettingPosition(scroll) {\n  var hasHorizontalScroll = scroll.hasHorizontalScroll,\n      hasVerticalScroll = scroll.hasVerticalScroll,\n      x = scroll.x,\n      y = scroll.y,\n      minScrollX = scroll.minScrollX,\n      maxScrollX = scroll.maxScrollX,\n      minScrollY = scroll.minScrollY,\n      maxScrollY = scroll.maxScrollY;\n  var ret = false;\n  var outOfLeftBoundary = x > minScrollX;\n  var outOfRightBoundary = x < maxScrollX;\n  var outOfTopBoundary = y > minScrollY;\n  var outOfBottomBoundary = y < maxScrollY;\n\n  if (hasVerticalScroll) {\n    ret = outOfTopBoundary || outOfBottomBoundary;\n  } else if (hasHorizontalScroll) {\n    ret = outOfLeftBoundary || outOfRightBoundary;\n  }\n\n  return ret;\n};\n\nvar resetPositionHandler = function resetPositionHandler(scroll) {\n  scroll.scroller.reflow();\n  scroll.resetPosition(0\n  /* Immediately */\n  );\n};\n\nvar calculateDistance = function calculateDistance(childNode, parentNode) {\n  var distance = 0;\n  var parent = childNode.parentNode;\n\n  while (parent && parent !== parentNode) {\n    distance++;\n    parent = parent.parentNode;\n  }\n\n  return distance;\n};\n\nvar NestedScroll =\n/** @class */\nfunction () {\n  function NestedScroll(scroll) {\n    var groupId = this.handleOptions(scroll);\n    var instance = NestedScroll.instancesMap[groupId];\n\n    if (!instance) {\n      instance = NestedScroll.instancesMap[groupId] = this;\n      instance.store = [];\n      instance.hooksFn = [];\n    }\n\n    instance.init(scroll);\n    return instance;\n  }\n\n  NestedScroll.getAllNestedScrolls = function () {\n    var instancesMap = NestedScroll.instancesMap;\n    return Object.keys(instancesMap).map(function (key) {\n      return instancesMap[key];\n    });\n  };\n\n  NestedScroll.purgeAllNestedScrolls = function () {\n    var nestedScrolls = NestedScroll.getAllNestedScrolls();\n    nestedScrolls.forEach(function (ns) {\n      return ns.purgeNestedScroll();\n    });\n  };\n\n  NestedScroll.prototype.handleOptions = function (scroll) {\n    var userOptions = scroll.options.nestedScroll === true ? {} : scroll.options.nestedScroll;\n    var defaultOptions = {\n      groupId: DEFAUL_GROUP_ID\n    };\n    this.options = extend(defaultOptions, userOptions);\n\n    var groupIdType = _typeof(this.options.groupId);\n\n    if (groupIdType !== 'string' && groupIdType !== 'number') {\n      warn('groupId must be string or number for NestedScroll plugin');\n    }\n\n    return this.options.groupId;\n  };\n\n  NestedScroll.prototype.init = function (scroll) {\n    scroll.proxy(propertiesConfig$1);\n    this.addBScroll(scroll);\n    this.buildBScrollGraph();\n    this.analyzeBScrollGraph();\n    this.ensureEventInvokeSequence();\n    this.handleHooks(scroll);\n  };\n\n  NestedScroll.prototype.handleHooks = function (scroll) {\n    var _this = this;\n\n    this.registerHooks(scroll.hooks, scroll.hooks.eventTypes.destroy, function () {\n      _this.deleteScroll(scroll);\n    });\n  };\n\n  NestedScroll.prototype.deleteScroll = function (scroll) {\n    var wrapper = scroll.wrapper;\n    wrapper.isBScrollContainer = undefined;\n    var store = this.store;\n    var hooksFn = this.hooksFn;\n    var i = findIndex(store, function (bscrollFamily) {\n      return bscrollFamily.selfScroll === scroll;\n    });\n\n    if (i > -1) {\n      var bscrollFamily = store[i];\n      bscrollFamily.purge();\n      store.splice(i, 1);\n    }\n\n    var k = findIndex(hooksFn, function (_a) {\n      var hooks = _a[0];\n      return hooks === scroll.hooks;\n    });\n\n    if (k > -1) {\n      var _a = hooksFn[k],\n          hooks = _a[0],\n          eventType = _a[1],\n          handler = _a[2];\n      hooks.off(eventType, handler);\n      hooksFn.splice(k, 1);\n    }\n  };\n\n  NestedScroll.prototype.addBScroll = function (scroll) {\n    this.store.push(BScrollFamily.create(scroll));\n  };\n\n  NestedScroll.prototype.buildBScrollGraph = function () {\n    var store = this.store;\n    var bf1;\n    var bf2;\n    var wrapper1;\n    var wrapper2;\n    var len = this.store.length; // build graph\n\n    for (var i = 0; i < len; i++) {\n      bf1 = store[i];\n      wrapper1 = bf1.selfScroll.wrapper;\n\n      for (var j = 0; j < len; j++) {\n        bf2 = store[j];\n        wrapper2 = bf2.selfScroll.wrapper; // same bs\n\n        if (bf1 === bf2) continue;\n        if (!wrapper1.contains(wrapper2)) continue; // bs1 contains bs2\n\n        var distance = calculateDistance(wrapper2, wrapper1);\n\n        if (!bf1.hasDescendants(bf2)) {\n          bf1.addDescendant(bf2, distance);\n        }\n\n        if (!bf2.hasAncestors(bf1)) {\n          bf2.addAncestor(bf1, distance);\n        }\n      }\n    }\n  };\n\n  NestedScroll.prototype.analyzeBScrollGraph = function () {\n    this.store.forEach(function (bscrollFamily) {\n      if (bscrollFamily.analyzed) {\n        return;\n      }\n\n      var ancestors = bscrollFamily.ancestors,\n          descendants = bscrollFamily.descendants,\n          currentScroll = bscrollFamily.selfScroll;\n\n      var beforeScrollStartHandler = function beforeScrollStartHandler() {\n        // always get the latest scroll\n        var ancestorScrolls = ancestors.map(function (_a) {\n          var bscrollFamily = _a[0];\n          return bscrollFamily.selfScroll;\n        });\n        var descendantScrolls = descendants.map(function (_a) {\n          var bscrollFamily = _a[0];\n          return bscrollFamily.selfScroll;\n        });\n        forceScrollStopHandler(__spreadArrays(ancestorScrolls, descendantScrolls));\n\n        if (isResettingPosition(currentScroll)) {\n          resetPositionHandler(currentScroll);\n        }\n\n        syncTouchstartData(ancestorScrolls);\n        disableScrollHander(ancestorScrolls, currentScroll);\n      };\n\n      var touchEndHandler = function touchEndHandler() {\n        var ancestorScrolls = ancestors.map(function (_a) {\n          var bscrollFamily = _a[0];\n          return bscrollFamily.selfScroll;\n        });\n        var descendantScrolls = descendants.map(function (_a) {\n          var bscrollFamily = _a[0];\n          return bscrollFamily.selfScroll;\n        });\n        enableScrollHander(__spreadArrays(ancestorScrolls, descendantScrolls));\n      };\n\n      bscrollFamily.registerHooks(currentScroll, currentScroll.eventTypes.beforeScrollStart, beforeScrollStartHandler);\n      bscrollFamily.registerHooks(currentScroll, currentScroll.eventTypes.touchEnd, touchEndHandler);\n      var selfActionsHooks = currentScroll.scroller.actions.hooks;\n      bscrollFamily.registerHooks(selfActionsHooks, selfActionsHooks.eventTypes.detectMovingDirection, function () {\n        var ancestorScrolls = ancestors.map(function (_a) {\n          var bscrollFamily = _a[0];\n          return bscrollFamily.selfScroll;\n        });\n        var parentScroll = ancestorScrolls[0];\n        var otherAncestorScrolls = ancestorScrolls.slice(1);\n        var contentMoved = currentScroll.scroller.actions.contentMoved;\n        var isTopScroll = ancestorScrolls.length === 0;\n\n        if (contentMoved) {\n          disableScrollHander(ancestorScrolls, currentScroll);\n        } else if (!isTopScroll) {\n          if (isOutOfBoundary(currentScroll)) {\n            disableScrollHander([currentScroll], currentScroll);\n\n            if (parentScroll) {\n              enableScrollHander([parentScroll]);\n            }\n\n            disableScrollHander(otherAncestorScrolls, currentScroll);\n            return true;\n          }\n        }\n      });\n      bscrollFamily.setAnalyzed(true);\n    });\n  }; // make sure touchmove|touchend invoke from child to parent\n\n\n  NestedScroll.prototype.ensureEventInvokeSequence = function () {\n    var copied = this.store.slice();\n    var sequencedScroll = copied.sort(function (a, b) {\n      return a.descendants.length - b.descendants.length;\n    });\n    sequencedScroll.forEach(function (bscrollFamily) {\n      var scroll = bscrollFamily.selfScroll;\n      scroll.scroller.actionsHandler.rebindDOMEvents();\n    });\n  };\n\n  NestedScroll.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  NestedScroll.prototype.purgeNestedScroll = function () {\n    var groupId = this.options.groupId;\n    this.store.forEach(function (bscrollFamily) {\n      bscrollFamily.purge();\n    });\n    this.store = [];\n    this.hooksFn.forEach(function (_a) {\n      var hooks = _a[0],\n          eventType = _a[1],\n          handler = _a[2];\n      hooks.off(eventType, handler);\n    });\n    this.hooksFn = [];\n    delete NestedScroll.instancesMap[groupId];\n  };\n\n  NestedScroll.pluginName = 'nestedScroll';\n  NestedScroll.instancesMap = {};\n  return NestedScroll;\n}();\n\nvar PRE_NUM = 10;\nvar POST_NUM = 30;\n\nvar IndexCalculator =\n/** @class */\nfunction () {\n  function IndexCalculator(wrapperHeight, tombstoneHeight) {\n    this.wrapperHeight = wrapperHeight;\n    this.tombstoneHeight = tombstoneHeight;\n    this.lastDirection = 1\n    /* DOWN */\n    ;\n    this.lastPos = 0;\n  }\n\n  IndexCalculator.prototype.calculate = function (pos, list) {\n    var offset = pos - this.lastPos;\n    this.lastPos = pos;\n    var direction = this.getDirection(offset); // important! start index is much more important than end index.\n\n    var start = this.calculateIndex(0, pos, list);\n    var end = this.calculateIndex(start, pos + this.wrapperHeight, list);\n\n    if (direction === 1\n    /* DOWN */\n    ) {\n      start -= PRE_NUM;\n      end += POST_NUM;\n    } else {\n      start -= POST_NUM;\n      end += PRE_NUM;\n    }\n\n    if (start < 0) {\n      start = 0;\n    }\n\n    return {\n      start: start,\n      end: end\n    };\n  };\n\n  IndexCalculator.prototype.getDirection = function (offset) {\n    var direction;\n\n    if (offset > 0) {\n      direction = 1\n      /* DOWN */\n      ;\n    } else if (offset < 0) {\n      direction = 0\n      /* UP */\n      ;\n    } else {\n      return this.lastDirection;\n    }\n\n    this.lastDirection = direction;\n    return direction;\n  };\n\n  IndexCalculator.prototype.calculateIndex = function (start, offset, list) {\n    if (offset <= 0) {\n      return start;\n    }\n\n    var i = start;\n    var startPos = list[i] && list[i].pos !== -1 ? list[i].pos : 0;\n    var lastPos = startPos;\n    var tombstone = 0;\n\n    while (i < list.length && list[i].pos < offset) {\n      lastPos = list[i].pos;\n      i++;\n    }\n\n    if (i === list.length) {\n      tombstone = Math.floor((offset - lastPos) / this.tombstoneHeight);\n    }\n\n    i += tombstone;\n    return i;\n  };\n\n  IndexCalculator.prototype.resetState = function () {\n    this.lastDirection = 1\n    /* DOWN */\n    ;\n    this.lastPos = 0;\n  };\n\n  return IndexCalculator;\n}();\n\nvar ListItem =\n/** @class */\nfunction () {\n  function ListItem() {\n    this.data = null;\n    this.dom = null;\n    this.tombstone = null;\n    this.width = 0;\n    this.height = 0;\n    this.pos = 0;\n  }\n\n  return ListItem;\n}();\n\nvar DataManager =\n/** @class */\nfunction () {\n  function DataManager(list, fetchFn, onFetchFinish) {\n    this.fetchFn = fetchFn;\n    this.onFetchFinish = onFetchFinish;\n    this.loadedNum = 0;\n    this.fetching = false;\n    this.hasMore = true;\n    this.list = list || [];\n  }\n\n  DataManager.prototype.update = function (end) {\n    return __awaiter(this, void 0, void 0, function () {\n      var len;\n      return __generator(this, function (_a) {\n        if (!this.hasMore) {\n          end = Math.min(end, this.list.length);\n        } // add data placeholder\n\n\n        if (end > this.list.length) {\n          len = end - this.list.length;\n          this.addEmptyData(len);\n        } // tslint:disable-next-line: no-floating-promises\n\n\n        return [2\n        /*return*/\n        , this.checkToFetch(end)];\n      });\n    });\n  };\n\n  DataManager.prototype.add = function (data) {\n    for (var i = 0; i < data.length; i++) {\n      if (!this.list[this.loadedNum]) {\n        this.list[this.loadedNum] = {\n          data: data[i]\n        };\n      } else {\n        this.list[this.loadedNum] = _assign(_assign({}, this.list[this.loadedNum]), {\n          data: data[i]\n        });\n      }\n\n      this.loadedNum++;\n    }\n\n    return this.list;\n  };\n\n  DataManager.prototype.addEmptyData = function (len) {\n    for (var i = 0; i < len; i++) {\n      this.list.push(new ListItem());\n    }\n\n    return this.list;\n  };\n\n  DataManager.prototype.fetch = function (len) {\n    return __awaiter(this, void 0, void 0, function () {\n      var data;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (this.fetching) {\n              return [2\n              /*return*/\n              , []];\n            }\n\n            this.fetching = true;\n            return [4\n            /*yield*/\n            , this.fetchFn(len)];\n\n          case 1:\n            data = _a.sent();\n            this.fetching = false;\n            return [2\n            /*return*/\n            , data];\n        }\n      });\n    });\n  };\n\n  DataManager.prototype.checkToFetch = function (end) {\n    return __awaiter(this, void 0, void 0, function () {\n      var min, newData, currentEnd;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!this.hasMore) {\n              return [2\n              /*return*/\n              ];\n            }\n\n            if (end <= this.loadedNum) {\n              return [2\n              /*return*/\n              ];\n            }\n\n            min = end - this.loadedNum;\n            return [4\n            /*yield*/\n            , this.fetch(min)];\n\n          case 1:\n            newData = _a.sent();\n\n            if (newData instanceof Array && newData.length) {\n              this.add(newData);\n              currentEnd = this.onFetchFinish(this.list, true);\n              return [2\n              /*return*/\n              , this.checkToFetch(currentEnd)];\n            } else if (typeof newData === 'boolean' && newData === false) {\n              this.hasMore = false;\n              this.list.splice(this.loadedNum);\n              this.onFetchFinish(this.list, false);\n            }\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  DataManager.prototype.getList = function () {\n    return this.list;\n  };\n\n  DataManager.prototype.resetState = function () {\n    this.loadedNum = 0;\n    this.fetching = false;\n    this.hasMore = true;\n    this.list = [];\n  };\n\n  return DataManager;\n}();\n\nvar Tombstone =\n/** @class */\nfunction () {\n  function Tombstone(create) {\n    this.create = create;\n    this.cached = [];\n    this.width = 0;\n    this.height = 0;\n    this.initialed = false;\n    this.getSize();\n  }\n\n  Tombstone.isTombstone = function (el) {\n    if (el && el.classList) {\n      return el.classList.contains('tombstone');\n    }\n\n    return false;\n  };\n\n  Tombstone.prototype.getSize = function () {\n    if (!this.initialed) {\n      var tombstone = this.create();\n      tombstone.style.position = 'absolute';\n      document.body.appendChild(tombstone);\n      tombstone.style.display = '';\n      this.height = tombstone.offsetHeight;\n      this.width = tombstone.offsetWidth;\n      document.body.removeChild(tombstone);\n      this.cached.push(tombstone);\n    }\n  };\n\n  Tombstone.prototype.getOne = function () {\n    var tombstone = this.cached.pop();\n\n    if (tombstone) {\n      var tombstoneStyle = tombstone.style;\n      tombstoneStyle.display = '';\n      tombstoneStyle.opacity = '1';\n      tombstoneStyle[style.transform] = '';\n      tombstoneStyle[style.transition] = '';\n      return tombstone;\n    }\n\n    return this.create();\n  };\n\n  Tombstone.prototype.recycle = function (tombstones) {\n    for (var _i = 0, tombstones_1 = tombstones; _i < tombstones_1.length; _i++) {\n      var tombstone = tombstones_1[_i];\n      tombstone.style.display = 'none';\n      this.cached.push(tombstone);\n    }\n\n    return this.cached;\n  };\n\n  Tombstone.prototype.recycleOne = function (tombstone) {\n    this.cached.push(tombstone);\n    return this.cached;\n  };\n\n  return Tombstone;\n}();\n\nvar ANIMATION_DURATION_MS = 200;\n\nvar DomManager =\n/** @class */\nfunction () {\n  function DomManager(content, renderFn, tombstone) {\n    this.renderFn = renderFn;\n    this.tombstone = tombstone;\n    this.unusedDom = [];\n    this.timers = [];\n    this.setContent(content);\n  }\n\n  DomManager.prototype.update = function (list, start, end) {\n    if (start >= list.length) {\n      start = list.length - 1;\n    }\n\n    if (end > list.length) {\n      end = list.length;\n    }\n\n    this.collectUnusedDom(list, start, end);\n    this.createDom(list, start, end);\n    this.cacheHeight(list, start, end);\n\n    var _a = this.positionDom(list, start, end),\n        startPos = _a.startPos,\n        startDelta = _a.startDelta,\n        endPos = _a.endPos;\n\n    return {\n      start: start,\n      startPos: startPos,\n      startDelta: startDelta,\n      end: end,\n      endPos: endPos\n    };\n  };\n\n  DomManager.prototype.collectUnusedDom = function (list, start, end) {\n    // TODO optimise\n    for (var i = 0; i < list.length; i++) {\n      if (i === start) {\n        i = end - 1;\n        continue;\n      }\n\n      if (list[i].dom) {\n        var dom = list[i].dom;\n\n        if (Tombstone.isTombstone(dom)) {\n          this.tombstone.recycleOne(dom);\n          dom.style.display = 'none';\n        } else {\n          this.unusedDom.push(dom);\n        }\n\n        list[i].dom = null;\n      }\n    }\n\n    return list;\n  };\n\n  DomManager.prototype.createDom = function (list, start, end) {\n    for (var i = start; i < end; i++) {\n      var dom = list[i].dom;\n      var data = list[i].data;\n\n      if (dom) {\n        if (Tombstone.isTombstone(dom) && data) {\n          list[i].tombstone = dom;\n          list[i].dom = null;\n        } else {\n          continue;\n        }\n      }\n\n      dom = data ? this.renderFn(data, this.unusedDom.pop()) : this.tombstone.getOne();\n      dom.style.position = 'absolute';\n      list[i].dom = dom;\n      list[i].pos = -1;\n      this.content.appendChild(dom);\n    }\n  };\n\n  DomManager.prototype.cacheHeight = function (list, start, end) {\n    for (var i = start; i < end; i++) {\n      if (list[i].data && !list[i].height) {\n        list[i].height = list[i].dom.offsetHeight;\n      }\n    }\n  };\n\n  DomManager.prototype.positionDom = function (list, start, end) {\n    var _this = this;\n\n    var tombstoneEles = [];\n\n    var _a = this.getStartPos(list, start, end),\n        startPos = _a.start,\n        startDelta = _a.delta;\n\n    var pos = startPos;\n\n    for (var i = start; i < end; i++) {\n      var tombstone = list[i].tombstone;\n\n      if (tombstone) {\n        var tombstoneStyle = tombstone.style;\n        tombstoneStyle[style.transition] = cssVendor + \"transform \" + ANIMATION_DURATION_MS + \"ms, opacity \" + ANIMATION_DURATION_MS + \"ms\";\n        tombstoneStyle[style.transform] = \"translateY(\" + pos + \"px)\";\n        tombstoneStyle.opacity = '0';\n        list[i].tombstone = null;\n        tombstoneEles.push(tombstone);\n      }\n\n      if (list[i].dom && list[i].pos !== pos) {\n        list[i].dom.style[style.transform] = \"translateY(\" + pos + \"px)\";\n        list[i].pos = pos;\n      }\n\n      pos += list[i].height || this.tombstone.height;\n    }\n\n    var timerId = window.setTimeout(function () {\n      _this.tombstone.recycle(tombstoneEles);\n    }, ANIMATION_DURATION_MS);\n    this.timers.push(timerId);\n    return {\n      startPos: startPos,\n      startDelta: startDelta,\n      endPos: pos\n    };\n  };\n\n  DomManager.prototype.getStartPos = function (list, start, end) {\n    if (list[start] && list[start].pos !== -1) {\n      return {\n        start: list[start].pos,\n        delta: 0\n      };\n    } // TODO optimise\n\n\n    var pos = list[0].pos === -1 ? 0 : list[0].pos;\n\n    for (var i_1 = 0; i_1 < start; i_1++) {\n      pos += list[i_1].height || this.tombstone.height;\n    }\n\n    var originPos = pos;\n    var i;\n\n    for (i = start; i < end; i++) {\n      if (!Tombstone.isTombstone(list[i].dom) && list[i].pos !== -1) {\n        pos = list[i].pos;\n        break;\n      }\n    }\n\n    var x = i;\n\n    if (x < end) {\n      while (x > start) {\n        pos -= list[x - 1].height;\n        x--;\n      }\n    }\n\n    var delta = originPos - pos;\n    return {\n      start: pos,\n      delta: delta\n    };\n  };\n\n  DomManager.prototype.removeTombstone = function () {\n    var tombstones = this.content.querySelectorAll('.tombstone');\n\n    for (var i = tombstones.length - 1; i >= 0; i--) {\n      this.content.removeChild(tombstones[i]);\n    }\n  };\n\n  DomManager.prototype.setContent = function (content) {\n    if (content !== this.content) {\n      this.content = content;\n    }\n  };\n\n  DomManager.prototype.destroy = function () {\n    this.removeTombstone();\n    this.timers.forEach(function (id) {\n      clearTimeout(id);\n    });\n  };\n\n  DomManager.prototype.resetState = function () {\n    this.destroy();\n    this.timers = [];\n    this.unusedDom = [];\n  };\n\n  return DomManager;\n}();\n\nvar EXTRA_SCROLL_Y = -2000;\n\nvar InfinityScroll =\n/** @class */\nfunction () {\n  function InfinityScroll(scroll) {\n    this.scroll = scroll;\n    this.start = 0;\n    this.end = 0;\n    this.init();\n  }\n\n  InfinityScroll.prototype.init = function () {\n    var _this = this;\n\n    this.handleOptions();\n    var _a = this.options,\n        fetchFn = _a.fetch,\n        renderFn = _a.render,\n        createTombstoneFn = _a.createTombstone;\n    this.tombstone = new Tombstone(createTombstoneFn);\n    this.indexCalculator = new IndexCalculator(this.scroll.scroller.scrollBehaviorY.wrapperSize, this.tombstone.height);\n    this.domManager = new DomManager(this.scroll.scroller.content, renderFn, this.tombstone);\n    this.dataManager = new DataManager([], fetchFn, this.onFetchFinish.bind(this));\n    this.scroll.on(this.scroll.eventTypes.destroy, this.destroy, this);\n    this.scroll.on(this.scroll.eventTypes.scroll, this.update, this);\n    this.scroll.on(this.scroll.eventTypes.contentChanged, function (content) {\n      _this.domManager.setContent(content);\n\n      _this.indexCalculator.resetState();\n\n      _this.domManager.resetState();\n\n      _this.dataManager.resetState();\n\n      _this.update({\n        y: 0\n      });\n    });\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\n    scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.computeBoundary, this.modifyBoundary, this);\n    this.update({\n      y: 0\n    });\n  };\n\n  InfinityScroll.prototype.modifyBoundary = function (boundary) {\n    // manually set position to allow scroll\n    boundary.maxScrollPos = EXTRA_SCROLL_Y;\n  };\n\n  InfinityScroll.prototype.handleOptions = function () {\n    // narrow down type to an object\n    var infinityOptions = this.scroll.options.infinity;\n\n    if (infinityOptions) {\n      if (typeof infinityOptions.fetch !== 'function') {\n        warn('Infinity plugin need fetch Function to new data.');\n      }\n\n      if (typeof infinityOptions.render !== 'function') {\n        warn('Infinity plugin need render Function to render each item.');\n      }\n\n      if (typeof infinityOptions.render !== 'function') {\n        warn('Infinity plugin need createTombstone Function to create tombstone.');\n      }\n\n      this.options = infinityOptions;\n    }\n\n    this.scroll.options.probeType = 3\n    /* Realtime */\n    ;\n  };\n\n  InfinityScroll.prototype.update = function (pos) {\n    var position = Math.round(-pos.y); // important! calculate start/end index to render\n\n    var _a = this.indexCalculator.calculate(position, this.dataManager.getList()),\n        start = _a.start,\n        end = _a.end;\n\n    this.start = start;\n    this.end = end; // tslint:disable-next-line: no-floating-promises\n\n    this.dataManager.update(end);\n    this.updateDom(this.dataManager.getList());\n  };\n\n  InfinityScroll.prototype.onFetchFinish = function (list, hasMore) {\n    var end = this.updateDom(list).end;\n\n    if (!hasMore) {\n      this.domManager.removeTombstone();\n      this.scroll.scroller.animater.stop();\n      this.scroll.resetPosition();\n    } // tslint:disable-next-line: no-floating-promises\n\n\n    return end;\n  };\n\n  InfinityScroll.prototype.updateDom = function (list) {\n    var _a = this.domManager.update(list, this.start, this.end),\n        end = _a.end,\n        startPos = _a.startPos,\n        endPos = _a.endPos,\n        startDelta = _a.startDelta;\n\n    if (startDelta) {\n      this.scroll.minScrollY = startDelta;\n    }\n\n    if (endPos > this.scroll.maxScrollY) {\n      this.scroll.maxScrollY = -(endPos - this.scroll.scroller.scrollBehaviorY.wrapperSize);\n    }\n\n    return {\n      end: end,\n      startPos: startPos,\n      endPos: endPos\n    };\n  };\n\n  InfinityScroll.prototype.destroy = function () {\n    var _a = this.scroll.scroller,\n        content = _a.content,\n        scrollBehaviorY = _a.scrollBehaviorY;\n\n    while (content.firstChild) {\n      content.removeChild(content.firstChild);\n    }\n\n    this.domManager.destroy();\n    this.scroll.off('scroll', this.update);\n    this.scroll.off('destroy', this.destroy);\n    scrollBehaviorY.hooks.off(scrollBehaviorY.hooks.eventTypes.computeBoundary);\n  };\n\n  InfinityScroll.pluginName = 'infinity';\n  return InfinityScroll;\n}();\n\nvar sourcePrefix = 'plugins.movable';\nvar propertiesMap = [{\n  key: 'putAt',\n  name: 'putAt'\n}];\nvar propertiesConfig = propertiesMap.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix + \".\" + item.name\n  };\n});\n\nvar Movable =\n/** @class */\nfunction () {\n  function Movable(scroll) {\n    this.scroll = scroll;\n    this.handleBScroll();\n    this.handleHooks();\n  }\n\n  Movable.prototype.handleBScroll = function () {\n    this.scroll.proxy(propertiesConfig);\n  };\n\n  Movable.prototype.handleHooks = function () {\n    var _this = this;\n\n    this.hooksFn = [];\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n\n    var computeBoundary = function computeBoundary(boundary, behavior) {\n      if (boundary.maxScrollPos > 0) {\n        // content is smaller than wrapper\n        boundary.minScrollPos = behavior.wrapperSize - behavior.contentSize;\n        boundary.maxScrollPos = 0;\n      }\n    };\n\n    this.registerHooks(scrollBehaviorX.hooks, scrollBehaviorX.hooks.eventTypes.ignoreHasScroll, function () {\n      return true;\n    });\n    this.registerHooks(scrollBehaviorX.hooks, scrollBehaviorX.hooks.eventTypes.computeBoundary, function (boundary) {\n      computeBoundary(boundary, scrollBehaviorX);\n    });\n    this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.ignoreHasScroll, function () {\n      return true;\n    });\n    this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\n      computeBoundary(boundary, scrollBehaviorY);\n    });\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.destroy, function () {\n      _this.destroy();\n    });\n  };\n\n  Movable.prototype.putAt = function (x, y, time, easing) {\n    if (time === void 0) {\n      time = this.scroll.options.bounceTime;\n    }\n\n    if (easing === void 0) {\n      easing = ease.bounce;\n    }\n\n    var position = this.resolvePostion(x, y);\n    this.scroll.scrollTo(position.x, position.y, time, easing);\n  };\n\n  Movable.prototype.resolvePostion = function (x, y) {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n    var resolveFormula = {\n      left: function left() {\n        return 0;\n      },\n      top: function top() {\n        return 0;\n      },\n      right: function right() {\n        return scrollBehaviorX.minScrollPos;\n      },\n      bottom: function bottom() {\n        return scrollBehaviorY.minScrollPos;\n      },\n      center: function center(index) {\n        var baseSize = index === 0 ? scrollBehaviorX.minScrollPos : scrollBehaviorY.minScrollPos;\n        return baseSize / 2;\n      }\n    };\n    return {\n      x: typeof x === 'number' ? x : resolveFormula[x](0),\n      y: typeof y === 'number' ? y : resolveFormula[y](1)\n    };\n  };\n\n  Movable.prototype.destroy = function () {\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n    this.hooksFn.length = 0;\n  };\n\n  Movable.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  Movable.pluginName = 'movable';\n  Movable.applyOrder = \"pre\"\n  /* Pre */\n  ;\n  return Movable;\n}();\n\nvar isImageTag = function isImageTag(el) {\n  return el.tagName.toLowerCase() === 'img';\n};\n\nvar ObserveImage =\n/** @class */\nfunction () {\n  function ObserveImage(scroll) {\n    this.scroll = scroll;\n    this.refreshTimer = 0;\n    this.init();\n  }\n\n  ObserveImage.prototype.init = function () {\n    this.handleOptions(this.scroll.options.observeImage);\n    this.bindEventsToWrapper();\n  };\n\n  ObserveImage.prototype.handleOptions = function (userOptions) {\n    if (userOptions === void 0) {\n      userOptions = {};\n    }\n\n    userOptions = userOptions === true ? {} : userOptions;\n    var defaultOptions = {\n      debounceTime: 100\n    };\n    this.options = extend(defaultOptions, userOptions);\n  };\n\n  ObserveImage.prototype.bindEventsToWrapper = function () {\n    var wrapper = this.scroll.scroller.wrapper;\n    this.imageLoadEventRegister = new EventRegister(wrapper, [{\n      name: 'load',\n      handler: this.load.bind(this),\n      capture: true\n    }]);\n    this.imageErrorEventRegister = new EventRegister(wrapper, [{\n      name: 'error',\n      handler: this.load.bind(this),\n      capture: true\n    }]);\n  };\n\n  ObserveImage.prototype.load = function (e) {\n    var _this = this;\n\n    var target = e.target;\n    var debounceTime = this.options.debounceTime;\n\n    if (target && isImageTag(target)) {\n      if (debounceTime === 0) {\n        this.scroll.refresh();\n      } else {\n        clearTimeout(this.refreshTimer);\n        this.refreshTimer = window.setTimeout(function () {\n          _this.scroll.refresh();\n        }, this.options.debounceTime);\n      }\n    }\n  };\n\n  ObserveImage.pluginName = 'observeImage';\n  return ObserveImage;\n}();\n\nvar resolveRatioOption = function resolveRatioOption(ratioConfig) {\n  var ret = {\n    ratioX: 0,\n    ratioY: 0\n  };\n  /* istanbul ignore if  */\n\n  if (!ratioConfig) {\n    return ret;\n  }\n\n  if (typeof ratioConfig === 'number') {\n    ret.ratioX = ret.ratioY = ratioConfig;\n  } else if (_typeof(ratioConfig) === 'object' && ratioConfig) {\n    ret.ratioX = ratioConfig.x || 0;\n    ret.ratioY = ratioConfig.y || 0;\n  }\n\n  return ret;\n};\n\nvar handleBubbleAndCancelable = function handleBubbleAndCancelable(e) {\n  e.preventDefault();\n  e.stopPropagation();\n};\n\nvar Indicator =\n/** @class */\nfunction () {\n  function Indicator(scroll, options) {\n    this.scroll = scroll;\n    this.options = options;\n    this.currentPos = {\n      x: 0,\n      y: 0\n    };\n    this.hooksFn = [];\n    this.handleDOM();\n    this.handleHooks();\n    this.handleInteractive();\n  }\n\n  Indicator.prototype.handleDOM = function () {\n    var _a = this.options,\n        relationElement = _a.relationElement,\n        _b = _a.relationElementHandleElementIndex,\n        relationElementHandleElementIndex = _b === void 0 ? 0 : _b;\n    this.wrapper = relationElement;\n    this.indicatorEl = this.wrapper.children[relationElementHandleElementIndex];\n  };\n\n  Indicator.prototype.handleHooks = function () {\n    var _this = this;\n\n    var scroll = this.scroll;\n    var scrollHooks = scroll.hooks;\n    var translaterHooks = scroll.scroller.translater.hooks;\n    var animaterHooks = scroll.scroller.animater.hooks;\n    this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refresh);\n    this.registerHooks(translaterHooks, translaterHooks.eventTypes.translate, function (pos) {\n      _this.updatePosition(pos);\n    });\n    this.registerHooks(animaterHooks, animaterHooks.eventTypes.time, this.transitionTime);\n    this.registerHooks(animaterHooks, animaterHooks.eventTypes.timeFunction, this.transitionTimingFunction);\n  };\n\n  Indicator.prototype.transitionTime = function (time) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    this.indicatorEl.style[style.transitionDuration] = time + 'ms';\n  };\n\n  Indicator.prototype.transitionTimingFunction = function (easing) {\n    this.indicatorEl.style[style.transitionTimingFunction] = easing;\n  };\n\n  Indicator.prototype.handleInteractive = function () {\n    if (this.options.interactive !== false) {\n      this.registerEvents();\n    }\n  };\n\n  Indicator.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  Indicator.prototype.registerEvents = function () {\n    var _a = this.scroll.options,\n        disableMouse = _a.disableMouse,\n        disableTouch = _a.disableTouch;\n    var startEvents = [];\n    var moveEvents = [];\n    var endEvents = [];\n\n    if (!disableMouse) {\n      startEvents.push({\n        name: 'mousedown',\n        handler: this.start.bind(this)\n      });\n      moveEvents.push({\n        name: 'mousemove',\n        handler: this.move.bind(this)\n      });\n      endEvents.push({\n        name: 'mouseup',\n        handler: this.end.bind(this)\n      });\n    }\n\n    if (!disableTouch) {\n      startEvents.push({\n        name: 'touchstart',\n        handler: this.start.bind(this)\n      });\n      moveEvents.push({\n        name: 'touchmove',\n        handler: this.move.bind(this)\n      });\n      endEvents.push({\n        name: 'touchend',\n        handler: this.end.bind(this)\n      }, {\n        name: 'touchcancel',\n        handler: this.end.bind(this)\n      });\n    }\n\n    this.startEventRegister = new EventRegister(this.indicatorEl, startEvents);\n    this.moveEventRegister = new EventRegister(window, moveEvents);\n    this.endEventRegister = new EventRegister(window, endEvents);\n  };\n\n  Indicator.prototype.refresh = function () {\n    var _a = this.scroll,\n        x = _a.x,\n        y = _a.y,\n        hasHorizontalScroll = _a.hasHorizontalScroll,\n        hasVerticalScroll = _a.hasVerticalScroll,\n        maxBScrollX = _a.maxScrollX,\n        maxBScrollY = _a.maxScrollY;\n\n    var _b = resolveRatioOption(this.options.ratio),\n        ratioX = _b.ratioX,\n        ratioY = _b.ratioY;\n\n    var _c = getClientSize(this.wrapper),\n        wrapperWidth = _c.width,\n        wrapperHeight = _c.height;\n\n    var _d = getRect(this.indicatorEl),\n        indicatorWidth = _d.width,\n        indicatorHeight = _d.height;\n\n    if (hasHorizontalScroll) {\n      this.maxScrollX = wrapperWidth - indicatorWidth;\n      this.translateXSign = this.maxScrollX > 0 ? -1\n      /* Positive */\n      : 1\n      /* NotPositive */\n      ;\n      this.minScrollX = 0; // ensure positive\n\n      this.ratioX = ratioX ? ratioX : Math.abs(this.maxScrollX / maxBScrollX);\n    }\n\n    if (hasVerticalScroll) {\n      this.maxScrollY = wrapperHeight - indicatorHeight;\n      this.translateYSign = this.maxScrollY > 0 ? -1\n      /* Positive */\n      : 1\n      /* NotPositive */\n      ;\n      this.minScrollY = 0;\n      this.ratioY = ratioY ? ratioY : Math.abs(this.maxScrollY / maxBScrollY);\n    }\n\n    this.updatePosition({\n      x: x,\n      y: y\n    });\n  };\n\n  Indicator.prototype.start = function (e) {\n    if (this.BScrollIsDisabled()) {\n      return;\n    }\n\n    var point = e.touches ? e.touches[0] : e;\n    handleBubbleAndCancelable(e);\n    this.initiated = true;\n    this.moved = false;\n    this.lastPointX = point.pageX;\n    this.lastPointY = point.pageY;\n    this.startTime = getNow();\n    this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.beforeScrollStart);\n  };\n\n  Indicator.prototype.BScrollIsDisabled = function () {\n    return !this.scroll.enabled;\n  };\n\n  Indicator.prototype.move = function (e) {\n    if (!this.initiated) {\n      return;\n    }\n\n    var point = e.touches ? e.touches[0] : e;\n    var pointX = point.pageX;\n    var pointY = point.pageY;\n    handleBubbleAndCancelable(e);\n    var deltaX = pointX - this.lastPointX;\n    var deltaY = pointY - this.lastPointY;\n    this.lastPointX = pointX;\n    this.lastPointY = pointY;\n\n    if (!this.moved && !this.indicatorNotMoved(deltaX, deltaY)) {\n      this.moved = true;\n      this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollStart);\n    }\n\n    if (this.moved) {\n      var newPos = this.getBScrollPosByRatio(this.currentPos, deltaX, deltaY);\n      this.syncBScroll(newPos);\n    }\n  };\n\n  Indicator.prototype.end = function (e) {\n    if (!this.initiated) {\n      return;\n    }\n\n    this.initiated = false;\n    handleBubbleAndCancelable(e);\n\n    if (this.moved) {\n      var _a = this.scroll,\n          x = _a.x,\n          y = _a.y;\n      this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollEnd, {\n        x: x,\n        y: y\n      });\n    }\n  };\n\n  Indicator.prototype.getBScrollPosByRatio = function (currentPos, deltaX, deltaY) {\n    var currentX = currentPos.x,\n        currentY = currentPos.y;\n    var _a = this.scroll,\n        hasHorizontalScroll = _a.hasHorizontalScroll,\n        hasVerticalScroll = _a.hasVerticalScroll,\n        BScrollMinScrollX = _a.minScrollX,\n        BScrollMaxScrollX = _a.maxScrollX,\n        BScrollMinScrollY = _a.minScrollY,\n        BScrollMaxScrollY = _a.maxScrollY;\n    var _b = this.scroll,\n        x = _b.x,\n        y = _b.y;\n\n    if (hasHorizontalScroll) {\n      var newPosX = between(currentX + deltaX, Math.min(this.minScrollX, this.maxScrollX), Math.max(this.minScrollX, this.maxScrollX));\n      var roundX = Math.round(newPosX / this.ratioX * this.translateXSign);\n      x = between(roundX, BScrollMaxScrollX, BScrollMinScrollX);\n    }\n\n    if (hasVerticalScroll) {\n      var newPosY = between(currentY + deltaY, Math.min(this.minScrollY, this.maxScrollY), Math.max(this.minScrollY, this.maxScrollY));\n      var roundY = Math.round(newPosY / this.ratioY * this.translateYSign);\n      y = between(roundY, BScrollMaxScrollY, BScrollMinScrollY);\n    }\n\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  Indicator.prototype.indicatorNotMoved = function (deltaX, deltaY) {\n    var _a = this.currentPos,\n        x = _a.x,\n        y = _a.y;\n    var xNotMoved = x === this.minScrollX && deltaX <= 0 || x === this.maxScrollX && deltaX >= 0;\n    var yNotMoved = y === this.minScrollY && deltaY <= 0 || y === this.maxScrollY && deltaY >= 0;\n    return xNotMoved && yNotMoved;\n  };\n\n  Indicator.prototype.syncBScroll = function (newPos) {\n    var timestamp = getNow();\n    var _a = this.scroll,\n        options = _a.options,\n        scroller = _a.scroller;\n    var probeType = options.probeType,\n        momentumLimitTime = options.momentumLimitTime;\n    scroller.translater.translate(newPos); // dispatch scroll in interval time\n\n    if (timestamp - this.startTime > momentumLimitTime) {\n      this.startTime = timestamp;\n\n      if (probeType === 1\n      /* Throttle */\n      ) {\n        scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, newPos);\n      }\n    } // dispatch scroll all the time\n\n\n    if (probeType > 1\n    /* Throttle */\n    ) {\n      scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, newPos);\n    }\n  };\n\n  Indicator.prototype.updatePosition = function (BScrollPos) {\n    var newIndicatorPos = this.getIndicatorPosByRatio(BScrollPos);\n    this.applyTransformProperty(newIndicatorPos);\n    this.currentPos = _assign({}, newIndicatorPos);\n  };\n\n  Indicator.prototype.applyTransformProperty = function (pos) {\n    var translateZ = this.scroll.options.translateZ;\n    var transformProperties = [\"translateX(\" + pos.x + \"px)\", \"translateY(\" + pos.y + \"px)\", \"\" + translateZ];\n    this.indicatorEl.style[style.transform] = transformProperties.join(' ');\n  };\n\n  Indicator.prototype.getIndicatorPosByRatio = function (BScrollPos) {\n    var x = BScrollPos.x,\n        y = BScrollPos.y;\n    var _a = this.scroll,\n        hasHorizontalScroll = _a.hasHorizontalScroll,\n        hasVerticalScroll = _a.hasVerticalScroll;\n\n    var position = _assign({}, this.currentPos);\n\n    if (hasHorizontalScroll) {\n      var roundX = Math.round(this.ratioX * x * this.translateXSign); // maybe maxScrollX is negative\n\n      position.x = between(roundX, Math.min(this.minScrollX, this.maxScrollX), Math.max(this.minScrollX, this.maxScrollX));\n    }\n\n    if (hasVerticalScroll) {\n      var roundY = Math.round(this.ratioY * y * this.translateYSign); // maybe maxScrollY is negative\n\n      position.y = between(roundY, Math.min(this.minScrollY, this.maxScrollY), Math.max(this.minScrollY, this.maxScrollY));\n    }\n\n    return position;\n  };\n\n  Indicator.prototype.destroy = function () {\n    if (this.options.interactive !== false) {\n      this.startEventRegister.destroy();\n      this.moveEventRegister.destroy();\n      this.endEventRegister.destroy();\n    }\n\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n    this.hooksFn.length = 0;\n  };\n\n  return Indicator;\n}();\n\nvar Indicators =\n/** @class */\nfunction () {\n  function Indicators(scroll) {\n    this.scroll = scroll;\n    this.options = [];\n    this.indicators = [];\n    this.handleOptions();\n    this.handleHooks();\n  }\n\n  Indicators.prototype.handleOptions = function () {\n    var UserIndicatorsOptions = this.scroll.options.indicators;\n    assert(Array.isArray(UserIndicatorsOptions), \"'indicators' must be an array.\");\n\n    for (var _i = 0, UserIndicatorsOptions_1 = UserIndicatorsOptions; _i < UserIndicatorsOptions_1.length; _i++) {\n      var indicatorOptions = UserIndicatorsOptions_1[_i];\n      assert(!!indicatorOptions.relationElement, \"'relationElement' must be a HTMLElement.\");\n      this.createIndicators(indicatorOptions);\n    }\n  };\n\n  Indicators.prototype.createIndicators = function (options) {\n    this.indicators.push(new Indicator(this.scroll, options));\n  };\n\n  Indicators.prototype.handleHooks = function () {\n    var _this = this;\n\n    var scrollHooks = this.scroll.hooks;\n    scrollHooks.on(scrollHooks.eventTypes.destroy, function () {\n      for (var _i = 0, _a = _this.indicators; _i < _a.length; _i++) {\n        var indicator = _a[_i];\n        indicator.destroy();\n      }\n\n      _this.indicators = [];\n    });\n  };\n\n  Indicators.pluginName = 'indicators';\n  return Indicators;\n}();\n\nBScroll.use(MouseWheel).use(ObserveDOM).use(PullDown).use(PullUp).use(ScrollBar).use(Slide).use(Wheel).use(Zoom).use(NestedScroll).use(InfinityScroll).use(Movable).use(ObserveImage).use(Indicators);\nexport default BScroll;\nexport { Behavior, CustomOptions, Indicators, InfinityScroll, MouseWheel, Movable, NestedScroll, ObserveDOM as ObserveDom, ObserveImage, PullDown as PullDownRefresh, PullUp as PullUpLoad, ScrollBar, Slide, Wheel, Zoom, createBScroll };","map":{"version":3,"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","__spreadArrays","il","r","k","a","j","jl","propertiesConfig$7","sourceKey","key","warn","msg","console","error","assert","condition","Error","inBrowser","window","ua","navigator","userAgent","toLowerCase","isWeChatDevTools","test","isAndroid","indexOf","isIOSBadVersion","regex","matches","exec","parts","split","map","item","parseInt","supportsPassive","EventName","opts","defineProperty","get","addEventListener","getNow","performance","now","timing","navigationStart","Date","extend","target","source","isUndef","undefined","getDistance","x","Math","sqrt","between","min","max","findIndex","ary","fn","index","some","ret","elementStyle","document","createElement","style","vendor","transformNames","_i","transformNames_1","obj","prefixStyle","charAt","toUpperCase","substr","getElement","el","querySelector","addEvent","type","capture","useCapture","passive","removeEvent","removeEventListener","offset","left","top","offsetLeft","offsetTop","offsetParent","offsetToBody","rect","getBoundingClientRect","pageXOffset","pageYOffset","cssVendor","transform","transition","hasPerspective","hasTouch","hasTransition","transitionTimingFunction","transitionDuration","transitionDelay","transformOrigin","transitionEnd","transitionProperty","eventTypeMap","touchstart","touchmove","touchend","touchcancel","mousedown","mousemove","mouseup","getRect","SVGElement","width","height","offsetWidth","offsetHeight","preventDefaultExceptionFn","exceptions","tagExceptionFn","tap","eventName","ev","createEvent","initEvent","pageX","pageY","dispatchEvent","click","event","eventSource","changedTouches","posSrc","screenX","screenY","clientX","clientY","bubbles","cancelable","ctrlKey","shiftKey","altKey","metaKey","pressedKeysMap","MouseEvent","forwardedTouchEvent","_constructed","dblclick","prepend","firstChild","before","appendChild","parentNode","insertBefore","removeChild","child","hasClass","className","reg","RegExp","HTMLCollectionToArray","slice","getClientSize","clientWidth","clientHeight","ease","swipe","swipeBounce","bounce","DEFAULT_INTERVAL","windowCompat","noop$1","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","callback","setTimeout","interval","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","id","clearTimeout","noop","val","sharedPropertyDefinition","enumerable","configurable","set","getProperty","keys","lastKey","setProperty","temp","propertiesProxy","proxyGetter","proxySetter","EventEmitter","names","events","eventTypes","registerType","on","context","hasType","once","_this","magic","args","off","count","splice","trigger","len","eventsCopy","event_1","forEach","destroy","types","isType","JSON","stringify","EventRegister","wrapper","addDOMEvents","removeDOMEvents","handleDOMEvents","eventOperation","name","handleEvent","eventType","handler","CustomOptions","OptionsConstructor","_super","startX","startY","scrollX","scrollY","freeScroll","directionLockThreshold","eventPassthrough","bottom","right","bounceTime","momentum","momentumLimitTime","momentumLimitDistance","swipeTime","swipeBounceTime","deceleration","flickLimitTime","flickLimitDistance","resizePolling","probeType","stopPropagation","preventDefault","preventDefaultException","tagName","tagException","HWCompositing","useTransition","bindToWrapper","bindToTarget","disableMouse","disableTouch","autoBlur","autoEndDistance","outOfBoundaryDampingFactor","specifiedIndexAsContent","quadrant","merge","options","resolveBounce","process","translateZ","bounceOptions","DEFAULT_BOUNCE","NEGATED_BOUNCE","ActionsHandler","hooks","_a","wrapperEvents","targetEvents","shouldRegisterTouch","shouldRegisterMouse","bind","start","move","end","wrapperEventRegister","targetEventRegister","beforeHandler","preventDefaultConditions","setInitiated","initiated","_eventType","button","beforeStart","point","touches","pointX","pointY","deltaX","deltaY","scrollLeft","documentElement","scrollTop","pX","pY","setContent","content","rebindDOMEvents","translaterMetaData","Translater","getComputedPosition","cssStyle","getComputedStyle","matrix","translate","transformStyle","transformFnName","transformFnArgUnit","transformFnArg","beforeTranslate","join","Base","translater","timer","endPoint","setPending","pending","setForceStopped","forceStopped","setCallStop","called","callStopWhenPending","stop","clearTimer","isValidPostion","startPoint","currentPos","prePos","computeDirection","endValue","startValue","delta","direction","directionX","directionY","Transition","startProbe","probe","pos","transitionTime","time","easing","timeFunction","easingFn","isRealtimeProbeType","_reflow","doStop","forceStop","stopFromTransition","callStop","Animation","animate","duration","startTime","destTime","newPoint","stopFromAnimation","createAnimater","element","animaterOptions","Behavior","refresh","dist","setMovingDirection","setDirection","hasScroll","performDampingAlgorithm","movingDirection","dampingFactor","newPos","minScrollPos","maxScrollPos","bounces","momentumInfo","absDist","abs","startPos","wrapperSize","destination","current","lowerMargin","upperMargin","distance","speed","momentumData","rate","round","updateDirection","absStartPos","size","position","isWrapperStatic","wrapperRect","contentRect","contentSize","relativeOffset","computeBoundary","resetState","resetStartPos","beforeComputeBoundary","boundary","scrollable","updatePosition","getCurrentPos","checkInBoundary","adjustPosition","inBoundary","ignoreHasScroll","updateStartPos","updateAbsStartPos","getAbsDist","_b","_c","_d","PassthroughHandlers","DirectionMap","DirectionLockAction","reset","directionLocked","checkMovingDirection","absDistX","absDistY","computeDirectionLock","handleEventPassthrough","adjustDelta","handleMap","applyQuadrantTransformation","ScrollerActions","scrollBehaviorX","scrollBehaviorY","actionsHandler","animater","directionLockAction","enabled","bindActionsHandler","handleStart","transformateDeltaX","transformateDeltaY","transformateDeltaData","coordinateTransformation","handleMove","handleEnd","handleClick","timestamp","fingerMoved","contentMoved","beforeMove","checkMomentum","prevX","newX","prevY","newY","detectMovingDirection","positionChanged","contentNotMoved","scrollStart","dispatchScroll","scroll","endTime","beforeEnd","ensureIntegerPos","scrollEnd","ensuringInteger","minScrollPosX","maxScrollPosX","minScrollPosY","maxScrollPosY","ceil","floor","createActionsHandlerOptions","bsOptions","reduce","prev","cur","createBehaviorOptions","extraProp","bubbling","sourceEvent","targetEvent","isSamePoint","keys_1","MIN_SCROLL_DISTANCE","Scroller","resizeTimeout","actions","resizeHandler","resize","resizeRegister","registerTransitionEnd","init","bindTranslater","bindAnimater","bindActions","togglePointerEvents","transitionEndRegister","prevPos","updatePositions","resetPosition","beforeScrollStart","touchEnd","scrollCancel","checkClick","checkFlick","flick","flickMinMovingDistance","meta","swiper","momentumX","momentumY","scrollTo","preventClick","_dblclick","dblclickTrigged","lastClickTime","delay","children","pointerEvents","node","isBScrollContainer","contentChanged","beforeRefresh","wrapperOffset","scrollBy","extraTransform","minDistanceScroll","scrollToElement","offsetX","offsetY","targetEle","getOffset","getPos","wrapperPos","scrollBehavior","xInBoundary","yInBoundary","reflow","enable","disable","BScrollConstructor","plugins","valid","use","ctor","pluginName","installed","plugin","pluginsMap","applyOrder","scroller","eventBubbling","handleAutoBlur","proxy","applyPlugins","refreshWithoutReset","beforeInitialScrollTo","sort","applyOrderMap","aOrder","bOrder","activeElement","blur","propertiesConfig","eventRegister","createBScroll","bs","BScroll","MouseWheel","wheelEndTimer","wheelMoveTimer","wheelStart","handleBScroll","handleOptions","handleHooks","registerEvent","userOptions","mouseWheel","defaultOptions","invert","easeTime","discreteTime","throttleTime","mouseWheelOpt","hooksFn","registerHooks","wheelHandler","wheelStartHandler","getWheelDelta","wheelMoveHandler","wheelEndDetector","cleanCache","alterOptions","mousewheelStart","deltaCache","cachedDelta","mousewheelMove","getEaseTime","mousewheelEnd","wheelDeltaX","wheelDeltaY","deltaMode","wheelDelta","detail","hasVerticalScroll","hasHorizontalScroll","SAFE_EASETIME","hooksName","handlerFn","ObserveDOM","stopObserver","handleMutationObserver","MutationObserver","timer_1","observer","mutations","mutationObserverHandler","startObserve","checkDOMUpdate","stopObserve","shouldNotRefresh","immediateRefresh","deferredRefresh","mutation","config","attributes","childList","subtree","observe","outsideBoundaries","oldWidth","oldHeight","check","newWidth","newHeight","disconnect","sourcePrefix$6","propertiesMap$6","propertiesConfig$6","PULLING_DOWN_EVENT","ENTER_THRESHOLD_EVENT","LEAVE_THRESHOLD_EVENT","PullDown","pulling","thresholdBoundary","setPulling","status","setThresholdBoundary","pullDownRefresh","watch","threshold","currentMinScrollY","cachedOriginanMinScrollY","finishPullDown","hasMouseWheelPlugin","mouseWheelOptions","SANE_DISCRETE_TIME","SANE_EASE_TIME","watching","checkPullDown","resetStateBeforeScrollStart","checkLocationOfThresholdBoundary","isFetchingStatus","scroll_1","enteredThresholdBoundary","locateInsideThresholdBoundary","leftThresholdBoundary","unwatch","modifyBehaviorYBoundary","stopDistance","openPullDown","closePullDown","autoPullDownRefresh","sourcePrefix$5","propertiesMap$5","propertiesConfig$5","PULL_UP_HOOKS_NAME","PullUp","pullUpLoad","finishPullUp","checkPullUp","movingDirectionY","maxScrollY","openPullUp","closePullUp","autoPullUpLoad","NEGATIVE_VALUE","outOfBoundaryPos","EventHandler","indicator","registerEvents","startEvents","moveEvents","endEvents","startEventRegister","indicatorEl","moveEventRegister","endEventRegister","BScrollIsDisabled","lastPoint","keysMap","touchStart","pointPos","touchMove","Indicator$1","Indicator","getKeysMap","handleFade","fade","opacity","interactive","scrollbarTrackClickable","scrollHooks","translaterHooks","animaterHooks","hasScrollKey","eventHandler","eventHandlerHooks","startHandler","moveHandler","endHandler","bindClick","clickEventRegister","calculateclickOffsetPos","scrollbarTrackOffsetTime","poinKey","domRectKey","domRect","scrollbarTrackOffsetType","clickPointOffset","scrollToWhere","scrollInfo","baseSize","scrollerSize","translateProperty","visible","fadeInTime","fadeOutTime","canScroll","wrapperSizeKey","scrollerSizeKey","maxScrollPosKey","refreshScrollInfo","display","indicatorElSize","minSize","isCustom","maxIndicatorScrollPos","sizeRatio","caculatePosAndSize","refreshStyle","posKey","translatePropertyKey","sizeKey","moved","indicatorNotMoved","syncBScroll","notMoved","minScrollY","maxScrollX","minScrollX","ScrollBar","createIndicators","indicators","scrollbar","customElements","indicatorOptions","scrollDirectionConfigKeys","indicatorDirections","customScrollbarEls","customElement","shift","scrollbarWrapper","createScrollbarElement","scrollbarWrapperEl","scrollbarIndicatorEl","cssText","PagesMatrix","wrapperWidth","wrapperHeight","scrollerHeight","scrollerWidth","pages","buildPagesMatrix","pageLengthOfX","pageLengthOfY","getPageStats","getNearestPageIndex","l","cx","cy","stepX","stepY","BASE_PAGE","SlidePages","slideOptions","slideX","slideY","currentPage","pagesMatrix","checkSlideLoop","getAdjustedCurrentPage","loopX","loopY","setCurrentPage","newPage","getInternalPage","getInitialPage","showFirstPage","firstInitialised","startPageXIndex","startPageYIndex","firstPageX","firstPageY","getExposedPage","page","exposedPage","fixedPage","getExposedPageByPageIndex","pageIndexX","pageIndexY","getWillChangedPage","realPageLen","pageIndex","unshift","getValidPageIndex","lastX","lastY","firstX","firstY","nextPageIndex","getPageIndexByDirection","prevPageIndex","getNearestPage","getPageByDirection","resetLoopPage","wannaLoop","loop","sourcePrefix$4","propertiesMap$4","propertiesConfig$4","samePage","p1","p2","Slide","cachedClonedPageDOM","resetLooping","autoplayTimer","satisfyInitialization","willChangeToPage","createPages","slide","listenFlick","autoplay","handleLoop","prevSlideContent","slideContent","currentSlidePagesLength","resetLoopChangedStatus","removeClonedSlidePage","cloneFirstAndLastSlidePage","initialised","moreToOnePageInLoop","oneToMorePagesInLoop","scrollerHooks","prevContent","pausePlay","modifyCurrentPage","startPlay","refreshHandler","setSlideInlineStyle","modifyScrollMetaHandler","scrollHandler","flickHandler","styleConfigurations","sizeType","styleType","slideWrapper","scrollOptions","length_1","slidePageDOM","goTo","goToPage","getCurrentPage","nearestPage","satisfyThreshold","satisfied","thresholdX","thresholdY","computeThreshold","initPage","preprendDOM","cloneNode","appendDOM","slidePages","prevExposedPageX","prevExposedPageY","currentExposedPageX","currentExposedPageY","pageWillChangeTo","slidePageChanged","changePage","scrollEasing","currentPosX","startPosX","currentPosY","startPosY","scrollMeta","changeToPage","slideWillChange","sourcePrefix$3","propertiesMap$3","propertiesConfig$3","WHEEL_INDEX_CHANGED_EVENT_NAME","CONSTANTS","Wheel","refreshBoundary","setSelectedIndex","selectedIndex","wheel","wheelWrapperClass","wheelItemClass","rotate","adjustTime","wheelDisabledItemClass","findNearestValidWheel","isAdjustingPosition","items","rotateX","wheelTo","itemHeight","checkWheelAllDisabled","validWheel","prevSelectedIndex","getSelectedIndex","restorePosition","isPending","deg","SafeDeg","toFixed","currentIndex","cacheIndex","wheelDisabledItemClassName","wheelItemsAllDisabled","sourcePrefix$2","propertiesMap$2","propertiesConfig$2","TWO_FINGERS","RAW_SCALE","Zoom","scale","prevScale","tryInitialZoomTo","zoomOpt","zoomTo","resolveOrigin","originX","originY","origin","baseScale","_doZoomTo","zoom","initialOrigin","minimalZoomDistance","setTransformOrigin","numberOfFingers","fingersOperation","zoomStart","zoomEnd","resetBoundaries","amounts","useCurrentPos","fromScale","toScale","zooming","startTime_1","endTime_1","scheduler_1","ratio","currentScale","_zoomTo","setScale","getNewPos","resolveFormula","center","firstFinger","secondFinger","startDistance","getFingerDistance","startScale","beforeZoomStart","currentDistance","zoomed","endScale","dampingScale","shouldRebound","pow","scrollBehaviorPairs","behavior","lastScale","shouldInBoundary","BScrollFamily","ancestors","descendants","hooksManager","analyzed","selfScroll","hasAncestors","bscrollFamily","hasDescendants","addAncestor","addDescendant","removeAncestor","removeDescendant","hook","setAnalyzed","flag","purge","sourcePrefix$1","propertiesMap$1","propertiesConfig$1","DEFAUL_GROUP_ID","forceScrollStopHandler","scrolls","enableScrollHander","disableScrollHander","currentScroll","syncTouchstartData","isOutOfBoundary","movingDirectionX","outOfLeftBoundary","outOfRightBoundary","outOfTopBoundary","outOfBottomBoundary","isResettingPosition","resetPositionHandler","calculateDistance","childNode","parent","NestedScroll","groupId","instance","instancesMap","store","getAllNestedScrolls","purgeAllNestedScrolls","nestedScrolls","ns","purgeNestedScroll","nestedScroll","groupIdType","addBScroll","buildBScrollGraph","analyzeBScrollGraph","ensureEventInvokeSequence","deleteScroll","bf1","bf2","wrapper1","wrapper2","contains","beforeScrollStartHandler","ancestorScrolls","descendantScrolls","touchEndHandler","selfActionsHooks","parentScroll","otherAncestorScrolls","isTopScroll","copied","sequencedScroll","PRE_NUM","POST_NUM","IndexCalculator","tombstoneHeight","lastDirection","lastPos","calculate","list","getDirection","calculateIndex","tombstone","ListItem","data","dom","DataManager","fetchFn","onFetchFinish","loadedNum","fetching","hasMore","update","addEmptyData","checkToFetch","add","fetch","newData","currentEnd","getList","Tombstone","cached","initialed","getSize","isTombstone","classList","getOne","tombstoneStyle","recycle","tombstones","tombstones_1","recycleOne","ANIMATION_DURATION_MS","DomManager","renderFn","unusedDom","timers","collectUnusedDom","createDom","cacheHeight","positionDom","startDelta","endPos","tombstoneEles","getStartPos","timerId","i_1","originPos","removeTombstone","querySelectorAll","EXTRA_SCROLL_Y","InfinityScroll","render","createTombstoneFn","createTombstone","indexCalculator","domManager","dataManager","modifyBoundary","infinityOptions","infinity","updateDom","sourcePrefix","propertiesMap","Movable","putAt","resolvePostion","isImageTag","ObserveImage","refreshTimer","observeImage","bindEventsToWrapper","debounceTime","imageLoadEventRegister","load","imageErrorEventRegister","resolveRatioOption","ratioConfig","ratioX","ratioY","handleBubbleAndCancelable","handleDOM","handleInteractive","relationElement","relationElementHandleElementIndex","maxBScrollX","maxBScrollY","indicatorWidth","indicatorHeight","translateXSign","translateYSign","lastPointX","lastPointY","getBScrollPosByRatio","currentX","currentY","BScrollMinScrollX","BScrollMaxScrollX","BScrollMinScrollY","BScrollMaxScrollY","newPosX","roundX","newPosY","roundY","xNotMoved","yNotMoved","BScrollPos","newIndicatorPos","getIndicatorPosByRatio","applyTransformProperty","transformProperties","Indicators","UserIndicatorsOptions","isArray","UserIndicatorsOptions_1","ObserveDom","PullDownRefresh","PullUpLoad"],"sources":["C:/Users/BangJun/Desktop/VUE/travel_vue/node_modules/better-scroll/dist/better-scroll.esm.js"],"sourcesContent":["/*!\n * better-scroll / better-scroll\n * (c) 2016-2021 ustbhuangyi\n * Released under the MIT License.\n */\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nfunction __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\n\nvar propertiesConfig$7 = [\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.currentPos',\r\n        key: 'x'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.currentPos',\r\n        key: 'y'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.hasScroll',\r\n        key: 'hasHorizontalScroll'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.hasScroll',\r\n        key: 'hasVerticalScroll'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.contentSize',\r\n        key: 'scrollerWidth'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.contentSize',\r\n        key: 'scrollerHeight'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.maxScrollPos',\r\n        key: 'maxScrollX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.maxScrollPos',\r\n        key: 'maxScrollY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.minScrollPos',\r\n        key: 'minScrollX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.minScrollPos',\r\n        key: 'minScrollY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.movingDirection',\r\n        key: 'movingDirectionX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.movingDirection',\r\n        key: 'movingDirectionY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.direction',\r\n        key: 'directionX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.direction',\r\n        key: 'directionY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.actions.enabled',\r\n        key: 'enabled'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.animater.pending',\r\n        key: 'pending'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.animater.stop',\r\n        key: 'stop'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollTo',\r\n        key: 'scrollTo'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBy',\r\n        key: 'scrollBy'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollToElement',\r\n        key: 'scrollToElement'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.resetPosition',\r\n        key: 'resetPosition'\r\n    }\r\n];\n\nfunction warn(msg) {\r\n    console.error(\"[BScroll warn]: \" + msg);\r\n}\r\nfunction assert(condition, msg) {\r\n    if (!condition) {\r\n        throw new Error('[BScroll] ' + msg);\r\n    }\r\n}\n\n// ssr support\r\nvar inBrowser = typeof window !== 'undefined';\r\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\r\nvar isWeChatDevTools = !!(ua && /wechatdevtools/.test(ua));\r\nvar isAndroid = ua && ua.indexOf('android') > 0;\r\n/* istanbul ignore next */\r\nvar isIOSBadVersion = (function () {\r\n    if (typeof ua === 'string') {\r\n        var regex = /os (\\d\\d?_\\d(_\\d)?)/;\r\n        var matches = regex.exec(ua);\r\n        if (!matches)\r\n            return false;\r\n        var parts = matches[1].split('_').map(function (item) {\r\n            return parseInt(item, 10);\r\n        });\r\n        // ios version >= 13.4 issue 982\r\n        return !!(parts[0] === 13 && parts[1] >= 4);\r\n    }\r\n    return false;\r\n})();\r\n/* istanbul ignore next */\r\nvar supportsPassive = false;\r\n/* istanbul ignore next */\r\nif (inBrowser) {\r\n    var EventName = 'test-passive';\r\n    try {\r\n        var opts = {};\r\n        Object.defineProperty(opts, 'passive', {\r\n            get: function () {\r\n                supportsPassive = true;\r\n            },\r\n        }); // https://github.com/facebook/flow/issues/285\r\n        window.addEventListener(EventName, function () { }, opts);\r\n    }\r\n    catch (e) { }\r\n}\n\nfunction getNow() {\r\n    return window.performance &&\r\n        window.performance.now &&\r\n        window.performance.timing\r\n        ? window.performance.now() + window.performance.timing.navigationStart\r\n        : +new Date();\r\n}\r\nvar extend = function (target, source) {\r\n    for (var key in source) {\r\n        target[key] = source[key];\r\n    }\r\n    return target;\r\n};\r\nfunction isUndef(v) {\r\n    return v === undefined || v === null;\r\n}\r\nfunction getDistance(x, y) {\r\n    return Math.sqrt(x * x + y * y);\r\n}\r\nfunction between(x, min, max) {\r\n    if (x < min) {\r\n        return min;\r\n    }\r\n    if (x > max) {\r\n        return max;\r\n    }\r\n    return x;\r\n}\r\nfunction findIndex(ary, fn) {\r\n    if (ary.findIndex) {\r\n        return ary.findIndex(fn);\r\n    }\r\n    var index = -1;\r\n    ary.some(function (item, i, ary) {\r\n        var ret = fn(item, i, ary);\r\n        if (ret) {\r\n            index = i;\r\n            return ret;\r\n        }\r\n    });\r\n    return index;\r\n}\n\nvar elementStyle = (inBrowser &&\r\n    document.createElement('div').style);\r\nvar vendor = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return false;\r\n    }\r\n    var transformNames = [\r\n        {\r\n            key: 'standard',\r\n            value: 'transform',\r\n        },\r\n        {\r\n            key: 'webkit',\r\n            value: 'webkitTransform',\r\n        },\r\n        {\r\n            key: 'Moz',\r\n            value: 'MozTransform',\r\n        },\r\n        {\r\n            key: 'O',\r\n            value: 'OTransform',\r\n        },\r\n        {\r\n            key: 'ms',\r\n            value: 'msTransform',\r\n        },\r\n    ];\r\n    for (var _i = 0, transformNames_1 = transformNames; _i < transformNames_1.length; _i++) {\r\n        var obj = transformNames_1[_i];\r\n        if (elementStyle[obj.value] !== undefined) {\r\n            return obj.key;\r\n        }\r\n    }\r\n    /* istanbul ignore next  */\r\n    return false;\r\n})();\r\n/* istanbul ignore next  */\r\nfunction prefixStyle(style) {\r\n    if (vendor === false) {\r\n        return style;\r\n    }\r\n    if (vendor === 'standard') {\r\n        if (style === 'transitionEnd') {\r\n            return 'transitionend';\r\n        }\r\n        return style;\r\n    }\r\n    return vendor + style.charAt(0).toUpperCase() + style.substr(1);\r\n}\r\nfunction getElement(el) {\r\n    return (typeof el === 'string'\r\n        ? document.querySelector(el)\r\n        : el);\r\n}\r\nfunction addEvent(el, type, fn, capture) {\r\n    var useCapture = supportsPassive\r\n        ? {\r\n            passive: false,\r\n            capture: !!capture,\r\n        }\r\n        : !!capture;\r\n    el.addEventListener(type, fn, useCapture);\r\n}\r\nfunction removeEvent(el, type, fn, capture) {\r\n    el.removeEventListener(type, fn, {\r\n        capture: !!capture,\r\n    });\r\n}\r\nfunction offset(el) {\r\n    var left = 0;\r\n    var top = 0;\r\n    while (el) {\r\n        left -= el.offsetLeft;\r\n        top -= el.offsetTop;\r\n        el = el.offsetParent;\r\n    }\r\n    return {\r\n        left: left,\r\n        top: top,\r\n    };\r\n}\r\nfunction offsetToBody(el) {\r\n    var rect = el.getBoundingClientRect();\r\n    return {\r\n        left: -(rect.left + window.pageXOffset),\r\n        top: -(rect.top + window.pageYOffset),\r\n    };\r\n}\r\nvar cssVendor = vendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\r\nvar transform = prefixStyle('transform');\r\nvar transition = prefixStyle('transition');\r\nvar hasPerspective = inBrowser && prefixStyle('perspective') in elementStyle;\r\n// fix issue #361\r\nvar hasTouch = inBrowser && ('ontouchstart' in window || isWeChatDevTools);\r\nvar hasTransition = inBrowser && transition in elementStyle;\r\nvar style = {\r\n    transform: transform,\r\n    transition: transition,\r\n    transitionTimingFunction: prefixStyle('transitionTimingFunction'),\r\n    transitionDuration: prefixStyle('transitionDuration'),\r\n    transitionDelay: prefixStyle('transitionDelay'),\r\n    transformOrigin: prefixStyle('transformOrigin'),\r\n    transitionEnd: prefixStyle('transitionEnd'),\r\n    transitionProperty: prefixStyle('transitionProperty'),\r\n};\r\nvar eventTypeMap = {\r\n    touchstart: 1,\r\n    touchmove: 1,\r\n    touchend: 1,\r\n    touchcancel: 1,\r\n    mousedown: 2,\r\n    mousemove: 2,\r\n    mouseup: 2,\r\n};\r\nfunction getRect(el) {\r\n    /* istanbul ignore if  */\r\n    if (el instanceof window.SVGElement) {\r\n        var rect = el.getBoundingClientRect();\r\n        return {\r\n            top: rect.top,\r\n            left: rect.left,\r\n            width: rect.width,\r\n            height: rect.height,\r\n        };\r\n    }\r\n    else {\r\n        return {\r\n            top: el.offsetTop,\r\n            left: el.offsetLeft,\r\n            width: el.offsetWidth,\r\n            height: el.offsetHeight,\r\n        };\r\n    }\r\n}\r\nfunction preventDefaultExceptionFn(el, exceptions) {\r\n    for (var i in exceptions) {\r\n        if (exceptions[i].test(el[i])) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nvar tagExceptionFn = preventDefaultExceptionFn;\r\nfunction tap(e, eventName) {\r\n    var ev = document.createEvent('Event');\r\n    ev.initEvent(eventName, true, true);\r\n    ev.pageX = e.pageX;\r\n    ev.pageY = e.pageY;\r\n    e.target.dispatchEvent(ev);\r\n}\r\nfunction click(e, event) {\r\n    if (event === void 0) { event = 'click'; }\r\n    var eventSource;\r\n    if (e.type === 'mouseup') {\r\n        eventSource = e;\r\n    }\r\n    else if (e.type === 'touchend' || e.type === 'touchcancel') {\r\n        eventSource = e.changedTouches[0];\r\n    }\r\n    var posSrc = {};\r\n    if (eventSource) {\r\n        posSrc.screenX = eventSource.screenX || 0;\r\n        posSrc.screenY = eventSource.screenY || 0;\r\n        posSrc.clientX = eventSource.clientX || 0;\r\n        posSrc.clientY = eventSource.clientY || 0;\r\n    }\r\n    var ev;\r\n    var bubbles = true;\r\n    var cancelable = true;\r\n    var ctrlKey = e.ctrlKey, shiftKey = e.shiftKey, altKey = e.altKey, metaKey = e.metaKey;\r\n    var pressedKeysMap = {\r\n        ctrlKey: ctrlKey,\r\n        shiftKey: shiftKey,\r\n        altKey: altKey,\r\n        metaKey: metaKey,\r\n    };\r\n    if (typeof MouseEvent !== 'undefined') {\r\n        try {\r\n            ev = new MouseEvent(event, extend(__assign({ bubbles: bubbles,\r\n                cancelable: cancelable }, pressedKeysMap), posSrc));\r\n        }\r\n        catch (e) {\r\n            /* istanbul ignore next */\r\n            createEvent();\r\n        }\r\n    }\r\n    else {\r\n        createEvent();\r\n    }\r\n    function createEvent() {\r\n        ev = document.createEvent('Event');\r\n        ev.initEvent(event, bubbles, cancelable);\r\n        extend(ev, posSrc);\r\n    }\r\n    // forwardedTouchEvent set to true in case of the conflict with fastclick\r\n    ev.forwardedTouchEvent = true;\r\n    ev._constructed = true;\r\n    e.target.dispatchEvent(ev);\r\n}\r\nfunction dblclick(e) {\r\n    click(e, 'dblclick');\r\n}\r\nfunction prepend(el, target) {\r\n    var firstChild = target.firstChild;\r\n    if (firstChild) {\r\n        before(el, firstChild);\r\n    }\r\n    else {\r\n        target.appendChild(el);\r\n    }\r\n}\r\nfunction before(el, target) {\r\n    var parentNode = target.parentNode;\r\n    parentNode.insertBefore(el, target);\r\n}\r\nfunction removeChild(el, child) {\r\n    el.removeChild(child);\r\n}\r\nfunction hasClass(el, className) {\r\n    var reg = new RegExp('(^|\\\\s)' + className + '(\\\\s|$)');\r\n    return reg.test(el.className);\r\n}\r\nfunction HTMLCollectionToArray(el) {\r\n    return Array.prototype.slice.call(el, 0);\r\n}\r\nfunction getClientSize(el) {\r\n    return {\r\n        width: el.clientWidth,\r\n        height: el.clientHeight,\r\n    };\r\n}\n\nvar ease = {\r\n    // easeOutQuint\r\n    swipe: {\r\n        style: 'cubic-bezier(0.23, 1, 0.32, 1)',\r\n        fn: function (t) {\r\n            return 1 + --t * t * t * t * t;\r\n        }\r\n    },\r\n    // easeOutQuard\r\n    swipeBounce: {\r\n        style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n        fn: function (t) {\r\n            return t * (2 - t);\r\n        }\r\n    },\r\n    // easeOutQuart\r\n    bounce: {\r\n        style: 'cubic-bezier(0.165, 0.84, 0.44, 1)',\r\n        fn: function (t) {\r\n            return 1 - --t * t * t * t;\r\n        }\r\n    }\r\n};\n\nvar DEFAULT_INTERVAL = 1000 / 60;\r\nvar windowCompat = inBrowser && window;\r\n/* istanbul ignore next */\r\nfunction noop$1() { }\r\nvar requestAnimationFrame = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return noop$1;\r\n    }\r\n    return (windowCompat.requestAnimationFrame ||\r\n        windowCompat.webkitRequestAnimationFrame ||\r\n        windowCompat.mozRequestAnimationFrame ||\r\n        windowCompat.oRequestAnimationFrame ||\r\n        // if all else fails, use setTimeout\r\n        function (callback) {\r\n            return window.setTimeout(callback, callback.interval || DEFAULT_INTERVAL); // make interval as precise as possible.\r\n        });\r\n})();\r\nvar cancelAnimationFrame = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return noop$1;\r\n    }\r\n    return (windowCompat.cancelAnimationFrame ||\r\n        windowCompat.webkitCancelAnimationFrame ||\r\n        windowCompat.mozCancelAnimationFrame ||\r\n        windowCompat.oCancelAnimationFrame ||\r\n        function (id) {\r\n            window.clearTimeout(id);\r\n        });\r\n})();\n\n/* istanbul ignore next */\r\nvar noop = function (val) { };\r\nvar sharedPropertyDefinition = {\r\n    enumerable: true,\r\n    configurable: true,\r\n    get: noop,\r\n    set: noop,\r\n};\r\nvar getProperty = function (obj, key) {\r\n    var keys = key.split('.');\r\n    for (var i = 0; i < keys.length - 1; i++) {\r\n        obj = obj[keys[i]];\r\n        if (typeof obj !== 'object' || !obj)\r\n            return;\r\n    }\r\n    var lastKey = keys.pop();\r\n    if (typeof obj[lastKey] === 'function') {\r\n        return function () {\r\n            return obj[lastKey].apply(obj, arguments);\r\n        };\r\n    }\r\n    else {\r\n        return obj[lastKey];\r\n    }\r\n};\r\nvar setProperty = function (obj, key, value) {\r\n    var keys = key.split('.');\r\n    var temp;\r\n    for (var i = 0; i < keys.length - 1; i++) {\r\n        temp = keys[i];\r\n        if (!obj[temp])\r\n            obj[temp] = {};\r\n        obj = obj[temp];\r\n    }\r\n    obj[keys.pop()] = value;\r\n};\r\nfunction propertiesProxy(target, sourceKey, key) {\r\n    sharedPropertyDefinition.get = function proxyGetter() {\r\n        return getProperty(this, sourceKey);\r\n    };\r\n    sharedPropertyDefinition.set = function proxySetter(val) {\r\n        setProperty(this, sourceKey, val);\r\n    };\r\n    Object.defineProperty(target, key, sharedPropertyDefinition);\r\n}\n\nvar EventEmitter = /** @class */ (function () {\r\n    function EventEmitter(names) {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n        this.registerType(names);\r\n    }\r\n    EventEmitter.prototype.on = function (type, fn, context) {\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        if (!this.events[type]) {\r\n            this.events[type] = [];\r\n        }\r\n        this.events[type].push([fn, context]);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.once = function (type, fn, context) {\r\n        var _this = this;\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        var magic = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            _this.off(type, magic);\r\n            var ret = fn.apply(context, args);\r\n            if (ret === true) {\r\n                return ret;\r\n            }\r\n        };\r\n        magic.fn = fn;\r\n        this.on(type, magic);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.off = function (type, fn) {\r\n        if (!type && !fn) {\r\n            this.events = {};\r\n            return this;\r\n        }\r\n        if (type) {\r\n            this.hasType(type);\r\n            if (!fn) {\r\n                this.events[type] = [];\r\n                return this;\r\n            }\r\n            var events = this.events[type];\r\n            if (!events) {\r\n                return this;\r\n            }\r\n            var count = events.length;\r\n            while (count--) {\r\n                if (events[count][0] === fn ||\r\n                    (events[count][0] && events[count][0].fn === fn)) {\r\n                    events.splice(count, 1);\r\n                }\r\n            }\r\n            return this;\r\n        }\r\n    };\r\n    EventEmitter.prototype.trigger = function (type) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        this.hasType(type);\r\n        var events = this.events[type];\r\n        if (!events) {\r\n            return;\r\n        }\r\n        var len = events.length;\r\n        var eventsCopy = __spreadArrays(events);\r\n        var ret;\r\n        for (var i = 0; i < len; i++) {\r\n            var event_1 = eventsCopy[i];\r\n            var fn = event_1[0], context = event_1[1];\r\n            if (fn) {\r\n                ret = fn.apply(context, args);\r\n                if (ret === true) {\r\n                    return ret;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    EventEmitter.prototype.registerType = function (names) {\r\n        var _this = this;\r\n        names.forEach(function (type) {\r\n            _this.eventTypes[type] = type;\r\n        });\r\n    };\r\n    EventEmitter.prototype.destroy = function () {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n    };\r\n    EventEmitter.prototype.hasType = function (type) {\r\n        var types = this.eventTypes;\r\n        var isType = types[type] === type;\r\n        if (!isType) {\r\n            warn(\"EventEmitter has used unknown event type: \\\"\" + type + \"\\\", should be oneof [\" +\r\n                (\"\" + Object.keys(types).map(function (_) { return JSON.stringify(_); })) +\r\n                \"]\");\r\n        }\r\n    };\r\n    return EventEmitter;\r\n}());\r\nvar EventRegister = /** @class */ (function () {\r\n    function EventRegister(wrapper, events) {\r\n        this.wrapper = wrapper;\r\n        this.events = events;\r\n        this.addDOMEvents();\r\n    }\r\n    EventRegister.prototype.destroy = function () {\r\n        this.removeDOMEvents();\r\n        this.events = [];\r\n    };\r\n    EventRegister.prototype.addDOMEvents = function () {\r\n        this.handleDOMEvents(addEvent);\r\n    };\r\n    EventRegister.prototype.removeDOMEvents = function () {\r\n        this.handleDOMEvents(removeEvent);\r\n    };\r\n    EventRegister.prototype.handleDOMEvents = function (eventOperation) {\r\n        var _this = this;\r\n        var wrapper = this.wrapper;\r\n        this.events.forEach(function (event) {\r\n            eventOperation(wrapper, event.name, _this, !!event.capture);\r\n        });\r\n    };\r\n    EventRegister.prototype.handleEvent = function (e) {\r\n        var eventType = e.type;\r\n        this.events.some(function (event) {\r\n            if (event.name === eventType) {\r\n                event.handler(e);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    };\r\n    return EventRegister;\r\n}());\n\nvar CustomOptions = /** @class */ (function () {\r\n    function CustomOptions() {\r\n    }\r\n    return CustomOptions;\r\n}());\r\nvar OptionsConstructor = /** @class */ (function (_super) {\r\n    __extends(OptionsConstructor, _super);\r\n    function OptionsConstructor() {\r\n        var _this = _super.call(this) || this;\r\n        _this.startX = 0;\r\n        _this.startY = 0;\r\n        _this.scrollX = false;\r\n        _this.scrollY = true;\r\n        _this.freeScroll = false;\r\n        _this.directionLockThreshold = 0;\r\n        _this.eventPassthrough = \"\" /* None */;\r\n        _this.click = false;\r\n        _this.dblclick = false;\r\n        _this.tap = '';\r\n        _this.bounce = {\r\n            top: true,\r\n            bottom: true,\r\n            left: true,\r\n            right: true,\r\n        };\r\n        _this.bounceTime = 800;\r\n        _this.momentum = true;\r\n        _this.momentumLimitTime = 300;\r\n        _this.momentumLimitDistance = 15;\r\n        _this.swipeTime = 2500;\r\n        _this.swipeBounceTime = 500;\r\n        _this.deceleration = 0.0015;\r\n        _this.flickLimitTime = 200;\r\n        _this.flickLimitDistance = 100;\r\n        _this.resizePolling = 60;\r\n        _this.probeType = 0 /* Default */;\r\n        _this.stopPropagation = false;\r\n        _this.preventDefault = true;\r\n        _this.preventDefaultException = {\r\n            tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|AUDIO)$/,\r\n        };\r\n        _this.tagException = {\r\n            tagName: /^TEXTAREA$/,\r\n        };\r\n        _this.HWCompositing = true;\r\n        _this.useTransition = true;\r\n        _this.bindToWrapper = false;\r\n        _this.bindToTarget = false;\r\n        _this.disableMouse = hasTouch;\r\n        _this.disableTouch = !hasTouch;\r\n        _this.autoBlur = true;\r\n        _this.autoEndDistance = 5;\r\n        _this.outOfBoundaryDampingFactor = 1 / 3;\r\n        _this.specifiedIndexAsContent = 0;\r\n        _this.quadrant = 1 /* First */;\r\n        return _this;\r\n    }\r\n    OptionsConstructor.prototype.merge = function (options) {\r\n        if (!options)\r\n            return this;\r\n        for (var key in options) {\r\n            if (key === 'bounce') {\r\n                this.bounce = this.resolveBounce(options[key]);\r\n                continue;\r\n            }\r\n            this[key] = options[key];\r\n        }\r\n        return this;\r\n    };\r\n    OptionsConstructor.prototype.process = function () {\r\n        this.translateZ =\r\n            this.HWCompositing && hasPerspective ? ' translateZ(1px)' : '';\r\n        this.useTransition = this.useTransition && hasTransition;\r\n        this.preventDefault = !this.eventPassthrough && this.preventDefault;\r\n        // If you want eventPassthrough I have to lock one of the axes\r\n        this.scrollX =\r\n            this.eventPassthrough === \"horizontal\" /* Horizontal */\r\n                ? false\r\n                : this.scrollX;\r\n        this.scrollY =\r\n            this.eventPassthrough === \"vertical\" /* Vertical */ ? false : this.scrollY;\r\n        // With eventPassthrough we also need lockDirection mechanism\r\n        this.freeScroll = this.freeScroll && !this.eventPassthrough;\r\n        // force true when freeScroll is true\r\n        this.scrollX = this.freeScroll ? true : this.scrollX;\r\n        this.scrollY = this.freeScroll ? true : this.scrollY;\r\n        this.directionLockThreshold = this.eventPassthrough\r\n            ? 0\r\n            : this.directionLockThreshold;\r\n        return this;\r\n    };\r\n    OptionsConstructor.prototype.resolveBounce = function (bounceOptions) {\r\n        var DEFAULT_BOUNCE = {\r\n            top: true,\r\n            right: true,\r\n            bottom: true,\r\n            left: true,\r\n        };\r\n        var NEGATED_BOUNCE = {\r\n            top: false,\r\n            right: false,\r\n            bottom: false,\r\n            left: false,\r\n        };\r\n        var ret;\r\n        if (typeof bounceOptions === 'object') {\r\n            ret = extend(DEFAULT_BOUNCE, bounceOptions);\r\n        }\r\n        else {\r\n            ret = bounceOptions ? DEFAULT_BOUNCE : NEGATED_BOUNCE;\r\n        }\r\n        return ret;\r\n    };\r\n    return OptionsConstructor;\r\n}(CustomOptions));\n\nvar ActionsHandler = /** @class */ (function () {\r\n    function ActionsHandler(wrapper, options) {\r\n        this.wrapper = wrapper;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter([\r\n            'beforeStart',\r\n            'start',\r\n            'move',\r\n            'end',\r\n            'click',\r\n        ]);\r\n        this.handleDOMEvents();\r\n    }\r\n    ActionsHandler.prototype.handleDOMEvents = function () {\r\n        var _a = this.options, bindToWrapper = _a.bindToWrapper, disableMouse = _a.disableMouse, disableTouch = _a.disableTouch, click = _a.click;\r\n        var wrapper = this.wrapper;\r\n        var target = bindToWrapper ? wrapper : window;\r\n        var wrapperEvents = [];\r\n        var targetEvents = [];\r\n        var shouldRegisterTouch = !disableTouch;\r\n        var shouldRegisterMouse = !disableMouse;\r\n        if (click) {\r\n            wrapperEvents.push({\r\n                name: 'click',\r\n                handler: this.click.bind(this),\r\n                capture: true,\r\n            });\r\n        }\r\n        if (shouldRegisterTouch) {\r\n            wrapperEvents.push({\r\n                name: 'touchstart',\r\n                handler: this.start.bind(this),\r\n            });\r\n            targetEvents.push({\r\n                name: 'touchmove',\r\n                handler: this.move.bind(this),\r\n            }, {\r\n                name: 'touchend',\r\n                handler: this.end.bind(this),\r\n            }, {\r\n                name: 'touchcancel',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        if (shouldRegisterMouse) {\r\n            wrapperEvents.push({\r\n                name: 'mousedown',\r\n                handler: this.start.bind(this),\r\n            });\r\n            targetEvents.push({\r\n                name: 'mousemove',\r\n                handler: this.move.bind(this),\r\n            }, {\r\n                name: 'mouseup',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        this.wrapperEventRegister = new EventRegister(wrapper, wrapperEvents);\r\n        this.targetEventRegister = new EventRegister(target, targetEvents);\r\n    };\r\n    ActionsHandler.prototype.beforeHandler = function (e, type) {\r\n        var _a = this.options, preventDefault = _a.preventDefault, stopPropagation = _a.stopPropagation, preventDefaultException = _a.preventDefaultException;\r\n        var preventDefaultConditions = {\r\n            start: function () {\r\n                return (preventDefault &&\r\n                    !preventDefaultExceptionFn(e.target, preventDefaultException));\r\n            },\r\n            end: function () {\r\n                return (preventDefault &&\r\n                    !preventDefaultExceptionFn(e.target, preventDefaultException));\r\n            },\r\n            move: function () {\r\n                return preventDefault;\r\n            },\r\n        };\r\n        if (preventDefaultConditions[type]()) {\r\n            e.preventDefault();\r\n        }\r\n        if (stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    ActionsHandler.prototype.setInitiated = function (type) {\r\n        if (type === void 0) { type = 0; }\r\n        this.initiated = type;\r\n    };\r\n    ActionsHandler.prototype.start = function (e) {\r\n        var _eventType = eventTypeMap[e.type];\r\n        if (this.initiated && this.initiated !== _eventType) {\r\n            return;\r\n        }\r\n        this.setInitiated(_eventType);\r\n        // if textarea or other html tags in options.tagException is manipulated\r\n        // do not make bs scroll\r\n        if (tagExceptionFn(e.target, this.options.tagException)) {\r\n            this.setInitiated();\r\n            return;\r\n        }\r\n        // only allow mouse left button\r\n        if (_eventType === 2 /* Mouse */ && e.button !== 0 /* Left */)\r\n            return;\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeStart, e)) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e, 'start');\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        this.pointX = point.pageX;\r\n        this.pointY = point.pageY;\r\n        this.hooks.trigger(this.hooks.eventTypes.start, e);\r\n    };\r\n    ActionsHandler.prototype.move = function (e) {\r\n        if (eventTypeMap[e.type] !== this.initiated) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e, 'move');\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        var deltaX = point.pageX - this.pointX;\r\n        var deltaY = point.pageY - this.pointY;\r\n        this.pointX = point.pageX;\r\n        this.pointY = point.pageY;\r\n        if (this.hooks.trigger(this.hooks.eventTypes.move, {\r\n            deltaX: deltaX,\r\n            deltaY: deltaY,\r\n            e: e,\r\n        })) {\r\n            return;\r\n        }\r\n        // auto end when out of viewport\r\n        var scrollLeft = document.documentElement.scrollLeft ||\r\n            window.pageXOffset ||\r\n            document.body.scrollLeft;\r\n        var scrollTop = document.documentElement.scrollTop ||\r\n            window.pageYOffset ||\r\n            document.body.scrollTop;\r\n        var pX = this.pointX - scrollLeft;\r\n        var pY = this.pointY - scrollTop;\r\n        var autoEndDistance = this.options.autoEndDistance;\r\n        if (pX > document.documentElement.clientWidth - autoEndDistance ||\r\n            pY > document.documentElement.clientHeight - autoEndDistance ||\r\n            pX < autoEndDistance ||\r\n            pY < autoEndDistance) {\r\n            this.end(e);\r\n        }\r\n    };\r\n    ActionsHandler.prototype.end = function (e) {\r\n        if (eventTypeMap[e.type] !== this.initiated) {\r\n            return;\r\n        }\r\n        this.setInitiated();\r\n        this.beforeHandler(e, 'end');\r\n        this.hooks.trigger(this.hooks.eventTypes.end, e);\r\n    };\r\n    ActionsHandler.prototype.click = function (e) {\r\n        this.hooks.trigger(this.hooks.eventTypes.click, e);\r\n    };\r\n    ActionsHandler.prototype.setContent = function (content) {\r\n        if (content !== this.wrapper) {\r\n            this.wrapper = content;\r\n            this.rebindDOMEvents();\r\n        }\r\n    };\r\n    ActionsHandler.prototype.rebindDOMEvents = function () {\r\n        this.wrapperEventRegister.destroy();\r\n        this.targetEventRegister.destroy();\r\n        this.handleDOMEvents();\r\n    };\r\n    ActionsHandler.prototype.destroy = function () {\r\n        this.wrapperEventRegister.destroy();\r\n        this.targetEventRegister.destroy();\r\n        this.hooks.destroy();\r\n    };\r\n    return ActionsHandler;\r\n}());\n\nvar translaterMetaData = {\r\n    x: ['translateX', 'px'],\r\n    y: ['translateY', 'px'],\r\n};\r\nvar Translater = /** @class */ (function () {\r\n    function Translater(content) {\r\n        this.setContent(content);\r\n        this.hooks = new EventEmitter(['beforeTranslate', 'translate']);\r\n    }\r\n    Translater.prototype.getComputedPosition = function () {\r\n        var cssStyle = window.getComputedStyle(this.content, null);\r\n        var matrix = cssStyle[style.transform].split(')')[0].split(', ');\r\n        var x = +(matrix[12] || matrix[4]) || 0;\r\n        var y = +(matrix[13] || matrix[5]) || 0;\r\n        return {\r\n            x: x,\r\n            y: y,\r\n        };\r\n    };\r\n    Translater.prototype.translate = function (point) {\r\n        var transformStyle = [];\r\n        Object.keys(point).forEach(function (key) {\r\n            if (!translaterMetaData[key]) {\r\n                return;\r\n            }\r\n            var transformFnName = translaterMetaData[key][0];\r\n            if (transformFnName) {\r\n                var transformFnArgUnit = translaterMetaData[key][1];\r\n                var transformFnArg = point[key];\r\n                transformStyle.push(transformFnName + \"(\" + transformFnArg + transformFnArgUnit + \")\");\r\n            }\r\n        });\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeTranslate, transformStyle, point);\r\n        this.style[style.transform] = transformStyle.join(' ');\r\n        this.hooks.trigger(this.hooks.eventTypes.translate, point);\r\n    };\r\n    Translater.prototype.setContent = function (content) {\r\n        if (this.content !== content) {\r\n            this.content = content;\r\n            this.style = content.style;\r\n        }\r\n    };\r\n    Translater.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return Translater;\r\n}());\n\nvar Base = /** @class */ (function () {\r\n    function Base(content, translater, options) {\r\n        this.translater = translater;\r\n        this.options = options;\r\n        this.timer = 0;\r\n        this.hooks = new EventEmitter([\r\n            'move',\r\n            'end',\r\n            'beforeForceStop',\r\n            'forceStop',\r\n            'callStop',\r\n            'time',\r\n            'timeFunction',\r\n        ]);\r\n        this.setContent(content);\r\n    }\r\n    Base.prototype.translate = function (endPoint) {\r\n        this.translater.translate(endPoint);\r\n    };\r\n    Base.prototype.setPending = function (pending) {\r\n        this.pending = pending;\r\n    };\r\n    Base.prototype.setForceStopped = function (forceStopped) {\r\n        this.forceStopped = forceStopped;\r\n    };\r\n    Base.prototype.setCallStop = function (called) {\r\n        this.callStopWhenPending = called;\r\n    };\r\n    Base.prototype.setContent = function (content) {\r\n        if (this.content !== content) {\r\n            this.content = content;\r\n            this.style = content.style;\r\n            this.stop();\r\n        }\r\n    };\r\n    Base.prototype.clearTimer = function () {\r\n        if (this.timer) {\r\n            cancelAnimationFrame(this.timer);\r\n            this.timer = 0;\r\n        }\r\n    };\r\n    Base.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n        cancelAnimationFrame(this.timer);\r\n    };\r\n    return Base;\r\n}());\n\n// iOS 13.6 - 14.x, window.getComputedStyle sometimes will get wrong transform value\r\n// when bs use transition mode\r\n// eg: translateY -100px -> -200px, when the last frame which is about to scroll to -200px\r\n// window.getComputedStyle(this.content) will calculate transformY to be -100px(startPoint)\r\n// it is weird\r\n// so we should validate position caculated by 'window.getComputedStyle'\r\nvar isValidPostion = function (startPoint, endPoint, currentPos, prePos) {\r\n    var computeDirection = function (endValue, startValue) {\r\n        var delta = endValue - startValue;\r\n        var direction = delta > 0\r\n            ? -1 /* Negative */\r\n            : delta < 0\r\n                ? 1 /* Positive */\r\n                : 0 /* Default */;\r\n        return direction;\r\n    };\r\n    var directionX = computeDirection(endPoint.x, startPoint.x);\r\n    var directionY = computeDirection(endPoint.y, startPoint.y);\r\n    var deltaX = currentPos.x - prePos.x;\r\n    var deltaY = currentPos.y - prePos.y;\r\n    return directionX * deltaX <= 0 && directionY * deltaY <= 0;\r\n};\n\nvar Transition = /** @class */ (function (_super) {\r\n    __extends(Transition, _super);\r\n    function Transition() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Transition.prototype.startProbe = function (startPoint, endPoint) {\r\n        var _this = this;\r\n        var prePos = startPoint;\r\n        var probe = function () {\r\n            var pos = _this.translater.getComputedPosition();\r\n            if (isValidPostion(startPoint, endPoint, pos, prePos)) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.move, pos);\r\n            }\r\n            // call bs.stop() should not dispatch end hook again.\r\n            // forceStop hook will do this.\r\n            /* istanbul ignore if  */\r\n            if (!_this.pending) {\r\n                if (_this.callStopWhenPending) {\r\n                    _this.callStopWhenPending = false;\r\n                }\r\n                else {\r\n                    // transition ends should dispatch end hook.\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.end, pos);\r\n                }\r\n            }\r\n            prePos = pos;\r\n            if (_this.pending) {\r\n                _this.timer = requestAnimationFrame(probe);\r\n            }\r\n        };\r\n        // when manually call bs.stop(), then bs.scrollTo()\r\n        // we should reset callStopWhenPending to dispatch end hook\r\n        if (this.callStopWhenPending) {\r\n            this.setCallStop(false);\r\n        }\r\n        cancelAnimationFrame(this.timer);\r\n        probe();\r\n    };\r\n    Transition.prototype.transitionTime = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        this.style[style.transitionDuration] = time + 'ms';\r\n        this.hooks.trigger(this.hooks.eventTypes.time, time);\r\n    };\r\n    Transition.prototype.transitionTimingFunction = function (easing) {\r\n        this.style[style.transitionTimingFunction] = easing;\r\n        this.hooks.trigger(this.hooks.eventTypes.timeFunction, easing);\r\n    };\r\n    Transition.prototype.transitionProperty = function () {\r\n        this.style[style.transitionProperty] = style.transform;\r\n    };\r\n    Transition.prototype.move = function (startPoint, endPoint, time, easingFn) {\r\n        this.setPending(time > 0);\r\n        this.transitionTimingFunction(easingFn);\r\n        this.transitionProperty();\r\n        this.transitionTime(time);\r\n        this.translate(endPoint);\r\n        var isRealtimeProbeType = this.options.probeType === 3 /* Realtime */;\r\n        if (time && isRealtimeProbeType) {\r\n            this.startProbe(startPoint, endPoint);\r\n        }\r\n        // if we change content's transformY in a tick\r\n        // such as: 0 -> 50px -> 0\r\n        // transitionend will not be triggered\r\n        // so we forceupdate by reflow\r\n        if (!time) {\r\n            this._reflow = this.content.offsetHeight;\r\n            if (isRealtimeProbeType) {\r\n                this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\r\n            }\r\n            this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\r\n        }\r\n    };\r\n    Transition.prototype.doStop = function () {\r\n        var pending = this.pending;\r\n        this.setForceStopped(false);\r\n        this.setCallStop(false);\r\n        // still in transition\r\n        if (pending) {\r\n            this.setPending(false);\r\n            cancelAnimationFrame(this.timer);\r\n            var _a = this.translater.getComputedPosition(), x = _a.x, y = _a.y;\r\n            this.transitionTime();\r\n            this.translate({ x: x, y: y });\r\n            this.setForceStopped(true);\r\n            this.setCallStop(true);\r\n            this.hooks.trigger(this.hooks.eventTypes.forceStop, { x: x, y: y });\r\n        }\r\n        return pending;\r\n    };\r\n    Transition.prototype.stop = function () {\r\n        var stopFromTransition = this.doStop();\r\n        if (stopFromTransition) {\r\n            this.hooks.trigger(this.hooks.eventTypes.callStop);\r\n        }\r\n    };\r\n    return Transition;\r\n}(Base));\n\nvar Animation = /** @class */ (function (_super) {\r\n    __extends(Animation, _super);\r\n    function Animation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Animation.prototype.move = function (startPoint, endPoint, time, easingFn) {\r\n        // time is 0\r\n        if (!time) {\r\n            this.translate(endPoint);\r\n            if (this.options.probeType === 3 /* Realtime */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\r\n            }\r\n            this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\r\n            return;\r\n        }\r\n        this.animate(startPoint, endPoint, time, easingFn);\r\n    };\r\n    Animation.prototype.animate = function (startPoint, endPoint, duration, easingFn) {\r\n        var _this = this;\r\n        var startTime = getNow();\r\n        var destTime = startTime + duration;\r\n        var isRealtimeProbeType = this.options.probeType === 3 /* Realtime */;\r\n        var step = function () {\r\n            var now = getNow();\r\n            // js animation end\r\n            if (now >= destTime) {\r\n                _this.translate(endPoint);\r\n                if (isRealtimeProbeType) {\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.move, endPoint);\r\n                }\r\n                _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\r\n                return;\r\n            }\r\n            now = (now - startTime) / duration;\r\n            var easing = easingFn(now);\r\n            var newPoint = {};\r\n            Object.keys(endPoint).forEach(function (key) {\r\n                var startValue = startPoint[key];\r\n                var endValue = endPoint[key];\r\n                newPoint[key] = (endValue - startValue) * easing + startValue;\r\n            });\r\n            _this.translate(newPoint);\r\n            if (isRealtimeProbeType) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.move, newPoint);\r\n            }\r\n            if (_this.pending) {\r\n                _this.timer = requestAnimationFrame(step);\r\n            }\r\n            // call bs.stop() should not dispatch end hook again.\r\n            // forceStop hook will do this.\r\n            /* istanbul ignore if  */\r\n            if (!_this.pending) {\r\n                if (_this.callStopWhenPending) {\r\n                    _this.callStopWhenPending = false;\r\n                }\r\n                else {\r\n                    // raf ends should dispatch end hook.\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\r\n                }\r\n            }\r\n        };\r\n        this.setPending(true);\r\n        // when manually call bs.stop(), then bs.scrollTo()\r\n        // we should reset callStopWhenPending to dispatch end hook\r\n        if (this.callStopWhenPending) {\r\n            this.setCallStop(false);\r\n        }\r\n        cancelAnimationFrame(this.timer);\r\n        step();\r\n    };\r\n    Animation.prototype.doStop = function () {\r\n        var pending = this.pending;\r\n        this.setForceStopped(false);\r\n        this.setCallStop(false);\r\n        // still in requestFrameAnimation\r\n        if (pending) {\r\n            this.setPending(false);\r\n            cancelAnimationFrame(this.timer);\r\n            var pos = this.translater.getComputedPosition();\r\n            this.setForceStopped(true);\r\n            this.setCallStop(true);\r\n            this.hooks.trigger(this.hooks.eventTypes.forceStop, pos);\r\n        }\r\n        return pending;\r\n    };\r\n    Animation.prototype.stop = function () {\r\n        var stopFromAnimation = this.doStop();\r\n        if (stopFromAnimation) {\r\n            this.hooks.trigger(this.hooks.eventTypes.callStop);\r\n        }\r\n    };\r\n    return Animation;\r\n}(Base));\n\nfunction createAnimater(element, translater, options) {\r\n    var useTransition = options.useTransition;\r\n    var animaterOptions = {};\r\n    Object.defineProperty(animaterOptions, 'probeType', {\r\n        enumerable: true,\r\n        configurable: false,\r\n        get: function () {\r\n            return options.probeType;\r\n        },\r\n    });\r\n    if (useTransition) {\r\n        return new Transition(element, translater, animaterOptions);\r\n    }\r\n    else {\r\n        return new Animation(element, translater, animaterOptions);\r\n    }\r\n}\n\nvar Behavior = /** @class */ (function () {\r\n    function Behavior(wrapper, content, options) {\r\n        this.wrapper = wrapper;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter([\r\n            'beforeComputeBoundary',\r\n            'computeBoundary',\r\n            'momentum',\r\n            'end',\r\n            'ignoreHasScroll'\r\n        ]);\r\n        this.refresh(content);\r\n    }\r\n    Behavior.prototype.start = function () {\r\n        this.dist = 0;\r\n        this.setMovingDirection(0 /* Default */);\r\n        this.setDirection(0 /* Default */);\r\n    };\r\n    Behavior.prototype.move = function (delta) {\r\n        delta = this.hasScroll ? delta : 0;\r\n        this.setMovingDirection(delta);\r\n        return this.performDampingAlgorithm(delta, this.options.outOfBoundaryDampingFactor);\r\n    };\r\n    Behavior.prototype.setMovingDirection = function (delta) {\r\n        this.movingDirection =\r\n            delta > 0\r\n                ? -1 /* Negative */\r\n                : delta < 0\r\n                    ? 1 /* Positive */\r\n                    : 0 /* Default */;\r\n    };\r\n    Behavior.prototype.setDirection = function (delta) {\r\n        this.direction =\r\n            delta > 0\r\n                ? -1 /* Negative */\r\n                : delta < 0\r\n                    ? 1 /* Positive */\r\n                    : 0 /* Default */;\r\n    };\r\n    Behavior.prototype.performDampingAlgorithm = function (delta, dampingFactor) {\r\n        var newPos = this.currentPos + delta;\r\n        // Slow down or stop if outside of the boundaries\r\n        if (newPos > this.minScrollPos || newPos < this.maxScrollPos) {\r\n            if ((newPos > this.minScrollPos && this.options.bounces[0]) ||\r\n                (newPos < this.maxScrollPos && this.options.bounces[1])) {\r\n                newPos = this.currentPos + delta * dampingFactor;\r\n            }\r\n            else {\r\n                newPos =\r\n                    newPos > this.minScrollPos ? this.minScrollPos : this.maxScrollPos;\r\n            }\r\n        }\r\n        return newPos;\r\n    };\r\n    Behavior.prototype.end = function (duration) {\r\n        var momentumInfo = {\r\n            duration: 0\r\n        };\r\n        var absDist = Math.abs(this.currentPos - this.startPos);\r\n        // start momentum animation if needed\r\n        if (this.options.momentum &&\r\n            duration < this.options.momentumLimitTime &&\r\n            absDist > this.options.momentumLimitDistance) {\r\n            var wrapperSize = (this.direction === -1 /* Negative */ && this.options.bounces[0]) ||\r\n                (this.direction === 1 /* Positive */ && this.options.bounces[1])\r\n                ? this.wrapperSize\r\n                : 0;\r\n            momentumInfo = this.hasScroll\r\n                ? this.momentum(this.currentPos, this.startPos, duration, this.maxScrollPos, this.minScrollPos, wrapperSize, this.options)\r\n                : { destination: this.currentPos, duration: 0 };\r\n        }\r\n        else {\r\n            this.hooks.trigger(this.hooks.eventTypes.end, momentumInfo);\r\n        }\r\n        return momentumInfo;\r\n    };\r\n    Behavior.prototype.momentum = function (current, start, time, lowerMargin, upperMargin, wrapperSize, options) {\r\n        if (options === void 0) { options = this.options; }\r\n        var distance = current - start;\r\n        var speed = Math.abs(distance) / time;\r\n        var deceleration = options.deceleration, swipeBounceTime = options.swipeBounceTime, swipeTime = options.swipeTime;\r\n        var duration = Math.min(swipeTime, (speed * 2) / deceleration);\r\n        var momentumData = {\r\n            destination: current + ((speed * speed) / deceleration) * (distance < 0 ? -1 : 1),\r\n            duration: duration,\r\n            rate: 15\r\n        };\r\n        this.hooks.trigger(this.hooks.eventTypes.momentum, momentumData, distance);\r\n        if (momentumData.destination < lowerMargin) {\r\n            momentumData.destination = wrapperSize\r\n                ? Math.max(lowerMargin - wrapperSize / 4, lowerMargin - (wrapperSize / momentumData.rate) * speed)\r\n                : lowerMargin;\r\n            momentumData.duration = swipeBounceTime;\r\n        }\r\n        else if (momentumData.destination > upperMargin) {\r\n            momentumData.destination = wrapperSize\r\n                ? Math.min(upperMargin + wrapperSize / 4, upperMargin + (wrapperSize / momentumData.rate) * speed)\r\n                : upperMargin;\r\n            momentumData.duration = swipeBounceTime;\r\n        }\r\n        momentumData.destination = Math.round(momentumData.destination);\r\n        return momentumData;\r\n    };\r\n    Behavior.prototype.updateDirection = function () {\r\n        var absDist = this.currentPos - this.absStartPos;\r\n        this.setDirection(absDist);\r\n    };\r\n    Behavior.prototype.refresh = function (content) {\r\n        var _a = this.options.rect, size = _a.size, position = _a.position;\r\n        var isWrapperStatic = window.getComputedStyle(this.wrapper, null).position === 'static';\r\n        // Force reflow\r\n        var wrapperRect = getRect(this.wrapper);\r\n        // use client is more fair than offset\r\n        this.wrapperSize = this.wrapper[size === 'width' ? 'clientWidth' : 'clientHeight'];\r\n        this.setContent(content);\r\n        var contentRect = getRect(this.content);\r\n        this.contentSize = contentRect[size];\r\n        this.relativeOffset = contentRect[position];\r\n        /* istanbul ignore if  */\r\n        if (isWrapperStatic) {\r\n            this.relativeOffset -= wrapperRect[position];\r\n        }\r\n        this.computeBoundary();\r\n        this.setDirection(0 /* Default */);\r\n    };\r\n    Behavior.prototype.setContent = function (content) {\r\n        if (content !== this.content) {\r\n            this.content = content;\r\n            this.resetState();\r\n        }\r\n    };\r\n    Behavior.prototype.resetState = function () {\r\n        this.currentPos = 0;\r\n        this.startPos = 0;\r\n        this.dist = 0;\r\n        this.setDirection(0 /* Default */);\r\n        this.setMovingDirection(0 /* Default */);\r\n        this.resetStartPos();\r\n    };\r\n    Behavior.prototype.computeBoundary = function () {\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeComputeBoundary);\r\n        var boundary = {\r\n            minScrollPos: 0,\r\n            maxScrollPos: this.wrapperSize - this.contentSize\r\n        };\r\n        if (boundary.maxScrollPos < 0) {\r\n            boundary.maxScrollPos -= this.relativeOffset;\r\n            if (this.options.specifiedIndexAsContent === 0) {\r\n                boundary.minScrollPos = -this.relativeOffset;\r\n            }\r\n        }\r\n        this.hooks.trigger(this.hooks.eventTypes.computeBoundary, boundary);\r\n        this.minScrollPos = boundary.minScrollPos;\r\n        this.maxScrollPos = boundary.maxScrollPos;\r\n        this.hasScroll =\r\n            this.options.scrollable && this.maxScrollPos < this.minScrollPos;\r\n        if (!this.hasScroll && this.minScrollPos < this.maxScrollPos) {\r\n            this.maxScrollPos = this.minScrollPos;\r\n            this.contentSize = this.wrapperSize;\r\n        }\r\n    };\r\n    Behavior.prototype.updatePosition = function (pos) {\r\n        this.currentPos = pos;\r\n    };\r\n    Behavior.prototype.getCurrentPos = function () {\r\n        return this.currentPos;\r\n    };\r\n    Behavior.prototype.checkInBoundary = function () {\r\n        var position = this.adjustPosition(this.currentPos);\r\n        var inBoundary = position === this.getCurrentPos();\r\n        return {\r\n            position: position,\r\n            inBoundary: inBoundary\r\n        };\r\n    };\r\n    // adjust position when out of boundary\r\n    Behavior.prototype.adjustPosition = function (pos) {\r\n        if (!this.hasScroll &&\r\n            !this.hooks.trigger(this.hooks.eventTypes.ignoreHasScroll)) {\r\n            pos = this.minScrollPos;\r\n        }\r\n        else if (pos > this.minScrollPos) {\r\n            pos = this.minScrollPos;\r\n        }\r\n        else if (pos < this.maxScrollPos) {\r\n            pos = this.maxScrollPos;\r\n        }\r\n        return pos;\r\n    };\r\n    Behavior.prototype.updateStartPos = function () {\r\n        this.startPos = this.currentPos;\r\n    };\r\n    Behavior.prototype.updateAbsStartPos = function () {\r\n        this.absStartPos = this.currentPos;\r\n    };\r\n    Behavior.prototype.resetStartPos = function () {\r\n        this.updateStartPos();\r\n        this.updateAbsStartPos();\r\n    };\r\n    Behavior.prototype.getAbsDist = function (delta) {\r\n        this.dist += delta;\r\n        return Math.abs(this.dist);\r\n    };\r\n    Behavior.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return Behavior;\r\n}());\n\nvar _a, _b, _c, _d;\r\nvar PassthroughHandlers = (_a = {},\r\n    _a[\"yes\" /* Yes */] = function (e) {\r\n        return true;\r\n    },\r\n    _a[\"no\" /* No */] = function (e) {\r\n        e.preventDefault();\r\n        return false;\r\n    },\r\n    _a);\r\nvar DirectionMap = (_b = {},\r\n    _b[\"horizontal\" /* Horizontal */] = (_c = {},\r\n        _c[\"yes\" /* Yes */] = \"horizontal\" /* Horizontal */,\r\n        _c[\"no\" /* No */] = \"vertical\" /* Vertical */,\r\n        _c),\r\n    _b[\"vertical\" /* Vertical */] = (_d = {},\r\n        _d[\"yes\" /* Yes */] = \"vertical\" /* Vertical */,\r\n        _d[\"no\" /* No */] = \"horizontal\" /* Horizontal */,\r\n        _d),\r\n    _b);\r\nvar DirectionLockAction = /** @class */ (function () {\r\n    function DirectionLockAction(directionLockThreshold, freeScroll, eventPassthrough) {\r\n        this.directionLockThreshold = directionLockThreshold;\r\n        this.freeScroll = freeScroll;\r\n        this.eventPassthrough = eventPassthrough;\r\n        this.reset();\r\n    }\r\n    DirectionLockAction.prototype.reset = function () {\r\n        this.directionLocked = \"\" /* Default */;\r\n    };\r\n    DirectionLockAction.prototype.checkMovingDirection = function (absDistX, absDistY, e) {\r\n        this.computeDirectionLock(absDistX, absDistY);\r\n        return this.handleEventPassthrough(e);\r\n    };\r\n    DirectionLockAction.prototype.adjustDelta = function (deltaX, deltaY) {\r\n        if (this.directionLocked === \"horizontal\" /* Horizontal */) {\r\n            deltaY = 0;\r\n        }\r\n        else if (this.directionLocked === \"vertical\" /* Vertical */) {\r\n            deltaX = 0;\r\n        }\r\n        return {\r\n            deltaX: deltaX,\r\n            deltaY: deltaY\r\n        };\r\n    };\r\n    DirectionLockAction.prototype.computeDirectionLock = function (absDistX, absDistY) {\r\n        // If you are scrolling in one direction, lock it\r\n        if (this.directionLocked === \"\" /* Default */ && !this.freeScroll) {\r\n            if (absDistX > absDistY + this.directionLockThreshold) {\r\n                this.directionLocked = \"horizontal\" /* Horizontal */; // lock horizontally\r\n            }\r\n            else if (absDistY >= absDistX + this.directionLockThreshold) {\r\n                this.directionLocked = \"vertical\" /* Vertical */; // lock vertically\r\n            }\r\n            else {\r\n                this.directionLocked = \"none\" /* None */; // no lock\r\n            }\r\n        }\r\n    };\r\n    DirectionLockAction.prototype.handleEventPassthrough = function (e) {\r\n        var handleMap = DirectionMap[this.directionLocked];\r\n        if (handleMap) {\r\n            if (this.eventPassthrough === handleMap[\"yes\" /* Yes */]) {\r\n                return PassthroughHandlers[\"yes\" /* Yes */](e);\r\n            }\r\n            else if (this.eventPassthrough === handleMap[\"no\" /* No */]) {\r\n                return PassthroughHandlers[\"no\" /* No */](e);\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    return DirectionLockAction;\r\n}());\n\nvar applyQuadrantTransformation = function (deltaX, deltaY, quadrant) {\r\n    if (quadrant === 2 /* Second */) {\r\n        return [deltaY, -deltaX];\r\n    }\r\n    else if (quadrant === 3 /* Third */) {\r\n        return [-deltaX, -deltaY];\r\n    }\r\n    else if (quadrant === 4 /* Forth */) {\r\n        return [-deltaY, deltaX];\r\n    }\r\n    else {\r\n        return [deltaX, deltaY];\r\n    }\r\n};\r\nvar ScrollerActions = /** @class */ (function () {\r\n    function ScrollerActions(scrollBehaviorX, scrollBehaviorY, actionsHandler, animater, options) {\r\n        this.hooks = new EventEmitter([\r\n            'start',\r\n            'beforeMove',\r\n            'scrollStart',\r\n            'scroll',\r\n            'beforeEnd',\r\n            'end',\r\n            'scrollEnd',\r\n            'contentNotMoved',\r\n            'detectMovingDirection',\r\n            'coordinateTransformation',\r\n        ]);\r\n        this.scrollBehaviorX = scrollBehaviorX;\r\n        this.scrollBehaviorY = scrollBehaviorY;\r\n        this.actionsHandler = actionsHandler;\r\n        this.animater = animater;\r\n        this.options = options;\r\n        this.directionLockAction = new DirectionLockAction(options.directionLockThreshold, options.freeScroll, options.eventPassthrough);\r\n        this.enabled = true;\r\n        this.bindActionsHandler();\r\n    }\r\n    ScrollerActions.prototype.bindActionsHandler = function () {\r\n        var _this = this;\r\n        // [mouse|touch]start event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.start, function (e) {\r\n            if (!_this.enabled)\r\n                return true;\r\n            return _this.handleStart(e);\r\n        });\r\n        // [mouse|touch]move event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.move, function (_a) {\r\n            var deltaX = _a.deltaX, deltaY = _a.deltaY, e = _a.e;\r\n            if (!_this.enabled)\r\n                return true;\r\n            var _b = applyQuadrantTransformation(deltaX, deltaY, _this.options.quadrant), transformateDeltaX = _b[0], transformateDeltaY = _b[1];\r\n            var transformateDeltaData = {\r\n                deltaX: transformateDeltaX,\r\n                deltaY: transformateDeltaY,\r\n            };\r\n            _this.hooks.trigger(_this.hooks.eventTypes.coordinateTransformation, transformateDeltaData);\r\n            return _this.handleMove(transformateDeltaData.deltaX, transformateDeltaData.deltaY, e);\r\n        });\r\n        // [mouse|touch]end event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.end, function (e) {\r\n            if (!_this.enabled)\r\n                return true;\r\n            return _this.handleEnd(e);\r\n        });\r\n        // click\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.click, function (e) {\r\n            // handle native click event\r\n            if (_this.enabled && !e._constructed) {\r\n                _this.handleClick(e);\r\n            }\r\n        });\r\n    };\r\n    ScrollerActions.prototype.handleStart = function (e) {\r\n        var timestamp = getNow();\r\n        this.fingerMoved = false;\r\n        this.contentMoved = false;\r\n        this.startTime = timestamp;\r\n        this.directionLockAction.reset();\r\n        this.scrollBehaviorX.start();\r\n        this.scrollBehaviorY.start();\r\n        // force stopping last transition or animation\r\n        this.animater.doStop();\r\n        this.scrollBehaviorX.resetStartPos();\r\n        this.scrollBehaviorY.resetStartPos();\r\n        this.hooks.trigger(this.hooks.eventTypes.start, e);\r\n    };\r\n    ScrollerActions.prototype.handleMove = function (deltaX, deltaY, e) {\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeMove, e)) {\r\n            return;\r\n        }\r\n        var absDistX = this.scrollBehaviorX.getAbsDist(deltaX);\r\n        var absDistY = this.scrollBehaviorY.getAbsDist(deltaY);\r\n        var timestamp = getNow();\r\n        // We need to move at least momentumLimitDistance pixels\r\n        // for the scrolling to initiate\r\n        if (this.checkMomentum(absDistX, absDistY, timestamp)) {\r\n            return true;\r\n        }\r\n        if (this.directionLockAction.checkMovingDirection(absDistX, absDistY, e)) {\r\n            this.actionsHandler.setInitiated();\r\n            return true;\r\n        }\r\n        var delta = this.directionLockAction.adjustDelta(deltaX, deltaY);\r\n        var prevX = this.scrollBehaviorX.getCurrentPos();\r\n        var newX = this.scrollBehaviorX.move(delta.deltaX);\r\n        var prevY = this.scrollBehaviorY.getCurrentPos();\r\n        var newY = this.scrollBehaviorY.move(delta.deltaY);\r\n        if (this.hooks.trigger(this.hooks.eventTypes.detectMovingDirection)) {\r\n            return;\r\n        }\r\n        if (!this.fingerMoved) {\r\n            this.fingerMoved = true;\r\n        }\r\n        var positionChanged = newX !== prevX || newY !== prevY;\r\n        if (!this.contentMoved && !positionChanged) {\r\n            this.hooks.trigger(this.hooks.eventTypes.contentNotMoved);\r\n        }\r\n        if (!this.contentMoved && positionChanged) {\r\n            this.contentMoved = true;\r\n            this.hooks.trigger(this.hooks.eventTypes.scrollStart);\r\n        }\r\n        if (this.contentMoved && positionChanged) {\r\n            this.animater.translate({\r\n                x: newX,\r\n                y: newY,\r\n            });\r\n            this.dispatchScroll(timestamp);\r\n        }\r\n    };\r\n    ScrollerActions.prototype.dispatchScroll = function (timestamp) {\r\n        // dispatch scroll in interval time\r\n        if (timestamp - this.startTime > this.options.momentumLimitTime) {\r\n            // refresh time and starting position to initiate a momentum\r\n            this.startTime = timestamp;\r\n            this.scrollBehaviorX.updateStartPos();\r\n            this.scrollBehaviorY.updateStartPos();\r\n            if (this.options.probeType === 1 /* Throttle */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\r\n            }\r\n        }\r\n        // dispatch scroll all the time\r\n        if (this.options.probeType > 1 /* Throttle */) {\r\n            this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\r\n        }\r\n    };\r\n    ScrollerActions.prototype.checkMomentum = function (absDistX, absDistY, timestamp) {\r\n        return (timestamp - this.endTime > this.options.momentumLimitTime &&\r\n            absDistY < this.options.momentumLimitDistance &&\r\n            absDistX < this.options.momentumLimitDistance);\r\n    };\r\n    ScrollerActions.prototype.handleEnd = function (e) {\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeEnd, e)) {\r\n            return;\r\n        }\r\n        var currentPos = this.getCurrentPos();\r\n        this.scrollBehaviorX.updateDirection();\r\n        this.scrollBehaviorY.updateDirection();\r\n        if (this.hooks.trigger(this.hooks.eventTypes.end, e, currentPos)) {\r\n            return true;\r\n        }\r\n        currentPos = this.ensureIntegerPos(currentPos);\r\n        this.animater.translate(currentPos);\r\n        this.endTime = getNow();\r\n        var duration = this.endTime - this.startTime;\r\n        this.hooks.trigger(this.hooks.eventTypes.scrollEnd, currentPos, duration);\r\n    };\r\n    ScrollerActions.prototype.ensureIntegerPos = function (currentPos) {\r\n        this.ensuringInteger = true;\r\n        var x = currentPos.x, y = currentPos.y;\r\n        var _a = this.scrollBehaviorX, minScrollPosX = _a.minScrollPos, maxScrollPosX = _a.maxScrollPos;\r\n        var _b = this.scrollBehaviorY, minScrollPosY = _b.minScrollPos, maxScrollPosY = _b.maxScrollPos;\r\n        x = x > 0 ? Math.ceil(x) : Math.floor(x);\r\n        y = y > 0 ? Math.ceil(y) : Math.floor(y);\r\n        x = between(x, maxScrollPosX, minScrollPosX);\r\n        y = between(y, maxScrollPosY, minScrollPosY);\r\n        return { x: x, y: y };\r\n    };\r\n    ScrollerActions.prototype.handleClick = function (e) {\r\n        if (!preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    ScrollerActions.prototype.getCurrentPos = function () {\r\n        return {\r\n            x: this.scrollBehaviorX.getCurrentPos(),\r\n            y: this.scrollBehaviorY.getCurrentPos(),\r\n        };\r\n    };\r\n    ScrollerActions.prototype.refresh = function () {\r\n        this.endTime = 0;\r\n    };\r\n    ScrollerActions.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return ScrollerActions;\r\n}());\n\nfunction createActionsHandlerOptions(bsOptions) {\r\n    var options = [\r\n        'click',\r\n        'bindToWrapper',\r\n        'disableMouse',\r\n        'disableTouch',\r\n        'preventDefault',\r\n        'stopPropagation',\r\n        'tagException',\r\n        'preventDefaultException',\r\n        'autoEndDistance',\r\n    ].reduce(function (prev, cur) {\r\n        prev[cur] = bsOptions[cur];\r\n        return prev;\r\n    }, {});\r\n    return options;\r\n}\r\nfunction createBehaviorOptions(bsOptions, extraProp, bounces, rect) {\r\n    var options = [\r\n        'momentum',\r\n        'momentumLimitTime',\r\n        'momentumLimitDistance',\r\n        'deceleration',\r\n        'swipeBounceTime',\r\n        'swipeTime',\r\n        'outOfBoundaryDampingFactor',\r\n        'specifiedIndexAsContent',\r\n    ].reduce(function (prev, cur) {\r\n        prev[cur] = bsOptions[cur];\r\n        return prev;\r\n    }, {});\r\n    // add extra property\r\n    options.scrollable = !!bsOptions[extraProp];\r\n    options.bounces = bounces;\r\n    options.rect = rect;\r\n    return options;\r\n}\n\nfunction bubbling(source, target, events) {\r\n    events.forEach(function (event) {\r\n        var sourceEvent;\r\n        var targetEvent;\r\n        if (typeof event === 'string') {\r\n            sourceEvent = targetEvent = event;\r\n        }\r\n        else {\r\n            sourceEvent = event.source;\r\n            targetEvent = event.target;\r\n        }\r\n        source.on(sourceEvent, function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            return target.trigger.apply(target, __spreadArrays([targetEvent], args));\r\n        });\r\n    });\r\n}\n\nfunction isSamePoint(startPoint, endPoint) {\r\n    // keys of startPoint and endPoint should be equal\r\n    var keys = Object.keys(startPoint);\r\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n        var key = keys_1[_i];\r\n        if (startPoint[key] !== endPoint[key])\r\n            return false;\r\n    }\r\n    return true;\r\n}\n\nvar MIN_SCROLL_DISTANCE = 1;\r\nvar Scroller = /** @class */ (function () {\r\n    function Scroller(wrapper, content, options) {\r\n        this.wrapper = wrapper;\r\n        this.content = content;\r\n        this.resizeTimeout = 0;\r\n        this.hooks = new EventEmitter([\r\n            'beforeStart',\r\n            'beforeMove',\r\n            'beforeScrollStart',\r\n            'scrollStart',\r\n            'scroll',\r\n            'beforeEnd',\r\n            'scrollEnd',\r\n            'resize',\r\n            'touchEnd',\r\n            'end',\r\n            'flick',\r\n            'scrollCancel',\r\n            'momentum',\r\n            'scrollTo',\r\n            'minDistanceScroll',\r\n            'scrollToElement',\r\n            'beforeRefresh',\r\n        ]);\r\n        this.options = options;\r\n        var _a = this.options.bounce, left = _a.left, right = _a.right, top = _a.top, bottom = _a.bottom;\r\n        // direction X\r\n        this.scrollBehaviorX = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollX', [left, right], {\r\n            size: 'width',\r\n            position: 'left',\r\n        }));\r\n        // direction Y\r\n        this.scrollBehaviorY = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollY', [top, bottom], {\r\n            size: 'height',\r\n            position: 'top',\r\n        }));\r\n        this.translater = new Translater(this.content);\r\n        this.animater = createAnimater(this.content, this.translater, this.options);\r\n        this.actionsHandler = new ActionsHandler(this.options.bindToTarget ? this.content : wrapper, createActionsHandlerOptions(this.options));\r\n        this.actions = new ScrollerActions(this.scrollBehaviorX, this.scrollBehaviorY, this.actionsHandler, this.animater, this.options);\r\n        var resizeHandler = this.resize.bind(this);\r\n        this.resizeRegister = new EventRegister(window, [\r\n            {\r\n                name: 'orientationchange',\r\n                handler: resizeHandler,\r\n            },\r\n            {\r\n                name: 'resize',\r\n                handler: resizeHandler,\r\n            },\r\n        ]);\r\n        this.registerTransitionEnd();\r\n        this.init();\r\n    }\r\n    Scroller.prototype.init = function () {\r\n        var _this = this;\r\n        this.bindTranslater();\r\n        this.bindAnimater();\r\n        this.bindActions();\r\n        // enable pointer events when scrolling ends\r\n        this.hooks.on(this.hooks.eventTypes.scrollEnd, function () {\r\n            _this.togglePointerEvents(true);\r\n        });\r\n    };\r\n    Scroller.prototype.registerTransitionEnd = function () {\r\n        this.transitionEndRegister = new EventRegister(this.content, [\r\n            {\r\n                name: style.transitionEnd,\r\n                handler: this.transitionEnd.bind(this),\r\n            },\r\n        ]);\r\n    };\r\n    Scroller.prototype.bindTranslater = function () {\r\n        var _this = this;\r\n        var hooks = this.translater.hooks;\r\n        hooks.on(hooks.eventTypes.beforeTranslate, function (transformStyle) {\r\n            if (_this.options.translateZ) {\r\n                transformStyle.push(_this.options.translateZ);\r\n            }\r\n        });\r\n        // disable pointer events when scrolling\r\n        hooks.on(hooks.eventTypes.translate, function (pos) {\r\n            var prevPos = _this.getCurrentPos();\r\n            _this.updatePositions(pos);\r\n            // scrollEnd will dispatch when scroll is force stopping in touchstart handler\r\n            // so in touchend handler, don't toggle pointer-events\r\n            if (_this.actions.ensuringInteger === true) {\r\n                _this.actions.ensuringInteger = false;\r\n                return;\r\n            }\r\n            // a valid translate\r\n            if (pos.x !== prevPos.x || pos.y !== prevPos.y) {\r\n                _this.togglePointerEvents(false);\r\n            }\r\n        });\r\n    };\r\n    Scroller.prototype.bindAnimater = function () {\r\n        var _this = this;\r\n        // reset position\r\n        this.animater.hooks.on(this.animater.hooks.eventTypes.end, function (pos) {\r\n            if (!_this.resetPosition(_this.options.bounceTime)) {\r\n                _this.animater.setPending(false);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\r\n            }\r\n        });\r\n        bubbling(this.animater.hooks, this.hooks, [\r\n            {\r\n                source: this.animater.hooks.eventTypes.move,\r\n                target: this.hooks.eventTypes.scroll,\r\n            },\r\n            {\r\n                source: this.animater.hooks.eventTypes.forceStop,\r\n                target: this.hooks.eventTypes.scrollEnd,\r\n            },\r\n        ]);\r\n    };\r\n    Scroller.prototype.bindActions = function () {\r\n        var _this = this;\r\n        var actions = this.actions;\r\n        bubbling(actions.hooks, this.hooks, [\r\n            {\r\n                source: actions.hooks.eventTypes.start,\r\n                target: this.hooks.eventTypes.beforeStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.start,\r\n                target: this.hooks.eventTypes.beforeScrollStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.beforeMove,\r\n                target: this.hooks.eventTypes.beforeMove,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.scrollStart,\r\n                target: this.hooks.eventTypes.scrollStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.scroll,\r\n                target: this.hooks.eventTypes.scroll,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.beforeEnd,\r\n                target: this.hooks.eventTypes.beforeEnd,\r\n            },\r\n        ]);\r\n        actions.hooks.on(actions.hooks.eventTypes.end, function (e, pos) {\r\n            _this.hooks.trigger(_this.hooks.eventTypes.touchEnd, pos);\r\n            if (_this.hooks.trigger(_this.hooks.eventTypes.end, pos)) {\r\n                return true;\r\n            }\r\n            // check if it is a click operation\r\n            if (!actions.fingerMoved) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollCancel);\r\n                if (_this.checkClick(e)) {\r\n                    return true;\r\n                }\r\n            }\r\n            // reset if we are outside of the boundaries\r\n            if (_this.resetPosition(_this.options.bounceTime, ease.bounce)) {\r\n                _this.animater.setForceStopped(false);\r\n                return true;\r\n            }\r\n        });\r\n        actions.hooks.on(actions.hooks.eventTypes.scrollEnd, function (pos, duration) {\r\n            var deltaX = Math.abs(pos.x - _this.scrollBehaviorX.startPos);\r\n            var deltaY = Math.abs(pos.y - _this.scrollBehaviorY.startPos);\r\n            if (_this.checkFlick(duration, deltaX, deltaY)) {\r\n                _this.animater.setForceStopped(false);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.flick);\r\n                return;\r\n            }\r\n            if (_this.momentum(pos, duration)) {\r\n                _this.animater.setForceStopped(false);\r\n                return;\r\n            }\r\n            if (actions.contentMoved) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\r\n            }\r\n            if (_this.animater.forceStopped) {\r\n                _this.animater.setForceStopped(false);\r\n            }\r\n        });\r\n    };\r\n    Scroller.prototype.checkFlick = function (duration, deltaX, deltaY) {\r\n        var flickMinMovingDistance = 1; // distinguish flick from click\r\n        if (this.hooks.events.flick.length > 1 &&\r\n            duration < this.options.flickLimitTime &&\r\n            deltaX < this.options.flickLimitDistance &&\r\n            deltaY < this.options.flickLimitDistance &&\r\n            (deltaY > flickMinMovingDistance || deltaX > flickMinMovingDistance)) {\r\n            return true;\r\n        }\r\n    };\r\n    Scroller.prototype.momentum = function (pos, duration) {\r\n        var meta = {\r\n            time: 0,\r\n            easing: ease.swiper,\r\n            newX: pos.x,\r\n            newY: pos.y,\r\n        };\r\n        // start momentum animation if needed\r\n        var momentumX = this.scrollBehaviorX.end(duration);\r\n        var momentumY = this.scrollBehaviorY.end(duration);\r\n        meta.newX = isUndef(momentumX.destination)\r\n            ? meta.newX\r\n            : momentumX.destination;\r\n        meta.newY = isUndef(momentumY.destination)\r\n            ? meta.newY\r\n            : momentumY.destination;\r\n        meta.time = Math.max(momentumX.duration, momentumY.duration);\r\n        this.hooks.trigger(this.hooks.eventTypes.momentum, meta, this);\r\n        // when x or y changed, do momentum animation now!\r\n        if (meta.newX !== pos.x || meta.newY !== pos.y) {\r\n            // change easing function when scroller goes out of the boundaries\r\n            if (meta.newX > this.scrollBehaviorX.minScrollPos ||\r\n                meta.newX < this.scrollBehaviorX.maxScrollPos ||\r\n                meta.newY > this.scrollBehaviorY.minScrollPos ||\r\n                meta.newY < this.scrollBehaviorY.maxScrollPos) {\r\n                meta.easing = ease.swipeBounce;\r\n            }\r\n            this.scrollTo(meta.newX, meta.newY, meta.time, meta.easing);\r\n            return true;\r\n        }\r\n    };\r\n    Scroller.prototype.checkClick = function (e) {\r\n        var cancelable = {\r\n            preventClick: this.animater.forceStopped,\r\n        };\r\n        // we scrolled less than momentumLimitDistance pixels\r\n        if (this.hooks.trigger(this.hooks.eventTypes.checkClick)) {\r\n            this.animater.setForceStopped(false);\r\n            return true;\r\n        }\r\n        if (!cancelable.preventClick) {\r\n            var _dblclick = this.options.dblclick;\r\n            var dblclickTrigged = false;\r\n            if (_dblclick && this.lastClickTime) {\r\n                var _a = _dblclick.delay, delay = _a === void 0 ? 300 : _a;\r\n                if (getNow() - this.lastClickTime < delay) {\r\n                    dblclickTrigged = true;\r\n                    dblclick(e);\r\n                }\r\n            }\r\n            if (this.options.tap) {\r\n                tap(e, this.options.tap);\r\n            }\r\n            if (this.options.click &&\r\n                !preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\r\n                click(e);\r\n            }\r\n            this.lastClickTime = dblclickTrigged ? null : getNow();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Scroller.prototype.resize = function () {\r\n        var _this = this;\r\n        if (!this.actions.enabled) {\r\n            return;\r\n        }\r\n        // fix a scroll problem under Android condition\r\n        /* istanbul ignore if  */\r\n        if (isAndroid) {\r\n            this.wrapper.scrollTop = 0;\r\n        }\r\n        clearTimeout(this.resizeTimeout);\r\n        this.resizeTimeout = window.setTimeout(function () {\r\n            _this.hooks.trigger(_this.hooks.eventTypes.resize);\r\n        }, this.options.resizePolling);\r\n    };\r\n    /* istanbul ignore next */\r\n    Scroller.prototype.transitionEnd = function (e) {\r\n        if (e.target !== this.content || !this.animater.pending) {\r\n            return;\r\n        }\r\n        var animater = this.animater;\r\n        animater.transitionTime();\r\n        if (!this.resetPosition(this.options.bounceTime, ease.bounce)) {\r\n            this.animater.setPending(false);\r\n            if (this.options.probeType !== 3 /* Realtime */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.scrollEnd, this.getCurrentPos());\r\n            }\r\n        }\r\n    };\r\n    Scroller.prototype.togglePointerEvents = function (enabled) {\r\n        if (enabled === void 0) { enabled = true; }\r\n        var el = this.content.children.length\r\n            ? this.content.children\r\n            : [this.content];\r\n        var pointerEvents = enabled ? 'auto' : 'none';\r\n        for (var i = 0; i < el.length; i++) {\r\n            var node = el[i];\r\n            // ignore BetterScroll instance's wrapper DOM\r\n            /* istanbul ignore if  */\r\n            if (node.isBScrollContainer) {\r\n                continue;\r\n            }\r\n            node.style.pointerEvents = pointerEvents;\r\n        }\r\n    };\r\n    Scroller.prototype.refresh = function (content) {\r\n        var contentChanged = this.setContent(content);\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeRefresh);\r\n        this.scrollBehaviorX.refresh(content);\r\n        this.scrollBehaviorY.refresh(content);\r\n        if (contentChanged) {\r\n            this.translater.setContent(content);\r\n            this.animater.setContent(content);\r\n            this.transitionEndRegister.destroy();\r\n            this.registerTransitionEnd();\r\n            if (this.options.bindToTarget) {\r\n                this.actionsHandler.setContent(content);\r\n            }\r\n        }\r\n        this.actions.refresh();\r\n        this.wrapperOffset = offset(this.wrapper);\r\n    };\r\n    Scroller.prototype.setContent = function (content) {\r\n        var contentChanged = content !== this.content;\r\n        if (contentChanged) {\r\n            this.content = content;\r\n        }\r\n        return contentChanged;\r\n    };\r\n    Scroller.prototype.scrollBy = function (deltaX, deltaY, time, easing) {\r\n        if (time === void 0) { time = 0; }\r\n        var _a = this.getCurrentPos(), x = _a.x, y = _a.y;\r\n        easing = !easing ? ease.bounce : easing;\r\n        deltaX += x;\r\n        deltaY += y;\r\n        this.scrollTo(deltaX, deltaY, time, easing);\r\n    };\r\n    Scroller.prototype.scrollTo = function (x, y, time, easing, extraTransform) {\r\n        if (time === void 0) { time = 0; }\r\n        if (easing === void 0) { easing = ease.bounce; }\r\n        if (extraTransform === void 0) { extraTransform = {\r\n            start: {},\r\n            end: {},\r\n        }; }\r\n        var easingFn = this.options.useTransition ? easing.style : easing.fn;\r\n        var currentPos = this.getCurrentPos();\r\n        var startPoint = __assign({ x: currentPos.x, y: currentPos.y }, extraTransform.start);\r\n        var endPoint = __assign({ x: x,\r\n            y: y }, extraTransform.end);\r\n        this.hooks.trigger(this.hooks.eventTypes.scrollTo, endPoint);\r\n        // it is an useless move\r\n        if (isSamePoint(startPoint, endPoint))\r\n            return;\r\n        var deltaX = Math.abs(endPoint.x - startPoint.x);\r\n        var deltaY = Math.abs(endPoint.y - startPoint.y);\r\n        // considering of browser compatibility for decimal transform value\r\n        // force translating immediately\r\n        if (deltaX < MIN_SCROLL_DISTANCE && deltaY < MIN_SCROLL_DISTANCE) {\r\n            time = 0;\r\n            this.hooks.trigger(this.hooks.eventTypes.minDistanceScroll);\r\n        }\r\n        this.animater.move(startPoint, endPoint, time, easingFn);\r\n    };\r\n    Scroller.prototype.scrollToElement = function (el, time, offsetX, offsetY, easing) {\r\n        var targetEle = getElement(el);\r\n        var pos = offset(targetEle);\r\n        var getOffset = function (offset, size, wrapperSize) {\r\n            if (typeof offset === 'number') {\r\n                return offset;\r\n            }\r\n            // if offsetX/Y are true we center the element to the screen\r\n            return offset ? Math.round(size / 2 - wrapperSize / 2) : 0;\r\n        };\r\n        offsetX = getOffset(offsetX, targetEle.offsetWidth, this.wrapper.offsetWidth);\r\n        offsetY = getOffset(offsetY, targetEle.offsetHeight, this.wrapper.offsetHeight);\r\n        var getPos = function (pos, wrapperPos, offset, scrollBehavior) {\r\n            pos -= wrapperPos;\r\n            pos = scrollBehavior.adjustPosition(pos - offset);\r\n            return pos;\r\n        };\r\n        pos.left = getPos(pos.left, this.wrapperOffset.left, offsetX, this.scrollBehaviorX);\r\n        pos.top = getPos(pos.top, this.wrapperOffset.top, offsetY, this.scrollBehaviorY);\r\n        if (this.hooks.trigger(this.hooks.eventTypes.scrollToElement, targetEle, pos)) {\r\n            return;\r\n        }\r\n        this.scrollTo(pos.left, pos.top, time, easing);\r\n    };\r\n    Scroller.prototype.resetPosition = function (time, easing) {\r\n        if (time === void 0) { time = 0; }\r\n        if (easing === void 0) { easing = ease.bounce; }\r\n        var _a = this.scrollBehaviorX.checkInBoundary(), x = _a.position, xInBoundary = _a.inBoundary;\r\n        var _b = this.scrollBehaviorY.checkInBoundary(), y = _b.position, yInBoundary = _b.inBoundary;\r\n        if (xInBoundary && yInBoundary) {\r\n            return false;\r\n        }\r\n        /* istanbul ignore if  */\r\n        if (isIOSBadVersion) {\r\n            // fix ios 13.4 bouncing\r\n            // see it in issues 982\r\n            this.reflow();\r\n        }\r\n        // out of boundary\r\n        this.scrollTo(x, y, time, easing);\r\n        return true;\r\n    };\r\n    /* istanbul ignore next */\r\n    Scroller.prototype.reflow = function () {\r\n        this._reflow = this.content.offsetHeight;\r\n    };\r\n    Scroller.prototype.updatePositions = function (pos) {\r\n        this.scrollBehaviorX.updatePosition(pos.x);\r\n        this.scrollBehaviorY.updatePosition(pos.y);\r\n    };\r\n    Scroller.prototype.getCurrentPos = function () {\r\n        return this.actions.getCurrentPos();\r\n    };\r\n    Scroller.prototype.enable = function () {\r\n        this.actions.enabled = true;\r\n    };\r\n    Scroller.prototype.disable = function () {\r\n        cancelAnimationFrame(this.animater.timer);\r\n        this.actions.enabled = false;\r\n    };\r\n    Scroller.prototype.destroy = function () {\r\n        var _this = this;\r\n        var keys = [\r\n            'resizeRegister',\r\n            'transitionEndRegister',\r\n            'actionsHandler',\r\n            'actions',\r\n            'hooks',\r\n            'animater',\r\n            'translater',\r\n            'scrollBehaviorX',\r\n            'scrollBehaviorY',\r\n        ];\r\n        keys.forEach(function (key) { return _this[key].destroy(); });\r\n    };\r\n    return Scroller;\r\n}());\n\nvar BScrollConstructor = /** @class */ (function (_super) {\r\n    __extends(BScrollConstructor, _super);\r\n    function BScrollConstructor(el, options) {\r\n        var _this = _super.call(this, [\r\n            'refresh',\r\n            'contentChanged',\r\n            'enable',\r\n            'disable',\r\n            'beforeScrollStart',\r\n            'scrollStart',\r\n            'scroll',\r\n            'scrollEnd',\r\n            'scrollCancel',\r\n            'touchEnd',\r\n            'flick',\r\n            'destroy'\r\n        ]) || this;\r\n        var wrapper = getElement(el);\r\n        if (!wrapper) {\r\n            warn('Can not resolve the wrapper DOM.');\r\n            return _this;\r\n        }\r\n        _this.plugins = {};\r\n        _this.options = new OptionsConstructor().merge(options).process();\r\n        if (!_this.setContent(wrapper).valid) {\r\n            return _this;\r\n        }\r\n        _this.hooks = new EventEmitter([\r\n            'refresh',\r\n            'enable',\r\n            'disable',\r\n            'destroy',\r\n            'beforeInitialScrollTo',\r\n            'contentChanged'\r\n        ]);\r\n        _this.init(wrapper);\r\n        return _this;\r\n    }\r\n    BScrollConstructor.use = function (ctor) {\r\n        var name = ctor.pluginName;\r\n        var installed = BScrollConstructor.plugins.some(function (plugin) { return ctor === plugin.ctor; });\r\n        if (installed)\r\n            return BScrollConstructor;\r\n        if (isUndef(name)) {\r\n            warn(\"Plugin Class must specify plugin's name in static property by 'pluginName' field.\");\r\n            return BScrollConstructor;\r\n        }\r\n        BScrollConstructor.pluginsMap[name] = true;\r\n        BScrollConstructor.plugins.push({\r\n            name: name,\r\n            applyOrder: ctor.applyOrder,\r\n            ctor: ctor\r\n        });\r\n        return BScrollConstructor;\r\n    };\r\n    BScrollConstructor.prototype.setContent = function (wrapper) {\r\n        var contentChanged = false;\r\n        var valid = true;\r\n        var content = wrapper.children[this.options.specifiedIndexAsContent];\r\n        if (!content) {\r\n            warn('The wrapper need at least one child element to be content element to scroll.');\r\n            valid = false;\r\n        }\r\n        else {\r\n            contentChanged = this.content !== content;\r\n            if (contentChanged) {\r\n                this.content = content;\r\n            }\r\n        }\r\n        return {\r\n            valid: valid,\r\n            contentChanged: contentChanged\r\n        };\r\n    };\r\n    BScrollConstructor.prototype.init = function (wrapper) {\r\n        var _this = this;\r\n        this.wrapper = wrapper;\r\n        // mark wrapper to recognize bs instance by DOM attribute\r\n        wrapper.isBScrollContainer = true;\r\n        this.scroller = new Scroller(wrapper, this.content, this.options);\r\n        this.scroller.hooks.on(this.scroller.hooks.eventTypes.resize, function () {\r\n            _this.refresh();\r\n        });\r\n        this.eventBubbling();\r\n        this.handleAutoBlur();\r\n        this.enable();\r\n        this.proxy(propertiesConfig$7);\r\n        this.applyPlugins();\r\n        // maybe boundary has changed, should refresh\r\n        this.refreshWithoutReset(this.content);\r\n        var _a = this.options, startX = _a.startX, startY = _a.startY;\r\n        var position = {\r\n            x: startX,\r\n            y: startY\r\n        };\r\n        // maybe plugins want to control scroll position\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeInitialScrollTo, position)) {\r\n            return;\r\n        }\r\n        this.scroller.scrollTo(position.x, position.y);\r\n    };\r\n    BScrollConstructor.prototype.applyPlugins = function () {\r\n        var _this = this;\r\n        var options = this.options;\r\n        BScrollConstructor.plugins\r\n            .sort(function (a, b) {\r\n            var _a;\r\n            var applyOrderMap = (_a = {},\r\n                _a[\"pre\" /* Pre */] = -1,\r\n                _a[\"post\" /* Post */] = 1,\r\n                _a);\r\n            var aOrder = a.applyOrder ? applyOrderMap[a.applyOrder] : 0;\r\n            var bOrder = b.applyOrder ? applyOrderMap[b.applyOrder] : 0;\r\n            return aOrder - bOrder;\r\n        })\r\n            .forEach(function (item) {\r\n            var ctor = item.ctor;\r\n            if (options[item.name] && typeof ctor === 'function') {\r\n                _this.plugins[item.name] = new ctor(_this);\r\n            }\r\n        });\r\n    };\r\n    BScrollConstructor.prototype.handleAutoBlur = function () {\r\n        /* istanbul ignore if  */\r\n        if (this.options.autoBlur) {\r\n            this.on(this.eventTypes.beforeScrollStart, function () {\r\n                var activeElement = document.activeElement;\r\n                if (activeElement &&\r\n                    (activeElement.tagName === 'INPUT' ||\r\n                        activeElement.tagName === 'TEXTAREA')) {\r\n                    activeElement.blur();\r\n                }\r\n            });\r\n        }\r\n    };\r\n    BScrollConstructor.prototype.eventBubbling = function () {\r\n        bubbling(this.scroller.hooks, this, [\r\n            this.eventTypes.beforeScrollStart,\r\n            this.eventTypes.scrollStart,\r\n            this.eventTypes.scroll,\r\n            this.eventTypes.scrollEnd,\r\n            this.eventTypes.scrollCancel,\r\n            this.eventTypes.touchEnd,\r\n            this.eventTypes.flick\r\n        ]);\r\n    };\r\n    BScrollConstructor.prototype.refreshWithoutReset = function (content) {\r\n        this.scroller.refresh(content);\r\n        this.hooks.trigger(this.hooks.eventTypes.refresh, content);\r\n        this.trigger(this.eventTypes.refresh, content);\r\n    };\r\n    BScrollConstructor.prototype.proxy = function (propertiesConfig) {\r\n        var _this = this;\r\n        propertiesConfig.forEach(function (_a) {\r\n            var key = _a.key, sourceKey = _a.sourceKey;\r\n            propertiesProxy(_this, sourceKey, key);\r\n        });\r\n    };\r\n    BScrollConstructor.prototype.refresh = function () {\r\n        var _a = this.setContent(this.wrapper), contentChanged = _a.contentChanged, valid = _a.valid;\r\n        if (valid) {\r\n            var content = this.content;\r\n            this.refreshWithoutReset(content);\r\n            if (contentChanged) {\r\n                this.hooks.trigger(this.hooks.eventTypes.contentChanged, content);\r\n                this.trigger(this.eventTypes.contentChanged, content);\r\n            }\r\n            this.scroller.resetPosition();\r\n        }\r\n    };\r\n    BScrollConstructor.prototype.enable = function () {\r\n        this.scroller.enable();\r\n        this.hooks.trigger(this.hooks.eventTypes.enable);\r\n        this.trigger(this.eventTypes.enable);\r\n    };\r\n    BScrollConstructor.prototype.disable = function () {\r\n        this.scroller.disable();\r\n        this.hooks.trigger(this.hooks.eventTypes.disable);\r\n        this.trigger(this.eventTypes.disable);\r\n    };\r\n    BScrollConstructor.prototype.destroy = function () {\r\n        this.hooks.trigger(this.hooks.eventTypes.destroy);\r\n        this.trigger(this.eventTypes.destroy);\r\n        this.scroller.destroy();\r\n    };\r\n    BScrollConstructor.prototype.eventRegister = function (names) {\r\n        this.registerType(names);\r\n    };\r\n    BScrollConstructor.plugins = [];\r\n    BScrollConstructor.pluginsMap = {};\r\n    return BScrollConstructor;\r\n}(EventEmitter));\r\nfunction createBScroll(el, options) {\r\n    var bs = new BScrollConstructor(el, options);\r\n    return bs;\r\n}\r\ncreateBScroll.use = BScrollConstructor.use;\r\ncreateBScroll.plugins = BScrollConstructor.plugins;\r\ncreateBScroll.pluginsMap = BScrollConstructor.pluginsMap;\r\nvar BScroll = createBScroll;\n\nvar MouseWheel = /** @class */ (function () {\r\n    function MouseWheel(scroll) {\r\n        this.scroll = scroll;\r\n        this.wheelEndTimer = 0;\r\n        this.wheelMoveTimer = 0;\r\n        this.wheelStart = false;\r\n        this.init();\r\n    }\r\n    MouseWheel.prototype.init = function () {\r\n        this.handleBScroll();\r\n        this.handleOptions();\r\n        this.handleHooks();\r\n        this.registerEvent();\r\n    };\r\n    MouseWheel.prototype.handleBScroll = function () {\r\n        this.scroll.registerType([\r\n            'alterOptions',\r\n            'mousewheelStart',\r\n            'mousewheelMove',\r\n            'mousewheelEnd',\r\n        ]);\r\n    };\r\n    MouseWheel.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.mouseWheel === true\r\n            ? {}\r\n            : this.scroll.options.mouseWheel);\r\n        var defaultOptions = {\r\n            speed: 20,\r\n            invert: false,\r\n            easeTime: 300,\r\n            discreteTime: 400,\r\n            throttleTime: 0,\r\n            dampingFactor: 0.1,\r\n        };\r\n        this.mouseWheelOpt = extend(defaultOptions, userOptions);\r\n    };\r\n    MouseWheel.prototype.handleHooks = function () {\r\n        this.hooksFn = [];\r\n        this.registerHooks(this.scroll.hooks, 'destroy', this.destroy);\r\n    };\r\n    MouseWheel.prototype.registerEvent = function () {\r\n        this.eventRegister = new EventRegister(this.scroll.scroller.wrapper, [\r\n            {\r\n                name: 'wheel',\r\n                handler: this.wheelHandler.bind(this),\r\n            },\r\n            {\r\n                name: 'mousewheel',\r\n                handler: this.wheelHandler.bind(this),\r\n            },\r\n            {\r\n                name: 'DOMMouseScroll',\r\n                handler: this.wheelHandler.bind(this),\r\n            },\r\n        ]);\r\n    };\r\n    MouseWheel.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    MouseWheel.prototype.wheelHandler = function (e) {\r\n        if (!this.scroll.enabled) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e);\r\n        // start\r\n        if (!this.wheelStart) {\r\n            this.wheelStartHandler(e);\r\n            this.wheelStart = true;\r\n        }\r\n        // move\r\n        var delta = this.getWheelDelta(e);\r\n        this.wheelMoveHandler(delta);\r\n        // end\r\n        this.wheelEndDetector(delta);\r\n    };\r\n    MouseWheel.prototype.wheelStartHandler = function (e) {\r\n        this.cleanCache();\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        scrollBehaviorX.setMovingDirection(0 /* Default */);\r\n        scrollBehaviorY.setMovingDirection(0 /* Default */);\r\n        scrollBehaviorX.setDirection(0 /* Default */);\r\n        scrollBehaviorY.setDirection(0 /* Default */);\r\n        this.scroll.trigger(this.scroll.eventTypes.alterOptions, this.mouseWheelOpt);\r\n        this.scroll.trigger(this.scroll.eventTypes.mousewheelStart);\r\n    };\r\n    MouseWheel.prototype.cleanCache = function () {\r\n        this.deltaCache = [];\r\n    };\r\n    MouseWheel.prototype.wheelMoveHandler = function (delta) {\r\n        var _this = this;\r\n        var _a = this.mouseWheelOpt, throttleTime = _a.throttleTime, dampingFactor = _a.dampingFactor;\r\n        if (throttleTime && this.wheelMoveTimer) {\r\n            this.deltaCache.push(delta);\r\n        }\r\n        else {\r\n            var cachedDelta = this.deltaCache.reduce(function (prev, current) {\r\n                return {\r\n                    x: prev.x + current.x,\r\n                    y: prev.y + current.y,\r\n                };\r\n            }, { x: 0, y: 0 });\r\n            this.cleanCache();\r\n            var _b = this.scroll.scroller, scrollBehaviorX = _b.scrollBehaviorX, scrollBehaviorY = _b.scrollBehaviorY;\r\n            scrollBehaviorX.setMovingDirection(-delta.directionX);\r\n            scrollBehaviorY.setMovingDirection(-delta.directionY);\r\n            scrollBehaviorX.setDirection(delta.x);\r\n            scrollBehaviorY.setDirection(delta.y);\r\n            // when out of boundary, perform a damping scroll\r\n            var newX = scrollBehaviorX.performDampingAlgorithm(Math.round(delta.x) + cachedDelta.x, dampingFactor);\r\n            var newY = scrollBehaviorY.performDampingAlgorithm(Math.round(delta.y) + cachedDelta.x, dampingFactor);\r\n            if (!this.scroll.trigger(this.scroll.eventTypes.mousewheelMove, {\r\n                x: newX,\r\n                y: newY,\r\n            })) {\r\n                var easeTime = this.getEaseTime();\r\n                if (newX !== this.scroll.x || newY !== this.scroll.y) {\r\n                    this.scroll.scrollTo(newX, newY, easeTime);\r\n                }\r\n            }\r\n            if (throttleTime) {\r\n                this.wheelMoveTimer = window.setTimeout(function () {\r\n                    _this.wheelMoveTimer = 0;\r\n                }, throttleTime);\r\n            }\r\n        }\r\n    };\r\n    MouseWheel.prototype.wheelEndDetector = function (delta) {\r\n        var _this = this;\r\n        window.clearTimeout(this.wheelEndTimer);\r\n        this.wheelEndTimer = window.setTimeout(function () {\r\n            _this.wheelStart = false;\r\n            window.clearTimeout(_this.wheelMoveTimer);\r\n            _this.wheelMoveTimer = 0;\r\n            _this.scroll.trigger(_this.scroll.eventTypes.mousewheelEnd, delta);\r\n        }, this.mouseWheelOpt.discreteTime);\r\n    };\r\n    MouseWheel.prototype.getWheelDelta = function (e) {\r\n        var _a = this.mouseWheelOpt, speed = _a.speed, invert = _a.invert;\r\n        var wheelDeltaX = 0;\r\n        var wheelDeltaY = 0;\r\n        var direction = invert ? -1 /* Negative */ : 1 /* Positive */;\r\n        switch (true) {\r\n            case 'deltaX' in e:\r\n                if (e.deltaMode === 1) {\r\n                    wheelDeltaX = -e.deltaX * speed;\r\n                    wheelDeltaY = -e.deltaY * speed;\r\n                }\r\n                else {\r\n                    wheelDeltaX = -e.deltaX;\r\n                    wheelDeltaY = -e.deltaY;\r\n                }\r\n                break;\r\n            case 'wheelDeltaX' in e:\r\n                wheelDeltaX = (e.wheelDeltaX / 120) * speed;\r\n                wheelDeltaY = (e.wheelDeltaY / 120) * speed;\r\n                break;\r\n            case 'wheelDelta' in e:\r\n                wheelDeltaX = wheelDeltaY = (e.wheelDelta / 120) * speed;\r\n                break;\r\n            case 'detail' in e:\r\n                wheelDeltaX = wheelDeltaY = (-e.detail / 3) * speed;\r\n                break;\r\n        }\r\n        wheelDeltaX *= direction;\r\n        wheelDeltaY *= direction;\r\n        if (!this.scroll.hasVerticalScroll) {\r\n            if (Math.abs(wheelDeltaY) > Math.abs(wheelDeltaX)) {\r\n                wheelDeltaX = wheelDeltaY;\r\n            }\r\n            wheelDeltaY = 0;\r\n        }\r\n        if (!this.scroll.hasHorizontalScroll) {\r\n            wheelDeltaX = 0;\r\n        }\r\n        var directionX = wheelDeltaX > 0\r\n            ? -1 /* Negative */\r\n            : wheelDeltaX < 0\r\n                ? 1 /* Positive */\r\n                : 0 /* Default */;\r\n        var directionY = wheelDeltaY > 0\r\n            ? -1 /* Negative */\r\n            : wheelDeltaY < 0\r\n                ? 1 /* Positive */\r\n                : 0 /* Default */;\r\n        return {\r\n            x: wheelDeltaX,\r\n            y: wheelDeltaY,\r\n            directionX: directionX,\r\n            directionY: directionY,\r\n        };\r\n    };\r\n    MouseWheel.prototype.beforeHandler = function (e) {\r\n        var _a = this.scroll.options, preventDefault = _a.preventDefault, stopPropagation = _a.stopPropagation, preventDefaultException = _a.preventDefaultException;\r\n        if (preventDefault &&\r\n            !preventDefaultExceptionFn(e.target, preventDefaultException)) {\r\n            e.preventDefault();\r\n        }\r\n        if (stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    MouseWheel.prototype.getEaseTime = function () {\r\n        var SAFE_EASETIME = 100;\r\n        var easeTime = this.mouseWheelOpt.easeTime;\r\n        // scrollEnd event will be triggered in every calling of scrollTo when easeTime is too small\r\n        // easeTime needs to be greater than 100\r\n        if (easeTime < SAFE_EASETIME) {\r\n            warn(\"easeTime should be greater than 100.\" +\r\n                \"If mouseWheel easeTime is too small,\" +\r\n                \"scrollEnd will be triggered many times.\");\r\n        }\r\n        return Math.max(easeTime, SAFE_EASETIME);\r\n    };\r\n    MouseWheel.prototype.destroy = function () {\r\n        this.eventRegister.destroy();\r\n        window.clearTimeout(this.wheelEndTimer);\r\n        window.clearTimeout(this.wheelMoveTimer);\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n    };\r\n    MouseWheel.pluginName = 'mouseWheel';\r\n    MouseWheel.applyOrder = \"pre\" /* Pre */;\r\n    return MouseWheel;\r\n}());\n\nvar ObserveDOM = /** @class */ (function () {\r\n    function ObserveDOM(scroll) {\r\n        this.scroll = scroll;\r\n        this.stopObserver = false;\r\n        this.init();\r\n    }\r\n    ObserveDOM.prototype.init = function () {\r\n        this.handleMutationObserver();\r\n        this.handleHooks();\r\n    };\r\n    ObserveDOM.prototype.handleMutationObserver = function () {\r\n        var _this = this;\r\n        if (typeof MutationObserver !== 'undefined') {\r\n            var timer_1 = 0;\r\n            this.observer = new MutationObserver(function (mutations) {\r\n                _this.mutationObserverHandler(mutations, timer_1);\r\n            });\r\n            this.startObserve(this.observer);\r\n        }\r\n        else {\r\n            this.checkDOMUpdate();\r\n        }\r\n    };\r\n    ObserveDOM.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        this.hooksFn = [];\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.contentChanged, function () {\r\n            _this.stopObserve();\r\n            // launch a new mutationObserver\r\n            _this.handleMutationObserver();\r\n        });\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.enable, function () {\r\n            if (_this.stopObserver) {\r\n                _this.handleMutationObserver();\r\n            }\r\n        });\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.disable, function () {\r\n            _this.stopObserve();\r\n        });\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.destroy, function () {\r\n            _this.destroy();\r\n        });\r\n    };\r\n    ObserveDOM.prototype.mutationObserverHandler = function (mutations, timer) {\r\n        var _this = this;\r\n        if (this.shouldNotRefresh()) {\r\n            return;\r\n        }\r\n        var immediateRefresh = false;\r\n        var deferredRefresh = false;\r\n        for (var i = 0; i < mutations.length; i++) {\r\n            var mutation = mutations[i];\r\n            if (mutation.type !== 'attributes') {\r\n                immediateRefresh = true;\r\n                break;\r\n            }\r\n            else {\r\n                if (mutation.target !== this.scroll.scroller.content) {\r\n                    deferredRefresh = true;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (immediateRefresh) {\r\n            this.scroll.refresh();\r\n        }\r\n        else if (deferredRefresh) {\r\n            // attributes changes too often\r\n            clearTimeout(timer);\r\n            timer = window.setTimeout(function () {\r\n                if (!_this.shouldNotRefresh()) {\r\n                    _this.scroll.refresh();\r\n                }\r\n            }, 60);\r\n        }\r\n    };\r\n    ObserveDOM.prototype.startObserve = function (observer) {\r\n        var config = {\r\n            attributes: true,\r\n            childList: true,\r\n            subtree: true,\r\n        };\r\n        observer.observe(this.scroll.scroller.content, config);\r\n    };\r\n    ObserveDOM.prototype.shouldNotRefresh = function () {\r\n        var scroller = this.scroll.scroller;\r\n        var scrollBehaviorX = scroller.scrollBehaviorX, scrollBehaviorY = scroller.scrollBehaviorY;\r\n        var outsideBoundaries = scrollBehaviorX.currentPos > scrollBehaviorX.minScrollPos ||\r\n            scrollBehaviorX.currentPos < scrollBehaviorX.maxScrollPos ||\r\n            scrollBehaviorY.currentPos > scrollBehaviorY.minScrollPos ||\r\n            scrollBehaviorY.currentPos < scrollBehaviorY.maxScrollPos;\r\n        return scroller.animater.pending || outsideBoundaries;\r\n    };\r\n    ObserveDOM.prototype.checkDOMUpdate = function () {\r\n        var _this = this;\r\n        var content = this.scroll.scroller.content;\r\n        var contentRect = getRect(content);\r\n        var oldWidth = contentRect.width;\r\n        var oldHeight = contentRect.height;\r\n        var check = function () {\r\n            if (_this.stopObserver) {\r\n                return;\r\n            }\r\n            contentRect = getRect(content);\r\n            var newWidth = contentRect.width;\r\n            var newHeight = contentRect.height;\r\n            if (oldWidth !== newWidth || oldHeight !== newHeight) {\r\n                _this.scroll.refresh();\r\n            }\r\n            oldWidth = newWidth;\r\n            oldHeight = newHeight;\r\n            next();\r\n        };\r\n        var next = function () {\r\n            setTimeout(function () {\r\n                check();\r\n            }, 1000);\r\n        };\r\n        next();\r\n    };\r\n    ObserveDOM.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    ObserveDOM.prototype.stopObserve = function () {\r\n        this.stopObserver = true;\r\n        if (this.observer) {\r\n            this.observer.disconnect();\r\n        }\r\n    };\r\n    ObserveDOM.prototype.destroy = function () {\r\n        this.stopObserve();\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    ObserveDOM.pluginName = 'observeDOM';\r\n    return ObserveDOM;\r\n}());\n\nvar sourcePrefix$6 = 'plugins.pullDownRefresh';\r\nvar propertiesMap$6 = [\r\n    {\r\n        key: 'finishPullDown',\r\n        name: 'finishPullDown'\r\n    },\r\n    {\r\n        key: 'openPullDown',\r\n        name: 'openPullDown'\r\n    },\r\n    {\r\n        key: 'closePullDown',\r\n        name: 'closePullDown'\r\n    },\r\n    {\r\n        key: 'autoPullDownRefresh',\r\n        name: 'autoPullDownRefresh'\r\n    }\r\n];\r\nvar propertiesConfig$6 = propertiesMap$6.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$6 + \".\" + item.name\r\n    };\r\n});\n\nvar PULLING_DOWN_EVENT = 'pullingDown';\r\nvar ENTER_THRESHOLD_EVENT = 'enterThreshold';\r\nvar LEAVE_THRESHOLD_EVENT = 'leaveThreshold';\r\nvar PullDown = /** @class */ (function () {\r\n    function PullDown(scroll) {\r\n        this.scroll = scroll;\r\n        this.pulling = 0 /* DEFAULT */;\r\n        this.thresholdBoundary = 0 /* DEFAULT */;\r\n        this.init();\r\n    }\r\n    PullDown.prototype.setPulling = function (status) {\r\n        this.pulling = status;\r\n    };\r\n    PullDown.prototype.setThresholdBoundary = function (boundary) {\r\n        this.thresholdBoundary = boundary;\r\n    };\r\n    PullDown.prototype.init = function () {\r\n        this.handleBScroll();\r\n        this.handleOptions(this.scroll.options.pullDownRefresh);\r\n        this.handleHooks();\r\n        this.watch();\r\n    };\r\n    PullDown.prototype.handleBScroll = function () {\r\n        this.scroll.registerType([\r\n            PULLING_DOWN_EVENT,\r\n            ENTER_THRESHOLD_EVENT,\r\n            LEAVE_THRESHOLD_EVENT,\r\n        ]);\r\n        this.scroll.proxy(propertiesConfig$6);\r\n    };\r\n    PullDown.prototype.handleOptions = function (userOptions) {\r\n        if (userOptions === void 0) { userOptions = {}; }\r\n        userOptions = (userOptions === true ? {} : userOptions);\r\n        var defaultOptions = {\r\n            threshold: 90,\r\n            stop: 40,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n        this.scroll.options.probeType = 3 /* Realtime */;\r\n    };\r\n    PullDown.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        this.hooksFn = [];\r\n        var scroller = this.scroll.scroller;\r\n        var scrollBehaviorY = scroller.scrollBehaviorY;\r\n        this.currentMinScrollY = this.cachedOriginanMinScrollY =\r\n            scrollBehaviorY.minScrollPos;\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.contentChanged, function () {\r\n            _this.finishPullDown();\r\n        });\r\n        this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\r\n            // content is smaller than wrapper\r\n            if (boundary.maxScrollPos > 0) {\r\n                // allow scrolling when content is not full of wrapper\r\n                boundary.maxScrollPos = -1;\r\n            }\r\n            boundary.minScrollPos = _this.currentMinScrollY;\r\n        });\r\n        // integrate with mousewheel\r\n        if (this.hasMouseWheelPlugin()) {\r\n            this.registerHooks(this.scroll, this.scroll.eventTypes.alterOptions, function (mouseWheelOptions) {\r\n                var SANE_DISCRETE_TIME = 300;\r\n                var SANE_EASE_TIME = 350;\r\n                mouseWheelOptions.discreteTime = SANE_DISCRETE_TIME;\r\n                // easeTime > discreteTime ensure goInto checkPullDown function\r\n                mouseWheelOptions.easeTime = SANE_EASE_TIME;\r\n            });\r\n            this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelEnd, function () {\r\n                // mouseWheel need trigger checkPullDown manually\r\n                scroller.hooks.trigger(scroller.hooks.eventTypes.end);\r\n            });\r\n        }\r\n    };\r\n    PullDown.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    PullDown.prototype.hasMouseWheelPlugin = function () {\r\n        return !!this.scroll.eventTypes.alterOptions;\r\n    };\r\n    PullDown.prototype.watch = function () {\r\n        var scroller = this.scroll.scroller;\r\n        this.watching = true;\r\n        this.registerHooks(scroller.hooks, scroller.hooks.eventTypes.end, this.checkPullDown);\r\n        this.registerHooks(this.scroll, this.scroll.eventTypes.scrollStart, this.resetStateBeforeScrollStart);\r\n        this.registerHooks(this.scroll, this.scroll.eventTypes.scroll, this.checkLocationOfThresholdBoundary);\r\n        if (this.hasMouseWheelPlugin()) {\r\n            this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelStart, this.resetStateBeforeScrollStart);\r\n        }\r\n    };\r\n    PullDown.prototype.resetStateBeforeScrollStart = function () {\r\n        // current fetching pulldownRefresh has ended\r\n        if (!this.isFetchingStatus()) {\r\n            this.setPulling(1 /* MOVING */);\r\n            this.setThresholdBoundary(0 /* DEFAULT */);\r\n        }\r\n    };\r\n    PullDown.prototype.checkLocationOfThresholdBoundary = function () {\r\n        // pulldownRefresh is in the phase of Moving\r\n        if (this.pulling === 1 /* MOVING */) {\r\n            var scroll_1 = this.scroll;\r\n            // enter threshold boundary\r\n            var enteredThresholdBoundary = this.thresholdBoundary !== 1 /* INSIDE */ &&\r\n                this.locateInsideThresholdBoundary();\r\n            // leave threshold boundary\r\n            var leftThresholdBoundary = this.thresholdBoundary !== 2 /* OUTSIDE */ &&\r\n                !this.locateInsideThresholdBoundary();\r\n            if (enteredThresholdBoundary) {\r\n                this.setThresholdBoundary(1 /* INSIDE */);\r\n                scroll_1.trigger(ENTER_THRESHOLD_EVENT);\r\n            }\r\n            if (leftThresholdBoundary) {\r\n                this.setThresholdBoundary(2 /* OUTSIDE */);\r\n                scroll_1.trigger(LEAVE_THRESHOLD_EVENT);\r\n            }\r\n        }\r\n    };\r\n    PullDown.prototype.locateInsideThresholdBoundary = function () {\r\n        return this.scroll.y <= this.options.threshold;\r\n    };\r\n    PullDown.prototype.unwatch = function () {\r\n        var scroll = this.scroll;\r\n        var scroller = scroll.scroller;\r\n        this.watching = false;\r\n        scroller.hooks.off(scroller.hooks.eventTypes.end, this.checkPullDown);\r\n        scroll.off(scroll.eventTypes.scrollStart, this.resetStateBeforeScrollStart);\r\n        scroll.off(scroll.eventTypes.scroll, this.checkLocationOfThresholdBoundary);\r\n        if (this.hasMouseWheelPlugin()) {\r\n            scroll.off(scroll.eventTypes.mousewheelStart, this.resetStateBeforeScrollStart);\r\n        }\r\n    };\r\n    PullDown.prototype.checkPullDown = function () {\r\n        var _a = this.options, threshold = _a.threshold, stop = _a.stop;\r\n        // check if a real pull down action\r\n        if (this.scroll.y < threshold) {\r\n            return false;\r\n        }\r\n        if (this.pulling === 1 /* MOVING */) {\r\n            this.modifyBehaviorYBoundary(stop);\r\n            this.setPulling(2 /* FETCHING */);\r\n            this.scroll.trigger(PULLING_DOWN_EVENT);\r\n        }\r\n        this.scroll.scrollTo(this.scroll.x, stop, this.scroll.options.bounceTime, ease.bounce);\r\n        return this.isFetchingStatus();\r\n    };\r\n    PullDown.prototype.isFetchingStatus = function () {\r\n        return this.pulling === 2 /* FETCHING */;\r\n    };\r\n    PullDown.prototype.modifyBehaviorYBoundary = function (stopDistance) {\r\n        var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n        // manually modify minScrollPos for a hang animation\r\n        // to prevent from resetPosition\r\n        this.cachedOriginanMinScrollY = scrollBehaviorY.minScrollPos;\r\n        this.currentMinScrollY = stopDistance;\r\n        scrollBehaviorY.computeBoundary();\r\n    };\r\n    PullDown.prototype.finishPullDown = function () {\r\n        if (this.isFetchingStatus()) {\r\n            var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n            // restore minScrollY since the hang animation has ended\r\n            this.currentMinScrollY = this.cachedOriginanMinScrollY;\r\n            scrollBehaviorY.computeBoundary();\r\n            this.setPulling(0 /* DEFAULT */);\r\n            this.scroll.resetPosition(this.scroll.options.bounceTime, ease.bounce);\r\n        }\r\n    };\r\n    // allow 'true' type is compat for beta version implements\r\n    PullDown.prototype.openPullDown = function (config) {\r\n        if (config === void 0) { config = {}; }\r\n        this.handleOptions(config);\r\n        if (!this.watching) {\r\n            this.watch();\r\n        }\r\n    };\r\n    PullDown.prototype.closePullDown = function () {\r\n        this.unwatch();\r\n    };\r\n    PullDown.prototype.autoPullDownRefresh = function () {\r\n        var _a = this.options, threshold = _a.threshold, stop = _a.stop;\r\n        if (this.isFetchingStatus() || !this.watching) {\r\n            return;\r\n        }\r\n        this.modifyBehaviorYBoundary(stop);\r\n        this.scroll.trigger(this.scroll.eventTypes.scrollStart);\r\n        this.scroll.scrollTo(this.scroll.x, threshold);\r\n        this.setPulling(2 /* FETCHING */);\r\n        this.scroll.trigger(PULLING_DOWN_EVENT);\r\n        this.scroll.scrollTo(this.scroll.x, stop, this.scroll.options.bounceTime, ease.bounce);\r\n    };\r\n    PullDown.pluginName = 'pullDownRefresh';\r\n    return PullDown;\r\n}());\n\nvar sourcePrefix$5 = 'plugins.pullUpLoad';\r\nvar propertiesMap$5 = [\r\n    {\r\n        key: 'finishPullUp',\r\n        name: 'finishPullUp'\r\n    },\r\n    {\r\n        key: 'openPullUp',\r\n        name: 'openPullUp'\r\n    },\r\n    {\r\n        key: 'closePullUp',\r\n        name: 'closePullUp'\r\n    },\r\n    {\r\n        key: 'autoPullUpLoad',\r\n        name: 'autoPullUpLoad'\r\n    }\r\n];\r\nvar propertiesConfig$5 = propertiesMap$5.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$5 + \".\" + item.name\r\n    };\r\n});\n\nvar PULL_UP_HOOKS_NAME = 'pullingUp';\r\nvar PullUp = /** @class */ (function () {\r\n    function PullUp(scroll) {\r\n        this.scroll = scroll;\r\n        this.pulling = false;\r\n        this.watching = false;\r\n        this.init();\r\n    }\r\n    PullUp.prototype.init = function () {\r\n        this.handleBScroll();\r\n        this.handleOptions(this.scroll.options.pullUpLoad);\r\n        this.handleHooks();\r\n        this.watch();\r\n    };\r\n    PullUp.prototype.handleBScroll = function () {\r\n        this.scroll.registerType([PULL_UP_HOOKS_NAME]);\r\n        this.scroll.proxy(propertiesConfig$5);\r\n    };\r\n    PullUp.prototype.handleOptions = function (userOptions) {\r\n        if (userOptions === void 0) { userOptions = {}; }\r\n        userOptions = (userOptions === true ? {} : userOptions);\r\n        var defaultOptions = {\r\n            threshold: 0,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n        this.scroll.options.probeType = 3 /* Realtime */;\r\n    };\r\n    PullUp.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        this.hooksFn = [];\r\n        var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.contentChanged, function () {\r\n            _this.finishPullUp();\r\n        });\r\n        this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\r\n            // content is smaller than wrapper\r\n            if (boundary.maxScrollPos > 0) {\r\n                // allow scrolling when content is not full of wrapper\r\n                boundary.maxScrollPos = -1;\r\n            }\r\n        });\r\n    };\r\n    PullUp.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    PullUp.prototype.watch = function () {\r\n        if (this.watching) {\r\n            return;\r\n        }\r\n        this.watching = true;\r\n        this.registerHooks(this.scroll, this.scroll.eventTypes.scroll, this.checkPullUp);\r\n    };\r\n    PullUp.prototype.unwatch = function () {\r\n        this.watching = false;\r\n        this.scroll.off(this.scroll.eventTypes.scroll, this.checkPullUp);\r\n    };\r\n    PullUp.prototype.checkPullUp = function (pos) {\r\n        var _this = this;\r\n        var threshold = this.options.threshold;\r\n        if (this.scroll.movingDirectionY === 1 /* Positive */ &&\r\n            pos.y <= this.scroll.maxScrollY + threshold) {\r\n            this.pulling = true;\r\n            // must reset pulling after scrollEnd\r\n            this.scroll.once(this.scroll.eventTypes.scrollEnd, function () {\r\n                _this.pulling = false;\r\n            });\r\n            this.unwatch();\r\n            this.scroll.trigger(PULL_UP_HOOKS_NAME);\r\n        }\r\n    };\r\n    PullUp.prototype.finishPullUp = function () {\r\n        var _this = this;\r\n        // reset Direction, fix #936\r\n        this.scroll.scroller.scrollBehaviorY.setMovingDirection(0 /* Default */);\r\n        if (this.pulling) {\r\n            this.scroll.once(this.scroll.eventTypes.scrollEnd, function () {\r\n                _this.watch();\r\n            });\r\n        }\r\n        else {\r\n            this.watch();\r\n        }\r\n    };\r\n    // allow 'true' type is compat for beta version implements\r\n    PullUp.prototype.openPullUp = function (config) {\r\n        if (config === void 0) { config = {}; }\r\n        this.handleOptions(config);\r\n        this.watch();\r\n    };\r\n    PullUp.prototype.closePullUp = function () {\r\n        this.unwatch();\r\n    };\r\n    PullUp.prototype.autoPullUpLoad = function () {\r\n        var threshold = this.options.threshold;\r\n        var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n        if (this.pulling || !this.watching) {\r\n            return;\r\n        }\r\n        // simulate a pullUp action\r\n        var NEGATIVE_VALUE = -1;\r\n        var outOfBoundaryPos = scrollBehaviorY.maxScrollPos + threshold + NEGATIVE_VALUE;\r\n        this.scroll.scroller.scrollBehaviorY.setMovingDirection(NEGATIVE_VALUE);\r\n        this.scroll.scrollTo(this.scroll.x, outOfBoundaryPos, this.scroll.options.bounceTime);\r\n    };\r\n    PullUp.pluginName = 'pullUpLoad';\r\n    return PullUp;\r\n}());\n\nvar EventHandler = /** @class */ (function () {\r\n    function EventHandler(indicator, options) {\r\n        this.indicator = indicator;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter(['touchStart', 'touchMove', 'touchEnd']);\r\n        this.registerEvents();\r\n    }\r\n    EventHandler.prototype.registerEvents = function () {\r\n        var _a = this.options, disableMouse = _a.disableMouse, disableTouch = _a.disableTouch;\r\n        var startEvents = [];\r\n        var moveEvents = [];\r\n        var endEvents = [];\r\n        if (!disableMouse) {\r\n            startEvents.push({\r\n                name: 'mousedown',\r\n                handler: this.start.bind(this),\r\n            });\r\n            moveEvents.push({\r\n                name: 'mousemove',\r\n                handler: this.move.bind(this),\r\n            });\r\n            endEvents.push({\r\n                name: 'mouseup',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        if (!disableTouch) {\r\n            startEvents.push({\r\n                name: 'touchstart',\r\n                handler: this.start.bind(this),\r\n            });\r\n            moveEvents.push({\r\n                name: 'touchmove',\r\n                handler: this.move.bind(this),\r\n            });\r\n            endEvents.push({\r\n                name: 'touchend',\r\n                handler: this.end.bind(this),\r\n            }, {\r\n                name: 'touchcancel',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        this.startEventRegister = new EventRegister(this.indicator.indicatorEl, startEvents);\r\n        this.moveEventRegister = new EventRegister(window, moveEvents);\r\n        this.endEventRegister = new EventRegister(window, endEvents);\r\n    };\r\n    EventHandler.prototype.BScrollIsDisabled = function () {\r\n        return !this.indicator.scroll.enabled;\r\n    };\r\n    EventHandler.prototype.start = function (e) {\r\n        if (this.BScrollIsDisabled()) {\r\n            return;\r\n        }\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.initiated = true;\r\n        this.lastPoint = point[this.indicator.keysMap.point];\r\n        this.hooks.trigger(this.hooks.eventTypes.touchStart);\r\n    };\r\n    EventHandler.prototype.move = function (e) {\r\n        if (!this.initiated) {\r\n            return;\r\n        }\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        var pointPos = point[this.indicator.keysMap.point];\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        var delta = pointPos - this.lastPoint;\r\n        this.lastPoint = pointPos;\r\n        this.hooks.trigger(this.hooks.eventTypes.touchMove, delta);\r\n    };\r\n    EventHandler.prototype.end = function (e) {\r\n        if (!this.initiated) {\r\n            return;\r\n        }\r\n        this.initiated = false;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.hooks.trigger(this.hooks.eventTypes.touchEnd);\r\n    };\r\n    EventHandler.prototype.destroy = function () {\r\n        this.startEventRegister.destroy();\r\n        this.moveEventRegister.destroy();\r\n        this.endEventRegister.destroy();\r\n    };\r\n    return EventHandler;\r\n}());\n\nvar Indicator$1 = /** @class */ (function () {\r\n    function Indicator(scroll, options) {\r\n        this.scroll = scroll;\r\n        this.options = options;\r\n        this.hooksFn = [];\r\n        this.wrapper = options.wrapper;\r\n        this.direction = options.direction;\r\n        this.indicatorEl = this.wrapper.children[0];\r\n        this.keysMap = this.getKeysMap();\r\n        this.handleFade();\r\n        this.handleHooks();\r\n    }\r\n    Indicator.prototype.handleFade = function () {\r\n        if (this.options.fade) {\r\n            this.wrapper.style.opacity = '0';\r\n        }\r\n    };\r\n    Indicator.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var _a = this.options, fade = _a.fade, interactive = _a.interactive, scrollbarTrackClickable = _a.scrollbarTrackClickable;\r\n        var scroll = this.scroll;\r\n        var scrollHooks = scroll.hooks;\r\n        var translaterHooks = scroll.scroller.translater.hooks;\r\n        var animaterHooks = scroll.scroller.animater.hooks;\r\n        this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refresh);\r\n        this.registerHooks(translaterHooks, translaterHooks.eventTypes.translate, function (pos) {\r\n            var hasScrollKey = _this.keysMap.hasScroll;\r\n            if (_this.scroll[hasScrollKey]) {\r\n                _this.updatePosition(pos);\r\n            }\r\n        });\r\n        this.registerHooks(animaterHooks, animaterHooks.eventTypes.time, this.transitionTime);\r\n        this.registerHooks(animaterHooks, animaterHooks.eventTypes.timeFunction, this.transitionTimingFunction);\r\n        if (fade) {\r\n            this.registerHooks(scroll, scroll.eventTypes.scrollEnd, function () {\r\n                _this.fade();\r\n            });\r\n            this.registerHooks(scroll, scroll.eventTypes.scrollStart, function () {\r\n                _this.fade(true);\r\n            });\r\n            // for mousewheel event\r\n            if (scroll.eventTypes.mousewheelStart &&\r\n                scroll.eventTypes.mousewheelEnd) {\r\n                this.registerHooks(scroll, scroll.eventTypes.mousewheelStart, function () {\r\n                    _this.fade(true);\r\n                });\r\n                this.registerHooks(scroll, scroll.eventTypes.mousewheelMove, function () {\r\n                    _this.fade(true);\r\n                });\r\n                this.registerHooks(scroll, scroll.eventTypes.mousewheelEnd, function () {\r\n                    _this.fade();\r\n                });\r\n            }\r\n        }\r\n        if (interactive) {\r\n            var _b = this.scroll.options, disableMouse = _b.disableMouse, disableTouch = _b.disableTouch;\r\n            this.eventHandler = new EventHandler(this, {\r\n                disableMouse: disableMouse,\r\n                disableTouch: disableTouch,\r\n            });\r\n            var eventHandlerHooks = this.eventHandler.hooks;\r\n            this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchStart, this.startHandler);\r\n            this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchMove, this.moveHandler);\r\n            this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchEnd, this.endHandler);\r\n        }\r\n        if (scrollbarTrackClickable) {\r\n            this.bindClick();\r\n        }\r\n    };\r\n    Indicator.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Indicator.prototype.bindClick = function () {\r\n        var wrapper = this.wrapper;\r\n        this.clickEventRegister = new EventRegister(wrapper, [\r\n            {\r\n                name: 'click',\r\n                handler: this.handleClick.bind(this),\r\n            },\r\n        ]);\r\n    };\r\n    Indicator.prototype.handleClick = function (e) {\r\n        var newPos = this.calculateclickOffsetPos(e);\r\n        var _a = this.scroll, x = _a.x, y = _a.y;\r\n        x = this.direction === \"horizontal\" /* Horizontal */ ? newPos : x;\r\n        y = this.direction === \"vertical\" /* Vertical */ ? newPos : y;\r\n        this.scroll.scrollTo(x, y, this.options.scrollbarTrackOffsetTime);\r\n    };\r\n    Indicator.prototype.calculateclickOffsetPos = function (e) {\r\n        var _a = this.keysMap, poinKey = _a.point, domRectKey = _a.domRect;\r\n        var scrollbarTrackOffsetType = this.options.scrollbarTrackOffsetType;\r\n        var clickPointOffset = e[poinKey] - this.wrapperRect[domRectKey];\r\n        var scrollToWhere = clickPointOffset < this.currentPos ? -1 /* Up */ : 1 /* Down */;\r\n        var delta = 0;\r\n        var currentPos = this.currentPos;\r\n        if (scrollbarTrackOffsetType === \"step\" /* Step */) {\r\n            delta = this.scrollInfo.baseSize * scrollToWhere;\r\n        }\r\n        else {\r\n            delta = 0;\r\n            currentPos = clickPointOffset;\r\n        }\r\n        return this.newPos(currentPos, delta, this.scrollInfo);\r\n    };\r\n    Indicator.prototype.getKeysMap = function () {\r\n        if (this.direction === \"vertical\" /* Vertical */) {\r\n            return {\r\n                hasScroll: 'hasVerticalScroll',\r\n                size: 'height',\r\n                wrapperSize: 'clientHeight',\r\n                scrollerSize: 'scrollerHeight',\r\n                maxScrollPos: 'maxScrollY',\r\n                pos: 'y',\r\n                point: 'pageY',\r\n                translateProperty: 'translateY',\r\n                domRect: 'top',\r\n            };\r\n        }\r\n        return {\r\n            hasScroll: 'hasHorizontalScroll',\r\n            size: 'width',\r\n            wrapperSize: 'clientWidth',\r\n            scrollerSize: 'scrollerWidth',\r\n            maxScrollPos: 'maxScrollX',\r\n            pos: 'x',\r\n            point: 'pageX',\r\n            translateProperty: 'translateX',\r\n            domRect: 'left',\r\n        };\r\n    };\r\n    Indicator.prototype.fade = function (visible) {\r\n        var _a = this.options, fadeInTime = _a.fadeInTime, fadeOutTime = _a.fadeOutTime;\r\n        var time = visible ? fadeInTime : fadeOutTime;\r\n        var wrapper = this.wrapper;\r\n        wrapper.style[style.transitionDuration] = time + 'ms';\r\n        wrapper.style.opacity = visible ? '1' : '0';\r\n    };\r\n    Indicator.prototype.refresh = function () {\r\n        var hasScrollKey = this.keysMap.hasScroll;\r\n        var scroll = this.scroll;\r\n        var x = scroll.x, y = scroll.y;\r\n        this.wrapperRect = this.wrapper.getBoundingClientRect();\r\n        if (this.canScroll(scroll[hasScrollKey])) {\r\n            var _a = this.keysMap, wrapperSizeKey = _a.wrapperSize, scrollerSizeKey = _a.scrollerSize, maxScrollPosKey = _a.maxScrollPos;\r\n            this.scrollInfo = this.refreshScrollInfo(this.wrapper[wrapperSizeKey], scroll[scrollerSizeKey], scroll[maxScrollPosKey], this.indicatorEl[wrapperSizeKey]);\r\n            this.updatePosition({\r\n                x: x,\r\n                y: y,\r\n            });\r\n        }\r\n    };\r\n    Indicator.prototype.transitionTime = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        this.indicatorEl.style[style.transitionDuration] = time + 'ms';\r\n    };\r\n    Indicator.prototype.transitionTimingFunction = function (easing) {\r\n        this.indicatorEl.style[style.transitionTimingFunction] = easing;\r\n    };\r\n    Indicator.prototype.canScroll = function (hasScroll) {\r\n        this.wrapper.style.display = hasScroll ? 'block' : 'none';\r\n        return hasScroll;\r\n    };\r\n    Indicator.prototype.refreshScrollInfo = function (wrapperSize, scrollerSize, maxScrollPos, indicatorElSize) {\r\n        var baseSize = Math.max(Math.round((wrapperSize * wrapperSize) / (scrollerSize || wrapperSize || 1)), this.options.minSize);\r\n        if (this.options.isCustom) {\r\n            baseSize = indicatorElSize;\r\n        }\r\n        var maxIndicatorScrollPos = wrapperSize - baseSize;\r\n        // sizeRatio is negative\r\n        var sizeRatio = maxIndicatorScrollPos / maxScrollPos;\r\n        return {\r\n            baseSize: baseSize,\r\n            maxScrollPos: maxIndicatorScrollPos,\r\n            minScrollPos: 0,\r\n            sizeRatio: sizeRatio,\r\n        };\r\n    };\r\n    Indicator.prototype.updatePosition = function (point) {\r\n        var _a = this.caculatePosAndSize(point, this.scrollInfo), pos = _a.pos, size = _a.size;\r\n        this.refreshStyle(size, pos);\r\n        this.currentPos = pos;\r\n    };\r\n    Indicator.prototype.caculatePosAndSize = function (point, scrollInfo) {\r\n        var posKey = this.keysMap.pos;\r\n        var sizeRatio = scrollInfo.sizeRatio, baseSize = scrollInfo.baseSize, maxScrollPos = scrollInfo.maxScrollPos, minScrollPos = scrollInfo.minScrollPos;\r\n        var minSize = this.options.minSize;\r\n        var pos = Math.round(sizeRatio * point[posKey]);\r\n        var size;\r\n        // when out of boundary, slow down size reduction\r\n        if (pos < minScrollPos) {\r\n            size = Math.max(baseSize + pos * 3, minSize);\r\n            pos = minScrollPos;\r\n        }\r\n        else if (pos > maxScrollPos) {\r\n            size = Math.max(baseSize - (pos - maxScrollPos) * 3, minSize);\r\n            pos = maxScrollPos + baseSize - size;\r\n        }\r\n        else {\r\n            size = baseSize;\r\n        }\r\n        return {\r\n            pos: pos,\r\n            size: size,\r\n        };\r\n    };\r\n    Indicator.prototype.refreshStyle = function (size, pos) {\r\n        var _a = this.keysMap, translatePropertyKey = _a.translateProperty, sizeKey = _a.size;\r\n        var translateZ = this.scroll.options.translateZ;\r\n        this.indicatorEl.style[sizeKey] = size + \"px\";\r\n        this.indicatorEl.style[style.transform] = translatePropertyKey + \"(\" + pos + \"px)\" + translateZ;\r\n    };\r\n    Indicator.prototype.startHandler = function () {\r\n        this.moved = false;\r\n        this.startTime = getNow();\r\n        this.transitionTime();\r\n        this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.beforeScrollStart);\r\n    };\r\n    Indicator.prototype.moveHandler = function (delta) {\r\n        if (!this.moved && !this.indicatorNotMoved(delta)) {\r\n            this.moved = true;\r\n            this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollStart);\r\n        }\r\n        if (this.moved) {\r\n            var newPos = this.newPos(this.currentPos, delta, this.scrollInfo);\r\n            this.syncBScroll(newPos);\r\n        }\r\n    };\r\n    Indicator.prototype.endHandler = function () {\r\n        if (this.moved) {\r\n            var _a = this.scroll, x = _a.x, y = _a.y;\r\n            this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollEnd, {\r\n                x: x,\r\n                y: y,\r\n            });\r\n        }\r\n    };\r\n    Indicator.prototype.indicatorNotMoved = function (delta) {\r\n        var currentPos = this.currentPos;\r\n        var _a = this.scrollInfo, maxScrollPos = _a.maxScrollPos, minScrollPos = _a.minScrollPos;\r\n        var notMoved = (currentPos === minScrollPos && delta <= 0) ||\r\n            (currentPos === maxScrollPos && delta >= 0);\r\n        return notMoved;\r\n    };\r\n    Indicator.prototype.syncBScroll = function (newPos) {\r\n        var timestamp = getNow();\r\n        var _a = this.scroll, x = _a.x, y = _a.y, options = _a.options, scroller = _a.scroller, maxScrollY = _a.maxScrollY, minScrollY = _a.minScrollY, maxScrollX = _a.maxScrollX, minScrollX = _a.minScrollX;\r\n        var probeType = options.probeType, momentumLimitTime = options.momentumLimitTime;\r\n        var position = { x: x, y: y };\r\n        if (this.direction === \"vertical\" /* Vertical */) {\r\n            position.y = between(newPos, maxScrollY, minScrollY);\r\n        }\r\n        else {\r\n            position.x = between(newPos, maxScrollX, minScrollX);\r\n        }\r\n        scroller.translater.translate(position);\r\n        // dispatch scroll in interval time\r\n        if (timestamp - this.startTime > momentumLimitTime) {\r\n            this.startTime = timestamp;\r\n            if (probeType === 1 /* Throttle */) {\r\n                scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, position);\r\n            }\r\n        }\r\n        // dispatch scroll all the time\r\n        if (probeType > 1 /* Throttle */) {\r\n            scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, position);\r\n        }\r\n    };\r\n    Indicator.prototype.newPos = function (currentPos, delta, scrollInfo) {\r\n        var maxScrollPos = scrollInfo.maxScrollPos, sizeRatio = scrollInfo.sizeRatio, minScrollPos = scrollInfo.minScrollPos;\r\n        var newPos = currentPos + delta;\r\n        newPos = between(newPos, minScrollPos, maxScrollPos);\r\n        return Math.round(newPos / sizeRatio);\r\n    };\r\n    Indicator.prototype.destroy = function () {\r\n        var _a = this.options, interactive = _a.interactive, scrollbarTrackClickable = _a.scrollbarTrackClickable, isCustom = _a.isCustom;\r\n        if (interactive) {\r\n            this.eventHandler.destroy();\r\n        }\r\n        if (scrollbarTrackClickable) {\r\n            this.clickEventRegister.destroy();\r\n        }\r\n        if (!isCustom) {\r\n            this.wrapper.parentNode.removeChild(this.wrapper);\r\n        }\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    return Indicator;\r\n}());\n\nvar ScrollBar = /** @class */ (function () {\r\n    function ScrollBar(scroll) {\r\n        this.scroll = scroll;\r\n        this.handleOptions();\r\n        this.createIndicators();\r\n        this.handleHooks();\r\n    }\r\n    ScrollBar.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scroll = this.scroll;\r\n        scroll.hooks.on(scroll.hooks.eventTypes.destroy, function () {\r\n            for (var _i = 0, _a = _this.indicators; _i < _a.length; _i++) {\r\n                var indicator = _a[_i];\r\n                indicator.destroy();\r\n            }\r\n        });\r\n    };\r\n    ScrollBar.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.scrollbar === true\r\n            ? {}\r\n            : this.scroll.options.scrollbar);\r\n        var defaultOptions = {\r\n            fade: true,\r\n            fadeInTime: 250,\r\n            fadeOutTime: 500,\r\n            interactive: false,\r\n            customElements: [],\r\n            minSize: 8,\r\n            scrollbarTrackClickable: false,\r\n            scrollbarTrackOffsetType: \"step\" /* Step */,\r\n            scrollbarTrackOffsetTime: 300,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n    };\r\n    ScrollBar.prototype.createIndicators = function () {\r\n        var indicatorOptions;\r\n        var scroll = this.scroll;\r\n        var indicators = [];\r\n        var scrollDirectionConfigKeys = ['scrollX', 'scrollY'];\r\n        var indicatorDirections = [\r\n            \"horizontal\" /* Horizontal */,\r\n            \"vertical\" /* Vertical */,\r\n        ];\r\n        var customScrollbarEls = this.options.customElements;\r\n        for (var i = 0; i < scrollDirectionConfigKeys.length; i++) {\r\n            var key = scrollDirectionConfigKeys[i];\r\n            // wanna scroll in specified direction\r\n            if (scroll.options[key]) {\r\n                var customElement = customScrollbarEls.shift();\r\n                var direction = indicatorDirections[i];\r\n                var isCustom = false;\r\n                var scrollbarWrapper = customElement\r\n                    ? customElement\r\n                    : this.createScrollbarElement(direction);\r\n                // internal scrollbar\r\n                if (scrollbarWrapper !== customElement) {\r\n                    scroll.wrapper.appendChild(scrollbarWrapper);\r\n                }\r\n                else {\r\n                    // custom scrollbar passed by users\r\n                    isCustom = true;\r\n                }\r\n                indicatorOptions = __assign(__assign({ wrapper: scrollbarWrapper, direction: direction }, this.options), { isCustom: isCustom });\r\n                indicators.push(new Indicator$1(scroll, indicatorOptions));\r\n            }\r\n        }\r\n        this.indicators = indicators;\r\n    };\r\n    ScrollBar.prototype.createScrollbarElement = function (direction, scrollbarTrackClickable) {\r\n        if (scrollbarTrackClickable === void 0) { scrollbarTrackClickable = this.options.scrollbarTrackClickable; }\r\n        var scrollbarWrapperEl = document.createElement('div');\r\n        var scrollbarIndicatorEl = document.createElement('div');\r\n        scrollbarWrapperEl.style.cssText =\r\n            'position:absolute;z-index:9999;overflow:hidden;';\r\n        scrollbarIndicatorEl.style.cssText =\r\n            'box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px;';\r\n        scrollbarIndicatorEl.className = 'bscroll-indicator';\r\n        if (direction === \"horizontal\" /* Horizontal */) {\r\n            scrollbarWrapperEl.style.cssText +=\r\n                'height:7px;left:2px;right:2px;bottom:0;';\r\n            scrollbarIndicatorEl.style.height = '100%';\r\n            scrollbarWrapperEl.className = 'bscroll-horizontal-scrollbar';\r\n        }\r\n        else {\r\n            scrollbarWrapperEl.style.cssText +=\r\n                'width:7px;bottom:2px;top:2px;right:1px;';\r\n            scrollbarIndicatorEl.style.width = '100%';\r\n            scrollbarWrapperEl.className = 'bscroll-vertical-scrollbar';\r\n        }\r\n        if (!scrollbarTrackClickable) {\r\n            scrollbarWrapperEl.style.cssText += 'pointer-events:none;';\r\n        }\r\n        scrollbarWrapperEl.appendChild(scrollbarIndicatorEl);\r\n        return scrollbarWrapperEl;\r\n    };\r\n    ScrollBar.pluginName = 'scrollbar';\r\n    return ScrollBar;\r\n}());\n\nvar PagesMatrix = /** @class */ (function () {\r\n    function PagesMatrix(scroll) {\r\n        this.scroll = scroll;\r\n        this.init();\r\n    }\r\n    PagesMatrix.prototype.init = function () {\r\n        var scroller = this.scroll.scroller;\r\n        var scrollBehaviorX = scroller.scrollBehaviorX, scrollBehaviorY = scroller.scrollBehaviorY;\r\n        this.wrapperWidth = scrollBehaviorX.wrapperSize;\r\n        this.wrapperHeight = scrollBehaviorY.wrapperSize;\r\n        this.scrollerHeight = scrollBehaviorY.contentSize;\r\n        this.scrollerWidth = scrollBehaviorX.contentSize;\r\n        this.pages = this.buildPagesMatrix(this.wrapperWidth, this.wrapperHeight);\r\n        this.pageLengthOfX = this.pages ? this.pages.length : 0;\r\n        this.pageLengthOfY = this.pages && this.pages[0] ? this.pages[0].length : 0;\r\n    };\r\n    PagesMatrix.prototype.getPageStats = function (pageX, pageY) {\r\n        return this.pages[pageX][pageY];\r\n    };\r\n    PagesMatrix.prototype.getNearestPageIndex = function (x, y) {\r\n        var pageX = 0;\r\n        var pageY = 0;\r\n        var l = this.pages.length;\r\n        for (; pageX < l - 1; pageX++) {\r\n            if (x >= this.pages[pageX][0].cx) {\r\n                break;\r\n            }\r\n        }\r\n        l = this.pages[pageX].length;\r\n        for (; pageY < l - 1; pageY++) {\r\n            if (y >= this.pages[0][pageY].cy) {\r\n                break;\r\n            }\r\n        }\r\n        return {\r\n            pageX: pageX,\r\n            pageY: pageY,\r\n        };\r\n    };\r\n    // (n x 1) matrix for horizontal scroll or\r\n    // (1 * n) matrix for vertical scroll\r\n    PagesMatrix.prototype.buildPagesMatrix = function (stepX, stepY) {\r\n        var pages = [];\r\n        var x = 0;\r\n        var y;\r\n        var cx;\r\n        var cy;\r\n        var i = 0;\r\n        var l;\r\n        var maxScrollPosX = this.scroll.scroller.scrollBehaviorX.maxScrollPos;\r\n        var maxScrollPosY = this.scroll.scroller.scrollBehaviorY.maxScrollPos;\r\n        cx = Math.round(stepX / 2);\r\n        cy = Math.round(stepY / 2);\r\n        while (x > -this.scrollerWidth) {\r\n            pages[i] = [];\r\n            l = 0;\r\n            y = 0;\r\n            while (y > -this.scrollerHeight) {\r\n                pages[i][l] = {\r\n                    x: Math.max(x, maxScrollPosX),\r\n                    y: Math.max(y, maxScrollPosY),\r\n                    width: stepX,\r\n                    height: stepY,\r\n                    cx: x - cx,\r\n                    cy: y - cy,\r\n                };\r\n                y -= stepY;\r\n                l++;\r\n            }\r\n            x -= stepX;\r\n            i++;\r\n        }\r\n        return pages;\r\n    };\r\n    return PagesMatrix;\r\n}());\n\nvar BASE_PAGE = {\r\n    pageX: 0,\r\n    pageY: 0,\r\n    x: 0,\r\n    y: 0,\r\n};\n\nvar SlidePages = /** @class */ (function () {\r\n    function SlidePages(scroll, slideOptions) {\r\n        this.scroll = scroll;\r\n        this.slideOptions = slideOptions;\r\n        this.slideX = false;\r\n        this.slideY = false;\r\n        this.currentPage = extend({}, BASE_PAGE);\r\n    }\r\n    SlidePages.prototype.refresh = function () {\r\n        this.pagesMatrix = new PagesMatrix(this.scroll);\r\n        this.checkSlideLoop();\r\n        this.currentPage = this.getAdjustedCurrentPage();\r\n    };\r\n    SlidePages.prototype.getAdjustedCurrentPage = function () {\r\n        var _a = this.currentPage, pageX = _a.pageX, pageY = _a.pageY;\r\n        // page index should be handled\r\n        // because page counts may reduce\r\n        pageX = Math.min(pageX, this.pagesMatrix.pageLengthOfX - 1);\r\n        pageY = Math.min(pageY, this.pagesMatrix.pageLengthOfY - 1);\r\n        // loop scene should also be respected\r\n        // because clonedNode will cause pageLength increasing\r\n        if (this.loopX) {\r\n            pageX = Math.min(pageX, this.pagesMatrix.pageLengthOfX - 2);\r\n        }\r\n        if (this.loopY) {\r\n            pageY = Math.min(pageY, this.pagesMatrix.pageLengthOfY - 2);\r\n        }\r\n        var _b = this.pagesMatrix.getPageStats(pageX, pageY), x = _b.x, y = _b.y;\r\n        return { pageX: pageX, pageY: pageY, x: x, y: y };\r\n    };\r\n    SlidePages.prototype.setCurrentPage = function (newPage) {\r\n        this.currentPage = newPage;\r\n    };\r\n    SlidePages.prototype.getInternalPage = function (pageX, pageY) {\r\n        if (pageX >= this.pagesMatrix.pageLengthOfX) {\r\n            pageX = this.pagesMatrix.pageLengthOfX - 1;\r\n        }\r\n        else if (pageX < 0) {\r\n            pageX = 0;\r\n        }\r\n        if (pageY >= this.pagesMatrix.pageLengthOfY) {\r\n            pageY = this.pagesMatrix.pageLengthOfY - 1;\r\n        }\r\n        else if (pageY < 0) {\r\n            pageY = 0;\r\n        }\r\n        var _a = this.pagesMatrix.getPageStats(pageX, pageY), x = _a.x, y = _a.y;\r\n        return {\r\n            pageX: pageX,\r\n            pageY: pageY,\r\n            x: x,\r\n            y: y,\r\n        };\r\n    };\r\n    SlidePages.prototype.getInitialPage = function (showFirstPage, firstInitialised) {\r\n        if (showFirstPage === void 0) { showFirstPage = false; }\r\n        if (firstInitialised === void 0) { firstInitialised = false; }\r\n        var _a = this.slideOptions, startPageXIndex = _a.startPageXIndex, startPageYIndex = _a.startPageYIndex;\r\n        var firstPageX = this.loopX ? 1 : 0;\r\n        var firstPageY = this.loopY ? 1 : 0;\r\n        var pageX = showFirstPage ? firstPageX : this.currentPage.pageX;\r\n        var pageY = showFirstPage ? firstPageY : this.currentPage.pageY;\r\n        if (firstInitialised) {\r\n            pageX = this.loopX ? startPageXIndex + 1 : startPageXIndex;\r\n            pageY = this.loopY ? startPageYIndex + 1 : startPageYIndex;\r\n        }\r\n        else {\r\n            pageX = showFirstPage ? firstPageX : this.currentPage.pageX;\r\n            pageY = showFirstPage ? firstPageY : this.currentPage.pageY;\r\n        }\r\n        var _b = this.pagesMatrix.getPageStats(pageX, pageY), x = _b.x, y = _b.y;\r\n        return {\r\n            pageX: pageX,\r\n            pageY: pageY,\r\n            x: x,\r\n            y: y,\r\n        };\r\n    };\r\n    SlidePages.prototype.getExposedPage = function (page) {\r\n        var exposedPage = extend({}, page);\r\n        // only pageX or pageY need fix\r\n        if (this.loopX) {\r\n            exposedPage.pageX = this.fixedPage(exposedPage.pageX, this.pagesMatrix.pageLengthOfX - 2);\r\n        }\r\n        if (this.loopY) {\r\n            exposedPage.pageY = this.fixedPage(exposedPage.pageY, this.pagesMatrix.pageLengthOfY - 2);\r\n        }\r\n        return exposedPage;\r\n    };\r\n    SlidePages.prototype.getExposedPageByPageIndex = function (pageIndexX, pageIndexY) {\r\n        var page = {\r\n            pageX: pageIndexX,\r\n            pageY: pageIndexY,\r\n        };\r\n        if (this.loopX) {\r\n            page.pageX = pageIndexX + 1;\r\n        }\r\n        if (this.loopY) {\r\n            page.pageY = pageIndexY + 1;\r\n        }\r\n        var _a = this.pagesMatrix.getPageStats(page.pageX, page.pageY), x = _a.x, y = _a.y;\r\n        return {\r\n            x: x,\r\n            y: y,\r\n            pageX: pageIndexX,\r\n            pageY: pageIndexY,\r\n        };\r\n    };\r\n    SlidePages.prototype.getWillChangedPage = function (page) {\r\n        page = extend({}, page);\r\n        // Page need fix\r\n        if (this.loopX) {\r\n            page.pageX = this.fixedPage(page.pageX, this.pagesMatrix.pageLengthOfX - 2);\r\n            page.x = this.pagesMatrix.getPageStats(page.pageX + 1, 0).x;\r\n        }\r\n        if (this.loopY) {\r\n            page.pageY = this.fixedPage(page.pageY, this.pagesMatrix.pageLengthOfY - 2);\r\n            page.y = this.pagesMatrix.getPageStats(0, page.pageY + 1).y;\r\n        }\r\n        return page;\r\n    };\r\n    SlidePages.prototype.fixedPage = function (page, realPageLen) {\r\n        var pageIndex = [];\r\n        for (var i = 0; i < realPageLen; i++) {\r\n            pageIndex.push(i);\r\n        }\r\n        pageIndex.unshift(realPageLen - 1);\r\n        pageIndex.push(0);\r\n        return pageIndex[page];\r\n    };\r\n    SlidePages.prototype.getPageStats = function () {\r\n        return this.pagesMatrix.getPageStats(this.currentPage.pageX, this.currentPage.pageY);\r\n    };\r\n    SlidePages.prototype.getValidPageIndex = function (x, y) {\r\n        var lastX = this.pagesMatrix.pageLengthOfX - 1;\r\n        var lastY = this.pagesMatrix.pageLengthOfY - 1;\r\n        var firstX = 0;\r\n        var firstY = 0;\r\n        if (this.loopX) {\r\n            x += 1;\r\n            firstX = firstX + 1;\r\n            lastX = lastX - 1;\r\n        }\r\n        if (this.loopY) {\r\n            y += 1;\r\n            firstY = firstY + 1;\r\n            lastY = lastY - 1;\r\n        }\r\n        x = between(x, firstX, lastX);\r\n        y = between(y, firstY, lastY);\r\n        return {\r\n            pageX: x,\r\n            pageY: y,\r\n        };\r\n    };\r\n    SlidePages.prototype.nextPageIndex = function () {\r\n        return this.getPageIndexByDirection(\"positive\" /* Positive */);\r\n    };\r\n    SlidePages.prototype.prevPageIndex = function () {\r\n        return this.getPageIndexByDirection(\"negative\" /* Negative */);\r\n    };\r\n    SlidePages.prototype.getNearestPage = function (x, y) {\r\n        var pageIndex = this.pagesMatrix.getNearestPageIndex(x, y);\r\n        var pageX = pageIndex.pageX, pageY = pageIndex.pageY;\r\n        var newX = this.pagesMatrix.getPageStats(pageX, 0).x;\r\n        var newY = this.pagesMatrix.getPageStats(0, pageY).y;\r\n        return {\r\n            x: newX,\r\n            y: newY,\r\n            pageX: pageX,\r\n            pageY: pageY,\r\n        };\r\n    };\r\n    SlidePages.prototype.getPageByDirection = function (page, directionX, directionY) {\r\n        var pageX = page.pageX, pageY = page.pageY;\r\n        if (pageX === this.currentPage.pageX) {\r\n            pageX = between(pageX + directionX, 0, this.pagesMatrix.pageLengthOfX - 1);\r\n        }\r\n        if (pageY === this.currentPage.pageY) {\r\n            pageY = between(pageY + directionY, 0, this.pagesMatrix.pageLengthOfY - 1);\r\n        }\r\n        var x = this.pagesMatrix.getPageStats(pageX, 0).x;\r\n        var y = this.pagesMatrix.getPageStats(0, pageY).y;\r\n        return {\r\n            x: x,\r\n            y: y,\r\n            pageX: pageX,\r\n            pageY: pageY,\r\n        };\r\n    };\r\n    SlidePages.prototype.resetLoopPage = function () {\r\n        if (this.loopX) {\r\n            if (this.currentPage.pageX === 0) {\r\n                return {\r\n                    pageX: this.pagesMatrix.pageLengthOfX - 2,\r\n                    pageY: this.currentPage.pageY,\r\n                };\r\n            }\r\n            if (this.currentPage.pageX === this.pagesMatrix.pageLengthOfX - 1) {\r\n                return {\r\n                    pageX: 1,\r\n                    pageY: this.currentPage.pageY,\r\n                };\r\n            }\r\n        }\r\n        if (this.loopY) {\r\n            if (this.currentPage.pageY === 0) {\r\n                return {\r\n                    pageX: this.currentPage.pageX,\r\n                    pageY: this.pagesMatrix.pageLengthOfY - 2,\r\n                };\r\n            }\r\n            if (this.currentPage.pageY === this.pagesMatrix.pageLengthOfY - 1) {\r\n                return {\r\n                    pageX: this.currentPage.pageX,\r\n                    pageY: 1,\r\n                };\r\n            }\r\n        }\r\n    };\r\n    SlidePages.prototype.getPageIndexByDirection = function (direction) {\r\n        var x = this.currentPage.pageX;\r\n        var y = this.currentPage.pageY;\r\n        if (this.slideX) {\r\n            x = direction === \"negative\" /* Negative */ ? x - 1 : x + 1;\r\n        }\r\n        if (this.slideY) {\r\n            y = direction === \"negative\" /* Negative */ ? y - 1 : y + 1;\r\n        }\r\n        return {\r\n            pageX: x,\r\n            pageY: y,\r\n        };\r\n    };\r\n    SlidePages.prototype.checkSlideLoop = function () {\r\n        this.wannaLoop = this.slideOptions.loop;\r\n        if (this.pagesMatrix.pageLengthOfX > 1) {\r\n            this.slideX = true;\r\n        }\r\n        else {\r\n            this.slideX = false;\r\n        }\r\n        if (this.pagesMatrix.pages[0] && this.pagesMatrix.pageLengthOfY > 1) {\r\n            this.slideY = true;\r\n        }\r\n        else {\r\n            this.slideY = false;\r\n        }\r\n        this.loopX = this.wannaLoop && this.slideX;\r\n        this.loopY = this.wannaLoop && this.slideY;\r\n        if (this.slideX && this.slideY) {\r\n            warn('slide does not support two direction at the same time.');\r\n        }\r\n    };\r\n    return SlidePages;\r\n}());\n\nvar sourcePrefix$4 = 'plugins.slide';\r\nvar propertiesMap$4 = [\r\n    {\r\n        key: 'next',\r\n        name: 'next',\r\n    },\r\n    {\r\n        key: 'prev',\r\n        name: 'prev',\r\n    },\r\n    {\r\n        key: 'goToPage',\r\n        name: 'goToPage',\r\n    },\r\n    {\r\n        key: 'getCurrentPage',\r\n        name: 'getCurrentPage',\r\n    },\r\n    {\r\n        key: 'startPlay',\r\n        name: 'startPlay',\r\n    },\r\n    {\r\n        key: 'pausePlay',\r\n        name: 'pausePlay',\r\n    },\r\n];\r\nvar propertiesConfig$4 = propertiesMap$4.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$4 + \".\" + item.name,\r\n    };\r\n});\n\nvar samePage = function (p1, p2) {\r\n    return p1.pageX === p2.pageX && p1.pageY === p2.pageY;\r\n};\r\nvar Slide = /** @class */ (function () {\r\n    function Slide(scroll) {\r\n        this.scroll = scroll;\r\n        this.cachedClonedPageDOM = [];\r\n        this.resetLooping = false;\r\n        this.autoplayTimer = 0;\r\n        if (!this.satisfyInitialization()) {\r\n            return;\r\n        }\r\n        this.init();\r\n    }\r\n    Slide.prototype.satisfyInitialization = function () {\r\n        if (this.scroll.scroller.content.children.length <= 0) {\r\n            warn(\"slide need at least one slide page to be initialised.\" +\r\n                \"please check your DOM layout.\");\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    Slide.prototype.init = function () {\r\n        this.willChangeToPage = extend({}, BASE_PAGE);\r\n        this.handleBScroll();\r\n        this.handleOptions();\r\n        this.handleHooks();\r\n        this.createPages();\r\n    };\r\n    Slide.prototype.createPages = function () {\r\n        this.pages = new SlidePages(this.scroll, this.options);\r\n    };\r\n    Slide.prototype.handleBScroll = function () {\r\n        this.scroll.registerType(['slideWillChange', 'slidePageChanged']);\r\n        this.scroll.proxy(propertiesConfig$4);\r\n    };\r\n    Slide.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.slide === true\r\n            ? {}\r\n            : this.scroll.options.slide);\r\n        var defaultOptions = {\r\n            loop: true,\r\n            threshold: 0.1,\r\n            speed: 400,\r\n            easing: ease.bounce,\r\n            listenFlick: true,\r\n            autoplay: true,\r\n            interval: 3000,\r\n            startPageXIndex: 0,\r\n            startPageYIndex: 0,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n    };\r\n    Slide.prototype.handleLoop = function (prevSlideContent) {\r\n        var loop = this.options.loop;\r\n        var slideContent = this.scroll.scroller.content;\r\n        var currentSlidePagesLength = slideContent.children.length;\r\n        // only should respect loop scene\r\n        if (loop) {\r\n            if (slideContent !== prevSlideContent) {\r\n                this.resetLoopChangedStatus();\r\n                this.removeClonedSlidePage(prevSlideContent);\r\n                currentSlidePagesLength > 1 &&\r\n                    this.cloneFirstAndLastSlidePage(slideContent);\r\n            }\r\n            else {\r\n                // many pages reduce to one page\r\n                if (currentSlidePagesLength === 3 && this.initialised) {\r\n                    this.removeClonedSlidePage(slideContent);\r\n                    this.moreToOnePageInLoop = true;\r\n                    this.oneToMorePagesInLoop = false;\r\n                }\r\n                else if (currentSlidePagesLength > 1) {\r\n                    // one page increases to many page\r\n                    if (this.initialised && this.cachedClonedPageDOM.length === 0) {\r\n                        this.oneToMorePagesInLoop = true;\r\n                        this.moreToOnePageInLoop = false;\r\n                    }\r\n                    else {\r\n                        this.removeClonedSlidePage(slideContent);\r\n                        this.resetLoopChangedStatus();\r\n                    }\r\n                    this.cloneFirstAndLastSlidePage(slideContent);\r\n                }\r\n                else {\r\n                    this.resetLoopChangedStatus();\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Slide.prototype.resetLoopChangedStatus = function () {\r\n        this.moreToOnePageInLoop = false;\r\n        this.oneToMorePagesInLoop = false;\r\n    };\r\n    Slide.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scrollHooks = this.scroll.hooks;\r\n        var scrollerHooks = this.scroll.scroller.hooks;\r\n        var listenFlick = this.options.listenFlick;\r\n        this.prevContent = this.scroll.scroller.content;\r\n        this.hooksFn = [];\r\n        // scroll\r\n        this.registerHooks(this.scroll, this.scroll.eventTypes.beforeScrollStart, this.pausePlay);\r\n        this.registerHooks(this.scroll, this.scroll.eventTypes.scrollEnd, this.modifyCurrentPage);\r\n        this.registerHooks(this.scroll, this.scroll.eventTypes.scrollEnd, this.startPlay);\r\n        // for mousewheel event\r\n        if (this.scroll.eventTypes.mousewheelMove) {\r\n            this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelMove, function () {\r\n                // prevent default action of mousewheelMove\r\n                return true;\r\n            });\r\n            this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelEnd, function (delta) {\r\n                if (delta.directionX === 1 /* Positive */ ||\r\n                    delta.directionY === 1 /* Positive */) {\r\n                    _this.next();\r\n                }\r\n                if (delta.directionX === -1 /* Negative */ ||\r\n                    delta.directionY === -1 /* Negative */) {\r\n                    _this.prev();\r\n                }\r\n            });\r\n        }\r\n        // scrollHooks\r\n        this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refreshHandler);\r\n        this.registerHooks(scrollHooks, scrollHooks.eventTypes.destroy, this.destroy);\r\n        // scroller\r\n        this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.beforeRefresh, function () {\r\n            _this.handleLoop(_this.prevContent);\r\n            _this.setSlideInlineStyle();\r\n        });\r\n        this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.momentum, this.modifyScrollMetaHandler);\r\n        this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.scroll, this.scrollHandler);\r\n        // a click operation will clearTimer, so restart a new one\r\n        this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.checkClick, this.startPlay);\r\n        if (listenFlick) {\r\n            this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.flick, this.flickHandler);\r\n        }\r\n    };\r\n    Slide.prototype.startPlay = function () {\r\n        var _this = this;\r\n        var _a = this.options, interval = _a.interval, autoplay = _a.autoplay;\r\n        if (autoplay) {\r\n            clearTimeout(this.autoplayTimer);\r\n            this.autoplayTimer = window.setTimeout(function () {\r\n                _this.next();\r\n            }, interval);\r\n        }\r\n    };\r\n    Slide.prototype.pausePlay = function () {\r\n        if (this.options.autoplay) {\r\n            clearTimeout(this.autoplayTimer);\r\n        }\r\n    };\r\n    Slide.prototype.setSlideInlineStyle = function () {\r\n        var styleConfigurations = [\r\n            {\r\n                direction: 'scrollX',\r\n                sizeType: 'offsetWidth',\r\n                styleType: 'width',\r\n            },\r\n            {\r\n                direction: 'scrollY',\r\n                sizeType: 'offsetHeight',\r\n                styleType: 'height',\r\n            },\r\n        ];\r\n        var _a = this.scroll.scroller, slideContent = _a.content, slideWrapper = _a.wrapper;\r\n        var scrollOptions = this.scroll.options;\r\n        styleConfigurations.forEach(function (_a) {\r\n            var direction = _a.direction, sizeType = _a.sizeType, styleType = _a.styleType;\r\n            // wanna scroll in this direction\r\n            if (scrollOptions[direction]) {\r\n                var size = slideWrapper[sizeType];\r\n                var children = slideContent.children;\r\n                var length_1 = children.length;\r\n                for (var i = 0; i < length_1; i++) {\r\n                    var slidePageDOM = children[i];\r\n                    slidePageDOM.style[styleType] = size + 'px';\r\n                }\r\n                slideContent.style[styleType] = size * length_1 + 'px';\r\n            }\r\n        });\r\n    };\r\n    Slide.prototype.next = function (time, easing) {\r\n        var _a = this.pages.nextPageIndex(), pageX = _a.pageX, pageY = _a.pageY;\r\n        this.goTo(pageX, pageY, time, easing);\r\n    };\r\n    Slide.prototype.prev = function (time, easing) {\r\n        var _a = this.pages.prevPageIndex(), pageX = _a.pageX, pageY = _a.pageY;\r\n        this.goTo(pageX, pageY, time, easing);\r\n    };\r\n    Slide.prototype.goToPage = function (pageX, pageY, time, easing) {\r\n        var pageIndex = this.pages.getValidPageIndex(pageX, pageY);\r\n        this.goTo(pageIndex.pageX, pageIndex.pageY, time, easing);\r\n    };\r\n    Slide.prototype.getCurrentPage = function () {\r\n        return this.exposedPage || this.pages.getInitialPage(false, true);\r\n    };\r\n    Slide.prototype.setCurrentPage = function (page) {\r\n        this.pages.setCurrentPage(page);\r\n        this.exposedPage = this.pages.getExposedPage(page);\r\n    };\r\n    Slide.prototype.nearestPage = function (x, y) {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        var maxScrollPosX = scrollBehaviorX.maxScrollPos, minScrollPosX = scrollBehaviorX.minScrollPos;\r\n        var maxScrollPosY = scrollBehaviorY.maxScrollPos, minScrollPosY = scrollBehaviorY.minScrollPos;\r\n        return this.pages.getNearestPage(between(x, maxScrollPosX, minScrollPosX), between(y, maxScrollPosY, minScrollPosY));\r\n    };\r\n    Slide.prototype.satisfyThreshold = function (x, y) {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        var satisfied = true;\r\n        if (Math.abs(x - scrollBehaviorX.absStartPos) <= this.thresholdX &&\r\n            Math.abs(y - scrollBehaviorY.absStartPos) <= this.thresholdY) {\r\n            satisfied = false;\r\n        }\r\n        return satisfied;\r\n    };\r\n    Slide.prototype.refreshHandler = function (content) {\r\n        var _this = this;\r\n        if (!this.satisfyInitialization()) {\r\n            return;\r\n        }\r\n        this.pages.refresh();\r\n        this.computeThreshold();\r\n        var contentChanged = (this.contentChanged = this.prevContent !== content);\r\n        if (contentChanged) {\r\n            this.prevContent = content;\r\n        }\r\n        var initPage = this.pages.getInitialPage(this.oneToMorePagesInLoop || this.moreToOnePageInLoop, contentChanged || !this.initialised);\r\n        if (this.initialised) {\r\n            this.goTo(initPage.pageX, initPage.pageY, 0);\r\n        }\r\n        else {\r\n            this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.beforeInitialScrollTo, function (position) {\r\n                _this.initialised = true;\r\n                position.x = initPage.x;\r\n                position.y = initPage.y;\r\n            });\r\n        }\r\n        this.startPlay();\r\n    };\r\n    Slide.prototype.computeThreshold = function () {\r\n        var threshold = this.options.threshold;\r\n        // Integer\r\n        if (threshold % 1 === 0) {\r\n            this.thresholdX = threshold;\r\n            this.thresholdY = threshold;\r\n        }\r\n        else {\r\n            // decimal\r\n            var _a = this.pages.getPageStats(), width = _a.width, height = _a.height;\r\n            this.thresholdX = Math.round(width * threshold);\r\n            this.thresholdY = Math.round(height * threshold);\r\n        }\r\n    };\r\n    Slide.prototype.cloneFirstAndLastSlidePage = function (slideContent) {\r\n        var children = slideContent.children;\r\n        var preprendDOM = children[children.length - 1].cloneNode(true);\r\n        var appendDOM = children[0].cloneNode(true);\r\n        prepend(preprendDOM, slideContent);\r\n        slideContent.appendChild(appendDOM);\r\n        this.cachedClonedPageDOM = [preprendDOM, appendDOM];\r\n    };\r\n    Slide.prototype.removeClonedSlidePage = function (slideContent) {\r\n        // maybe slideContent has removed from DOM Tree\r\n        var slidePages = (slideContent && slideContent.children) || [];\r\n        if (slidePages.length) {\r\n            this.cachedClonedPageDOM.forEach(function (el) {\r\n                removeChild(slideContent, el);\r\n            });\r\n        }\r\n        this.cachedClonedPageDOM = [];\r\n    };\r\n    Slide.prototype.modifyCurrentPage = function (point) {\r\n        var _a = this.getCurrentPage(), prevExposedPageX = _a.pageX, prevExposedPageY = _a.pageY;\r\n        var newPage = this.nearestPage(point.x, point.y);\r\n        this.setCurrentPage(newPage);\r\n        /* istanbul ignore if */\r\n        if (this.contentChanged) {\r\n            this.contentChanged = false;\r\n            return true;\r\n        }\r\n        var _b = this.getCurrentPage(), currentExposedPageX = _b.pageX, currentExposedPageY = _b.pageY;\r\n        this.pageWillChangeTo(newPage);\r\n        // loop is true, and one page becomes many pages when call bs.refresh\r\n        if (this.oneToMorePagesInLoop) {\r\n            this.oneToMorePagesInLoop = false;\r\n            return true;\r\n        }\r\n        // loop is true, and many page becomes one page when call bs.refresh\r\n        // if prevPage > 0, dispatch slidePageChanged and scrollEnd events\r\n        /* istanbul ignore if */\r\n        if (this.moreToOnePageInLoop &&\r\n            prevExposedPageX === 0 &&\r\n            prevExposedPageY === 0) {\r\n            this.moreToOnePageInLoop = false;\r\n            return true;\r\n        }\r\n        if (prevExposedPageX !== currentExposedPageX ||\r\n            prevExposedPageY !== currentExposedPageY) {\r\n            // only trust pageX & pageY when loop is true\r\n            var page = this.pages.getExposedPageByPageIndex(currentExposedPageX, currentExposedPageY);\r\n            this.scroll.trigger(this.scroll.eventTypes.slidePageChanged, page);\r\n        }\r\n        // triggered by resetLoop\r\n        if (this.resetLooping) {\r\n            this.resetLooping = false;\r\n            return;\r\n        }\r\n        var changePage = this.pages.resetLoopPage();\r\n        if (changePage) {\r\n            this.resetLooping = true;\r\n            this.goTo(changePage.pageX, changePage.pageY, 0);\r\n            // stop user's scrollEnd\r\n            // since it is a seamless scroll\r\n            return true;\r\n        }\r\n    };\r\n    Slide.prototype.goTo = function (pageX, pageY, time, easing) {\r\n        var newPage = this.pages.getInternalPage(pageX, pageY);\r\n        var scrollEasing = easing || this.options.easing || ease.bounce;\r\n        var x = newPage.x, y = newPage.y;\r\n        var deltaX = x - this.scroll.scroller.scrollBehaviorX.currentPos;\r\n        var deltaY = y - this.scroll.scroller.scrollBehaviorY.currentPos;\r\n        /* istanbul ignore if */\r\n        if (!deltaX && !deltaY) {\r\n            this.scroll.scroller.togglePointerEvents(true);\r\n            return;\r\n        }\r\n        time = time === undefined ? this.getEaseTime(deltaX, deltaY) : time;\r\n        this.scroll.scroller.scrollTo(x, y, time, scrollEasing);\r\n    };\r\n    Slide.prototype.flickHandler = function () {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        var currentPosX = scrollBehaviorX.currentPos, startPosX = scrollBehaviorX.startPos, directionX = scrollBehaviorX.direction;\r\n        var currentPosY = scrollBehaviorY.currentPos, startPosY = scrollBehaviorY.startPos, directionY = scrollBehaviorY.direction;\r\n        var _b = this.pages.currentPage, pageX = _b.pageX, pageY = _b.pageY;\r\n        var time = this.getEaseTime(currentPosX - startPosX, currentPosY - startPosY);\r\n        this.goTo(pageX + directionX, pageY + directionY, time);\r\n    };\r\n    Slide.prototype.getEaseTime = function (deltaX, deltaY) {\r\n        return (this.options.speed ||\r\n            Math.max(Math.max(Math.min(Math.abs(deltaX), 1000), Math.min(Math.abs(deltaY), 1000)), 300));\r\n    };\r\n    Slide.prototype.modifyScrollMetaHandler = function (scrollMeta) {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY, animater = _a.animater;\r\n        var newX = scrollMeta.newX;\r\n        var newY = scrollMeta.newY;\r\n        var newPage = this.satisfyThreshold(newX, newY) || animater.forceStopped\r\n            ? this.pages.getPageByDirection(this.nearestPage(newX, newY), scrollBehaviorX.direction, scrollBehaviorY.direction)\r\n            : this.pages.currentPage;\r\n        scrollMeta.time = this.getEaseTime(scrollMeta.newX - newPage.x, scrollMeta.newY - newPage.y);\r\n        scrollMeta.newX = newPage.x;\r\n        scrollMeta.newY = newPage.y;\r\n        scrollMeta.easing = this.options.easing || ease.bounce;\r\n    };\r\n    Slide.prototype.scrollHandler = function (_a) {\r\n        var x = _a.x, y = _a.y;\r\n        if (this.satisfyThreshold(x, y)) {\r\n            var newPage = this.nearestPage(x, y);\r\n            this.pageWillChangeTo(newPage);\r\n        }\r\n    };\r\n    Slide.prototype.pageWillChangeTo = function (newPage) {\r\n        var changeToPage = this.pages.getWillChangedPage(newPage);\r\n        if (!samePage(this.willChangeToPage, changeToPage)) {\r\n            this.willChangeToPage = changeToPage;\r\n            this.scroll.trigger(this.scroll.eventTypes.slideWillChange, this.willChangeToPage);\r\n        }\r\n    };\r\n    Slide.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Slide.prototype.destroy = function () {\r\n        var slideContent = this.scroll.scroller.content;\r\n        var _a = this.options, loop = _a.loop, autoplay = _a.autoplay;\r\n        if (loop) {\r\n            this.removeClonedSlidePage(slideContent);\r\n        }\r\n        if (autoplay) {\r\n            clearTimeout(this.autoplayTimer);\r\n        }\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            if (hooks.eventTypes[hooksName]) {\r\n                hooks.off(hooksName, handlerFn);\r\n            }\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    Slide.pluginName = 'slide';\r\n    return Slide;\r\n}());\n\nvar sourcePrefix$3 = 'plugins.wheel';\r\nvar propertiesMap$3 = [\r\n    {\r\n        key: 'wheelTo',\r\n        name: 'wheelTo',\r\n    },\r\n    {\r\n        key: 'getSelectedIndex',\r\n        name: 'getSelectedIndex',\r\n    },\r\n    {\r\n        key: 'restorePosition',\r\n        name: 'restorePosition',\r\n    },\r\n];\r\nvar propertiesConfig$3 = propertiesMap$3.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$3 + \".\" + item.name,\r\n    };\r\n});\n\nvar WHEEL_INDEX_CHANGED_EVENT_NAME = 'wheelIndexChanged';\r\nvar CONSTANTS = {\r\n    rate: 4\r\n};\r\nvar Wheel = /** @class */ (function () {\r\n    function Wheel(scroll) {\r\n        this.scroll = scroll;\r\n        this.init();\r\n    }\r\n    Wheel.prototype.init = function () {\r\n        this.handleBScroll();\r\n        this.handleOptions();\r\n        this.handleHooks();\r\n        // init boundary for Wheel\r\n        this.refreshBoundary();\r\n        this.setSelectedIndex(this.options.selectedIndex);\r\n    };\r\n    Wheel.prototype.handleBScroll = function () {\r\n        this.scroll.proxy(propertiesConfig$3);\r\n        this.scroll.registerType([WHEEL_INDEX_CHANGED_EVENT_NAME]);\r\n    };\r\n    Wheel.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.wheel === true\r\n            ? {}\r\n            : this.scroll.options.wheel);\r\n        var defaultOptions = {\r\n            wheelWrapperClass: 'wheel-scroll',\r\n            wheelItemClass: 'wheel-item',\r\n            rotate: 25,\r\n            adjustTime: 400,\r\n            selectedIndex: 0,\r\n            wheelDisabledItemClass: 'wheel-disabled-item'\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n    };\r\n    Wheel.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scroll = this.scroll;\r\n        var scroller = this.scroll.scroller;\r\n        var actionsHandler = scroller.actionsHandler, scrollBehaviorX = scroller.scrollBehaviorX, scrollBehaviorY = scroller.scrollBehaviorY, animater = scroller.animater;\r\n        var prevContent = scroller.content;\r\n        // BScroll\r\n        scroll.on(scroll.eventTypes.scrollEnd, function (position) {\r\n            var index = _this.findNearestValidWheel(position.y).index;\r\n            if (scroller.animater.forceStopped && !_this.isAdjustingPosition) {\r\n                _this.target = _this.items[index];\r\n                // since stopped from an animation.\r\n                // prevent user's scrollEnd callback triggered twice\r\n                return true;\r\n            }\r\n            else {\r\n                _this.setSelectedIndex(index);\r\n                if (_this.isAdjustingPosition) {\r\n                    _this.isAdjustingPosition = false;\r\n                }\r\n            }\r\n        });\r\n        // BScroll.hooks\r\n        this.scroll.hooks.on(this.scroll.hooks.eventTypes.refresh, function (content) {\r\n            if (content !== prevContent) {\r\n                prevContent = content;\r\n                _this.setSelectedIndex(_this.options.selectedIndex, true);\r\n            }\r\n            // rotate all wheel-items\r\n            // because position may not change\r\n            _this.rotateX(_this.scroll.y);\r\n            // check we are stop at a disable item or not\r\n            _this.wheelTo(_this.selectedIndex, 0);\r\n        });\r\n        this.scroll.hooks.on(this.scroll.hooks.eventTypes.beforeInitialScrollTo, function (position) {\r\n            // selectedIndex has higher priority than bs.options.startY\r\n            position.x = 0;\r\n            position.y = -(_this.selectedIndex * _this.itemHeight);\r\n        });\r\n        // Scroller\r\n        scroller.hooks.on(scroller.hooks.eventTypes.checkClick, function () {\r\n            var index = HTMLCollectionToArray(_this.items).indexOf(_this.target);\r\n            if (index === -1)\r\n                return true;\r\n            _this.wheelTo(index, _this.options.adjustTime, ease.swipe);\r\n            return true;\r\n        });\r\n        scroller.hooks.on(scroller.hooks.eventTypes.scrollTo, function (endPoint) {\r\n            endPoint.y = _this.findNearestValidWheel(endPoint.y).y;\r\n        });\r\n        // when content is scrolling\r\n        // click wheel-item DOM repeatedly and crazily will cause scrollEnd not triggered\r\n        // so reset forceStopped\r\n        scroller.hooks.on(scroller.hooks.eventTypes.minDistanceScroll, function () {\r\n            var animater = scroller.animater;\r\n            if (animater.forceStopped === true) {\r\n                animater.forceStopped = false;\r\n            }\r\n        });\r\n        scroller.hooks.on(scroller.hooks.eventTypes.scrollToElement, function (el, pos) {\r\n            if (!hasClass(el, _this.options.wheelItemClass)) {\r\n                return true;\r\n            }\r\n            else {\r\n                pos.top = _this.findNearestValidWheel(pos.top).y;\r\n            }\r\n        });\r\n        // ActionsHandler\r\n        actionsHandler.hooks.on(actionsHandler.hooks.eventTypes.beforeStart, function (e) {\r\n            _this.target = e.target;\r\n        });\r\n        // ScrollBehaviorX\r\n        // Wheel has no x direction now\r\n        scrollBehaviorX.hooks.on(scrollBehaviorX.hooks.eventTypes.computeBoundary, function (boundary) {\r\n            boundary.maxScrollPos = 0;\r\n            boundary.minScrollPos = 0;\r\n        });\r\n        // ScrollBehaviorY\r\n        scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\r\n            _this.items = _this.scroll.scroller.content.children;\r\n            _this.checkWheelAllDisabled();\r\n            _this.itemHeight =\r\n                _this.items.length > 0\r\n                    ? scrollBehaviorY.contentSize / _this.items.length\r\n                    : 0;\r\n            boundary.maxScrollPos = -_this.itemHeight * (_this.items.length - 1);\r\n            boundary.minScrollPos = 0;\r\n        });\r\n        scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.momentum, function (momentumInfo) {\r\n            momentumInfo.rate = CONSTANTS.rate;\r\n            momentumInfo.destination = _this.findNearestValidWheel(momentumInfo.destination).y;\r\n        });\r\n        scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.end, function (momentumInfo) {\r\n            var validWheel = _this.findNearestValidWheel(scrollBehaviorY.currentPos);\r\n            momentumInfo.destination = validWheel.y;\r\n            momentumInfo.duration = _this.options.adjustTime;\r\n        });\r\n        // Animater\r\n        animater.hooks.on(animater.hooks.eventTypes.time, function (time) {\r\n            _this.transitionDuration(time);\r\n        });\r\n        animater.hooks.on(animater.hooks.eventTypes.timeFunction, function (easing) {\r\n            _this.timeFunction(easing);\r\n        });\r\n        // bs.stop() to make wheel stop at a correct position when pending\r\n        animater.hooks.on(animater.hooks.eventTypes.callStop, function () {\r\n            var index = _this.findNearestValidWheel(_this.scroll.y).index;\r\n            _this.isAdjustingPosition = true;\r\n            _this.wheelTo(index, 0);\r\n        });\r\n        // Translater\r\n        animater.translater.hooks.on(animater.translater.hooks.eventTypes.translate, function (endPoint) {\r\n            _this.rotateX(endPoint.y);\r\n        });\r\n    };\r\n    Wheel.prototype.refreshBoundary = function () {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY, content = _a.content;\r\n        scrollBehaviorX.refresh(content);\r\n        scrollBehaviorY.refresh(content);\r\n    };\r\n    Wheel.prototype.setSelectedIndex = function (index, contentChanged) {\r\n        if (contentChanged === void 0) { contentChanged = false; }\r\n        var prevSelectedIndex = this.selectedIndex;\r\n        this.selectedIndex = index;\r\n        // if content DOM changed, should not trigger event\r\n        if (prevSelectedIndex !== index && !contentChanged) {\r\n            this.scroll.trigger(WHEEL_INDEX_CHANGED_EVENT_NAME, index);\r\n        }\r\n    };\r\n    Wheel.prototype.getSelectedIndex = function () {\r\n        return this.selectedIndex;\r\n    };\r\n    Wheel.prototype.wheelTo = function (index, time, ease) {\r\n        if (index === void 0) { index = 0; }\r\n        if (time === void 0) { time = 0; }\r\n        var y = -index * this.itemHeight;\r\n        this.scroll.scrollTo(0, y, time, ease);\r\n    };\r\n    Wheel.prototype.restorePosition = function () {\r\n        // bs is scrolling\r\n        var isPending = this.scroll.pending;\r\n        if (isPending) {\r\n            var selectedIndex = this.getSelectedIndex();\r\n            this.scroll.scroller.animater.clearTimer();\r\n            this.wheelTo(selectedIndex, 0);\r\n        }\r\n    };\r\n    Wheel.prototype.transitionDuration = function (time) {\r\n        for (var i = 0; i < this.items.length; i++) {\r\n            this.items[i].style[style.transitionDuration] =\r\n                time + 'ms';\r\n        }\r\n    };\r\n    Wheel.prototype.timeFunction = function (easing) {\r\n        for (var i = 0; i < this.items.length; i++) {\r\n            this.items[i].style[style.transitionTimingFunction] = easing;\r\n        }\r\n    };\r\n    Wheel.prototype.rotateX = function (y) {\r\n        var _a = this.options.rotate, rotate = _a === void 0 ? 25 : _a;\r\n        for (var i = 0; i < this.items.length; i++) {\r\n            var deg = rotate * (y / this.itemHeight + i);\r\n            // Too small value is invalid in some phones, issue 1026\r\n            var SafeDeg = deg.toFixed(3);\r\n            this.items[i].style[style.transform] = \"rotateX(\" + SafeDeg + \"deg)\";\r\n        }\r\n    };\r\n    Wheel.prototype.findNearestValidWheel = function (y) {\r\n        y = y > 0 ? 0 : y < this.scroll.maxScrollY ? this.scroll.maxScrollY : y;\r\n        var currentIndex = Math.abs(Math.round(-y / this.itemHeight));\r\n        var cacheIndex = currentIndex;\r\n        var items = this.items;\r\n        var wheelDisabledItemClassName = this.options\r\n            .wheelDisabledItemClass;\r\n        // implement web native select element\r\n        // first, check whether there is a enable item whose index is smaller than currentIndex\r\n        // then, check whether there is a enable item whose index is bigger than currentIndex\r\n        // otherwise, there are all disabled items, just keep currentIndex unchange\r\n        while (currentIndex >= 0) {\r\n            if (!hasClass(items[currentIndex], wheelDisabledItemClassName)) {\r\n                break;\r\n            }\r\n            currentIndex--;\r\n        }\r\n        if (currentIndex < 0) {\r\n            currentIndex = cacheIndex;\r\n            while (currentIndex <= items.length - 1) {\r\n                if (!hasClass(items[currentIndex], wheelDisabledItemClassName)) {\r\n                    break;\r\n                }\r\n                currentIndex++;\r\n            }\r\n        }\r\n        // keep it unchange when all the items are disabled\r\n        if (currentIndex === items.length) {\r\n            currentIndex = cacheIndex;\r\n        }\r\n        // when all the items are disabled, selectedIndex should always be -1\r\n        return {\r\n            index: this.wheelItemsAllDisabled ? -1 : currentIndex,\r\n            y: -currentIndex * this.itemHeight\r\n        };\r\n    };\r\n    Wheel.prototype.checkWheelAllDisabled = function () {\r\n        var wheelDisabledItemClassName = this.options.wheelDisabledItemClass;\r\n        var items = this.items;\r\n        this.wheelItemsAllDisabled = true;\r\n        for (var i = 0; i < items.length; i++) {\r\n            if (!hasClass(items[i], wheelDisabledItemClassName)) {\r\n                this.wheelItemsAllDisabled = false;\r\n                break;\r\n            }\r\n        }\r\n    };\r\n    Wheel.pluginName = 'wheel';\r\n    return Wheel;\r\n}());\n\nvar sourcePrefix$2 = 'plugins.zoom';\r\nvar propertiesMap$2 = [\r\n    {\r\n        key: 'zoomTo',\r\n        name: 'zoomTo'\r\n    }\r\n];\r\nvar propertiesConfig$2 = propertiesMap$2.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$2 + \".\" + item.name\r\n    };\r\n});\n\nvar TWO_FINGERS = 2;\r\nvar RAW_SCALE = 1;\r\nvar Zoom = /** @class */ (function () {\r\n    function Zoom(scroll) {\r\n        this.scroll = scroll;\r\n        this.scale = RAW_SCALE;\r\n        this.prevScale = 1;\r\n        this.init();\r\n    }\r\n    Zoom.prototype.init = function () {\r\n        this.handleBScroll();\r\n        this.handleOptions();\r\n        this.handleHooks();\r\n        this.tryInitialZoomTo(this.zoomOpt);\r\n    };\r\n    Zoom.prototype.zoomTo = function (scale, x, y, bounceTime) {\r\n        var _a = this.resolveOrigin(x, y), originX = _a.originX, originY = _a.originY;\r\n        var origin = {\r\n            x: originX,\r\n            y: originY,\r\n            baseScale: this.scale,\r\n        };\r\n        this._doZoomTo(scale, origin, bounceTime, true);\r\n    };\r\n    Zoom.prototype.handleBScroll = function () {\r\n        this.scroll.proxy(propertiesConfig$2);\r\n        this.scroll.registerType([\r\n            'beforeZoomStart',\r\n            'zoomStart',\r\n            'zooming',\r\n            'zoomEnd',\r\n        ]);\r\n    };\r\n    Zoom.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.zoom === true\r\n            ? {}\r\n            : this.scroll.options.zoom);\r\n        var defaultOptions = {\r\n            start: 1,\r\n            min: 1,\r\n            max: 4,\r\n            initialOrigin: [0, 0],\r\n            minimalZoomDistance: 5,\r\n            bounceTime: 800,\r\n        };\r\n        this.zoomOpt = extend(defaultOptions, userOptions);\r\n    };\r\n    Zoom.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scroll = this.scroll;\r\n        var scroller = this.scroll.scroller;\r\n        this.wrapper = this.scroll.scroller.wrapper;\r\n        this.setTransformOrigin(this.scroll.scroller.content);\r\n        var scrollBehaviorX = scroller.scrollBehaviorX;\r\n        var scrollBehaviorY = scroller.scrollBehaviorY;\r\n        this.hooksFn = [];\r\n        // BScroll\r\n        this.registerHooks(scroll.hooks, scroll.hooks.eventTypes.contentChanged, function (content) {\r\n            _this.setTransformOrigin(content);\r\n            _this.scale = RAW_SCALE;\r\n            _this.tryInitialZoomTo(_this.zoomOpt);\r\n        });\r\n        this.registerHooks(scroll.hooks, scroll.hooks.eventTypes.beforeInitialScrollTo, function () {\r\n            // if perform a zoom action, we should prevent initial scroll when initialised\r\n            if (_this.zoomOpt.start !== RAW_SCALE) {\r\n                return true;\r\n            }\r\n        });\r\n        // enlarge boundary\r\n        this.registerHooks(scrollBehaviorX.hooks, scrollBehaviorX.hooks.eventTypes.beforeComputeBoundary, function () {\r\n            // content may change, don't cache it's size\r\n            var contentSize = getRect(_this.scroll.scroller.content);\r\n            scrollBehaviorX.contentSize = Math.floor(contentSize.width * _this.scale);\r\n        });\r\n        this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.beforeComputeBoundary, function () {\r\n            // content may change, don't cache it's size\r\n            var contentSize = getRect(_this.scroll.scroller.content);\r\n            scrollBehaviorY.contentSize = Math.floor(contentSize.height * _this.scale);\r\n        });\r\n        // touch event\r\n        this.registerHooks(scroller.actions.hooks, scroller.actions.hooks.eventTypes.start, function (e) {\r\n            var numberOfFingers = (e.touches && e.touches.length) || 0;\r\n            _this.fingersOperation(numberOfFingers);\r\n            if (numberOfFingers === TWO_FINGERS) {\r\n                _this.zoomStart(e);\r\n            }\r\n        });\r\n        this.registerHooks(scroller.actions.hooks, scroller.actions.hooks.eventTypes.beforeMove, function (e) {\r\n            var numberOfFingers = (e.touches && e.touches.length) || 0;\r\n            _this.fingersOperation(numberOfFingers);\r\n            if (numberOfFingers === TWO_FINGERS) {\r\n                _this.zoom(e);\r\n                return true;\r\n            }\r\n        });\r\n        this.registerHooks(scroller.actions.hooks, scroller.actions.hooks.eventTypes.beforeEnd, function (e) {\r\n            var numberOfFingers = _this.fingersOperation();\r\n            if (numberOfFingers === TWO_FINGERS) {\r\n                _this.zoomEnd();\r\n                return true;\r\n            }\r\n        });\r\n        this.registerHooks(scroller.translater.hooks, scroller.translater.hooks.eventTypes.beforeTranslate, function (transformStyle, point) {\r\n            var scale = point.scale ? point.scale : _this.prevScale;\r\n            _this.prevScale = scale;\r\n            transformStyle.push(\"scale(\" + scale + \")\");\r\n        });\r\n        this.registerHooks(scroller.hooks, scroller.hooks.eventTypes.scrollEnd, function () {\r\n            if (_this.fingersOperation() === TWO_FINGERS) {\r\n                _this.scroll.trigger(_this.scroll.eventTypes.zoomEnd, {\r\n                    scale: _this.scale,\r\n                });\r\n            }\r\n        });\r\n        this.registerHooks(this.scroll.hooks, 'destroy', this.destroy);\r\n    };\r\n    Zoom.prototype.setTransformOrigin = function (content) {\r\n        content.style[style.transformOrigin] = '0 0';\r\n    };\r\n    Zoom.prototype.tryInitialZoomTo = function (options) {\r\n        var start = options.start, initialOrigin = options.initialOrigin;\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        if (start !== RAW_SCALE) {\r\n            // Movable plugin may wanna modify minScrollPos or maxScrollPos\r\n            // so we force Movable to caculate them\r\n            this.resetBoundaries([scrollBehaviorX, scrollBehaviorY]);\r\n            this.zoomTo(start, initialOrigin[0], initialOrigin[1], 0);\r\n        }\r\n    };\r\n    // getter or setter operation\r\n    Zoom.prototype.fingersOperation = function (amounts) {\r\n        if (typeof amounts === 'number') {\r\n            this.numberOfFingers = amounts;\r\n        }\r\n        else {\r\n            return this.numberOfFingers;\r\n        }\r\n    };\r\n    Zoom.prototype._doZoomTo = function (scale, origin, time, useCurrentPos) {\r\n        var _this = this;\r\n        if (time === void 0) { time = this.zoomOpt.bounceTime; }\r\n        if (useCurrentPos === void 0) { useCurrentPos = false; }\r\n        var _a = this.zoomOpt, min = _a.min, max = _a.max;\r\n        var fromScale = this.scale;\r\n        var toScale = between(scale, min, max);\r\n        (function () {\r\n            if (time === 0) {\r\n                _this.scroll.trigger(_this.scroll.eventTypes.zooming, {\r\n                    scale: toScale,\r\n                });\r\n                return;\r\n            }\r\n            if (time > 0) {\r\n                var timer_1;\r\n                var startTime_1 = getNow();\r\n                var endTime_1 = startTime_1 + time;\r\n                var scheduler_1 = function () {\r\n                    var now = getNow();\r\n                    if (now >= endTime_1) {\r\n                        _this.scroll.trigger(_this.scroll.eventTypes.zooming, {\r\n                            scale: toScale,\r\n                        });\r\n                        cancelAnimationFrame(timer_1);\r\n                        return;\r\n                    }\r\n                    var ratio = ease.bounce.fn((now - startTime_1) / time);\r\n                    var currentScale = ratio * (toScale - fromScale) + fromScale;\r\n                    _this.scroll.trigger(_this.scroll.eventTypes.zooming, {\r\n                        scale: currentScale,\r\n                    });\r\n                    timer_1 = requestAnimationFrame(scheduler_1);\r\n                };\r\n                // start scheduler job\r\n                scheduler_1();\r\n            }\r\n        })();\r\n        // suppose you are zooming by two fingers\r\n        this.fingersOperation(2);\r\n        this._zoomTo(toScale, fromScale, origin, time, useCurrentPos);\r\n    };\r\n    Zoom.prototype._zoomTo = function (toScale, fromScale, origin, time, useCurrentPos) {\r\n        if (useCurrentPos === void 0) { useCurrentPos = false; }\r\n        var ratio = toScale / origin.baseScale;\r\n        this.setScale(toScale);\r\n        var scroller = this.scroll.scroller;\r\n        var scrollBehaviorX = scroller.scrollBehaviorX, scrollBehaviorY = scroller.scrollBehaviorY;\r\n        this.resetBoundaries([scrollBehaviorX, scrollBehaviorY]);\r\n        // position is restrained in boundary\r\n        var newX = this.getNewPos(origin.x, ratio, scrollBehaviorX, true, useCurrentPos);\r\n        var newY = this.getNewPos(origin.y, ratio, scrollBehaviorY, true, useCurrentPos);\r\n        if (scrollBehaviorX.currentPos !== Math.round(newX) ||\r\n            scrollBehaviorY.currentPos !== Math.round(newY) ||\r\n            toScale !== fromScale) {\r\n            scroller.scrollTo(newX, newY, time, ease.bounce, {\r\n                start: {\r\n                    scale: fromScale,\r\n                },\r\n                end: {\r\n                    scale: toScale,\r\n                },\r\n            });\r\n        }\r\n    };\r\n    Zoom.prototype.resolveOrigin = function (x, y) {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        var resolveFormula = {\r\n            left: function () {\r\n                return 0;\r\n            },\r\n            top: function () {\r\n                return 0;\r\n            },\r\n            right: function () {\r\n                return scrollBehaviorX.contentSize;\r\n            },\r\n            bottom: function () {\r\n                return scrollBehaviorY.contentSize;\r\n            },\r\n            center: function (index) {\r\n                var baseSize = index === 0\r\n                    ? scrollBehaviorX.contentSize\r\n                    : scrollBehaviorY.contentSize;\r\n                return baseSize / 2;\r\n            },\r\n        };\r\n        return {\r\n            originX: typeof x === 'number' ? x : resolveFormula[x](0),\r\n            originY: typeof y === 'number' ? y : resolveFormula[y](1),\r\n        };\r\n    };\r\n    Zoom.prototype.zoomStart = function (e) {\r\n        var firstFinger = e.touches[0];\r\n        var secondFinger = e.touches[1];\r\n        this.startDistance = this.getFingerDistance(e);\r\n        this.startScale = this.scale;\r\n        var _a = offsetToBody(this.wrapper), left = _a.left, top = _a.top;\r\n        this.origin = {\r\n            x: Math.abs(firstFinger.pageX + secondFinger.pageX) / 2 +\r\n                left -\r\n                this.scroll.x,\r\n            y: Math.abs(firstFinger.pageY + secondFinger.pageY) / 2 +\r\n                top -\r\n                this.scroll.y,\r\n            baseScale: this.startScale,\r\n        };\r\n        this.scroll.trigger(this.scroll.eventTypes.beforeZoomStart);\r\n    };\r\n    Zoom.prototype.zoom = function (e) {\r\n        var currentDistance = this.getFingerDistance(e);\r\n        // at least minimalZoomDistance pixels for the zoom to initiate\r\n        if (!this.zoomed &&\r\n            Math.abs(currentDistance - this.startDistance) <\r\n                this.zoomOpt.minimalZoomDistance) {\r\n            return;\r\n        }\r\n        // when out of boundary , perform a damping algorithm\r\n        var endScale = this.dampingScale((currentDistance / this.startDistance) * this.startScale);\r\n        var ratio = endScale / this.startScale;\r\n        this.setScale(endScale);\r\n        if (!this.zoomed) {\r\n            this.zoomed = true;\r\n            this.scroll.trigger(this.scroll.eventTypes.zoomStart);\r\n        }\r\n        var scroller = this.scroll.scroller;\r\n        var scrollBehaviorX = scroller.scrollBehaviorX, scrollBehaviorY = scroller.scrollBehaviorY;\r\n        var x = this.getNewPos(this.origin.x, ratio, scrollBehaviorX, false, false);\r\n        var y = this.getNewPos(this.origin.y, ratio, scrollBehaviorY, false, false);\r\n        this.scroll.trigger(this.scroll.eventTypes.zooming, {\r\n            scale: this.scale,\r\n        });\r\n        scroller.translater.translate({ x: x, y: y, scale: endScale });\r\n    };\r\n    Zoom.prototype.zoomEnd = function () {\r\n        if (!this.zoomed)\r\n            return;\r\n        // if out of boundary, do rebound!\r\n        if (this.shouldRebound()) {\r\n            this._doZoomTo(this.scale, this.origin, this.zoomOpt.bounceTime);\r\n            return;\r\n        }\r\n        this.scroll.trigger(this.scroll.eventTypes.zoomEnd, { scale: this.scale });\r\n    };\r\n    Zoom.prototype.getFingerDistance = function (e) {\r\n        var firstFinger = e.touches[0];\r\n        var secondFinger = e.touches[1];\r\n        var deltaX = Math.abs(firstFinger.pageX - secondFinger.pageX);\r\n        var deltaY = Math.abs(firstFinger.pageY - secondFinger.pageY);\r\n        return getDistance(deltaX, deltaY);\r\n    };\r\n    Zoom.prototype.shouldRebound = function () {\r\n        var _a = this.zoomOpt, min = _a.min, max = _a.max;\r\n        var currentScale = this.scale;\r\n        // scale exceeded!\r\n        if (currentScale !== between(currentScale, min, max)) {\r\n            return true;\r\n        }\r\n        var _b = this.scroll.scroller, scrollBehaviorX = _b.scrollBehaviorX, scrollBehaviorY = _b.scrollBehaviorY;\r\n        // enlarge boundaries manually when zoom is end\r\n        this.resetBoundaries([scrollBehaviorX, scrollBehaviorY]);\r\n        var xInBoundary = scrollBehaviorX.checkInBoundary().inBoundary;\r\n        var yInBoundary = scrollBehaviorX.checkInBoundary().inBoundary;\r\n        return !(xInBoundary && yInBoundary);\r\n    };\r\n    Zoom.prototype.dampingScale = function (scale) {\r\n        var _a = this.zoomOpt, min = _a.min, max = _a.max;\r\n        if (scale < min) {\r\n            scale = 0.5 * min * Math.pow(2.0, scale / min);\r\n        }\r\n        else if (scale > max) {\r\n            scale = 2.0 * max * Math.pow(0.5, max / scale);\r\n        }\r\n        return scale;\r\n    };\r\n    Zoom.prototype.setScale = function (scale) {\r\n        this.scale = scale;\r\n    };\r\n    Zoom.prototype.resetBoundaries = function (scrollBehaviorPairs) {\r\n        scrollBehaviorPairs.forEach(function (behavior) { return behavior.computeBoundary(); });\r\n    };\r\n    Zoom.prototype.getNewPos = function (origin, lastScale, scrollBehavior, shouldInBoundary, useCurrentPos) {\r\n        if (useCurrentPos === void 0) { useCurrentPos = false; }\r\n        var newPos = origin -\r\n            origin * lastScale +\r\n            (useCurrentPos ? scrollBehavior.currentPos : scrollBehavior.startPos);\r\n        if (shouldInBoundary) {\r\n            newPos = between(newPos, scrollBehavior.maxScrollPos, scrollBehavior.minScrollPos);\r\n        }\r\n        // maxScrollPos or minScrollPos maybe a negative or positive digital\r\n        return newPos > 0 ? Math.floor(newPos) : Math.ceil(newPos);\r\n    };\r\n    Zoom.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Zoom.prototype.destroy = function () {\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    Zoom.pluginName = 'zoom';\r\n    return Zoom;\r\n}());\n\nvar BScrollFamily = /** @class */ (function () {\r\n    function BScrollFamily(scroll) {\r\n        this.ancestors = [];\r\n        this.descendants = [];\r\n        this.hooksManager = [];\r\n        this.analyzed = false;\r\n        this.selfScroll = scroll;\r\n    }\r\n    BScrollFamily.create = function (scroll) {\r\n        return new BScrollFamily(scroll);\r\n    };\r\n    BScrollFamily.prototype.hasAncestors = function (bscrollFamily) {\r\n        var index = findIndex(this.ancestors, function (_a) {\r\n            var item = _a[0];\r\n            return item === bscrollFamily;\r\n        });\r\n        return index > -1;\r\n    };\r\n    BScrollFamily.prototype.hasDescendants = function (bscrollFamily) {\r\n        var index = findIndex(this.descendants, function (_a) {\r\n            var item = _a[0];\r\n            return item === bscrollFamily;\r\n        });\r\n        return index > -1;\r\n    };\r\n    BScrollFamily.prototype.addAncestor = function (bscrollFamily, distance) {\r\n        var ancestors = this.ancestors;\r\n        ancestors.push([bscrollFamily, distance]);\r\n        // by ascend\r\n        ancestors.sort(function (a, b) {\r\n            return a[1] - b[1];\r\n        });\r\n    };\r\n    BScrollFamily.prototype.addDescendant = function (bscrollFamily, distance) {\r\n        var descendants = this.descendants;\r\n        descendants.push([bscrollFamily, distance]);\r\n        // by ascend\r\n        descendants.sort(function (a, b) {\r\n            return a[1] - b[1];\r\n        });\r\n    };\r\n    BScrollFamily.prototype.removeAncestor = function (bscrollFamily) {\r\n        var ancestors = this.ancestors;\r\n        if (ancestors.length) {\r\n            var index = findIndex(this.ancestors, function (_a) {\r\n                var item = _a[0];\r\n                return item === bscrollFamily;\r\n            });\r\n            if (index > -1) {\r\n                return ancestors.splice(index, 1);\r\n            }\r\n        }\r\n    };\r\n    BScrollFamily.prototype.removeDescendant = function (bscrollFamily) {\r\n        var descendants = this.descendants;\r\n        if (descendants.length) {\r\n            var index = findIndex(this.descendants, function (_a) {\r\n                var item = _a[0];\r\n                return item === bscrollFamily;\r\n            });\r\n            if (index > -1) {\r\n                return descendants.splice(index, 1);\r\n            }\r\n        }\r\n    };\r\n    BScrollFamily.prototype.registerHooks = function (hook, eventType, handler) {\r\n        hook.on(eventType, handler);\r\n        this.hooksManager.push([hook, eventType, handler]);\r\n    };\r\n    BScrollFamily.prototype.setAnalyzed = function (flag) {\r\n        if (flag === void 0) { flag = false; }\r\n        this.analyzed = flag;\r\n    };\r\n    BScrollFamily.prototype.purge = function () {\r\n        var _this = this;\r\n        // remove self from graph\r\n        this.ancestors.forEach(function (_a) {\r\n            var bscrollFamily = _a[0];\r\n            bscrollFamily.removeDescendant(_this);\r\n        });\r\n        this.descendants.forEach(function (_a) {\r\n            var bscrollFamily = _a[0];\r\n            bscrollFamily.removeAncestor(_this);\r\n        });\r\n        // remove all hook handlers\r\n        this.hooksManager.forEach(function (_a) {\r\n            var hooks = _a[0], eventType = _a[1], handler = _a[2];\r\n            hooks.off(eventType, handler);\r\n        });\r\n        this.hooksManager = [];\r\n    };\r\n    return BScrollFamily;\r\n}());\n\nvar sourcePrefix$1 = 'plugins.nestedScroll';\r\nvar propertiesMap$1 = [\r\n    {\r\n        key: 'purgeNestedScroll',\r\n        name: 'purgeNestedScroll',\r\n    },\r\n];\r\nvar propertiesConfig$1 = propertiesMap$1.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$1 + \".\" + item.name,\r\n    };\r\n});\n\nvar DEFAUL_GROUP_ID = 'INTERNAL_NESTED_SCROLL';\r\nvar forceScrollStopHandler = function (scrolls) {\r\n    scrolls.forEach(function (scroll) {\r\n        if (scroll.pending) {\r\n            scroll.stop();\r\n            scroll.resetPosition();\r\n        }\r\n    });\r\n};\r\nvar enableScrollHander = function (scrolls) {\r\n    scrolls.forEach(function (scroll) {\r\n        scroll.enable();\r\n    });\r\n};\r\nvar disableScrollHander = function (scrolls, currentScroll) {\r\n    scrolls.forEach(function (scroll) {\r\n        if (scroll.hasHorizontalScroll === currentScroll.hasHorizontalScroll ||\r\n            scroll.hasVerticalScroll === currentScroll.hasVerticalScroll) {\r\n            scroll.disable();\r\n        }\r\n    });\r\n};\r\nvar syncTouchstartData = function (scrolls) {\r\n    scrolls.forEach(function (scroll) {\r\n        var _a = scroll.scroller, actions = _a.actions, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        // prevent click triggering many times\r\n        actions.fingerMoved = true;\r\n        actions.contentMoved = false;\r\n        actions.directionLockAction.reset();\r\n        scrollBehaviorX.start();\r\n        scrollBehaviorY.start();\r\n        scrollBehaviorX.resetStartPos();\r\n        scrollBehaviorY.resetStartPos();\r\n        actions.startTime = +new Date();\r\n    });\r\n};\r\nvar isOutOfBoundary = function (scroll) {\r\n    var hasHorizontalScroll = scroll.hasHorizontalScroll, hasVerticalScroll = scroll.hasVerticalScroll, x = scroll.x, y = scroll.y, minScrollX = scroll.minScrollX, maxScrollX = scroll.maxScrollX, minScrollY = scroll.minScrollY, maxScrollY = scroll.maxScrollY, movingDirectionX = scroll.movingDirectionX, movingDirectionY = scroll.movingDirectionY;\r\n    var ret = false;\r\n    var outOfLeftBoundary = x >= minScrollX && movingDirectionX === -1 /* Negative */;\r\n    var outOfRightBoundary = x <= maxScrollX && movingDirectionX === 1 /* Positive */;\r\n    var outOfTopBoundary = y >= minScrollY && movingDirectionY === -1 /* Negative */;\r\n    var outOfBottomBoundary = y <= maxScrollY && movingDirectionY === 1 /* Positive */;\r\n    if (hasVerticalScroll) {\r\n        ret = outOfTopBoundary || outOfBottomBoundary;\r\n    }\r\n    else if (hasHorizontalScroll) {\r\n        ret = outOfLeftBoundary || outOfRightBoundary;\r\n    }\r\n    return ret;\r\n};\r\nvar isResettingPosition = function (scroll) {\r\n    var hasHorizontalScroll = scroll.hasHorizontalScroll, hasVerticalScroll = scroll.hasVerticalScroll, x = scroll.x, y = scroll.y, minScrollX = scroll.minScrollX, maxScrollX = scroll.maxScrollX, minScrollY = scroll.minScrollY, maxScrollY = scroll.maxScrollY;\r\n    var ret = false;\r\n    var outOfLeftBoundary = x > minScrollX;\r\n    var outOfRightBoundary = x < maxScrollX;\r\n    var outOfTopBoundary = y > minScrollY;\r\n    var outOfBottomBoundary = y < maxScrollY;\r\n    if (hasVerticalScroll) {\r\n        ret = outOfTopBoundary || outOfBottomBoundary;\r\n    }\r\n    else if (hasHorizontalScroll) {\r\n        ret = outOfLeftBoundary || outOfRightBoundary;\r\n    }\r\n    return ret;\r\n};\r\nvar resetPositionHandler = function (scroll) {\r\n    scroll.scroller.reflow();\r\n    scroll.resetPosition(0 /* Immediately */);\r\n};\r\nvar calculateDistance = function (childNode, parentNode) {\r\n    var distance = 0;\r\n    var parent = childNode.parentNode;\r\n    while (parent && parent !== parentNode) {\r\n        distance++;\r\n        parent = parent.parentNode;\r\n    }\r\n    return distance;\r\n};\r\nvar NestedScroll = /** @class */ (function () {\r\n    function NestedScroll(scroll) {\r\n        var groupId = this.handleOptions(scroll);\r\n        var instance = NestedScroll.instancesMap[groupId];\r\n        if (!instance) {\r\n            instance = NestedScroll.instancesMap[groupId] = this;\r\n            instance.store = [];\r\n            instance.hooksFn = [];\r\n        }\r\n        instance.init(scroll);\r\n        return instance;\r\n    }\r\n    NestedScroll.getAllNestedScrolls = function () {\r\n        var instancesMap = NestedScroll.instancesMap;\r\n        return Object.keys(instancesMap).map(function (key) { return instancesMap[key]; });\r\n    };\r\n    NestedScroll.purgeAllNestedScrolls = function () {\r\n        var nestedScrolls = NestedScroll.getAllNestedScrolls();\r\n        nestedScrolls.forEach(function (ns) { return ns.purgeNestedScroll(); });\r\n    };\r\n    NestedScroll.prototype.handleOptions = function (scroll) {\r\n        var userOptions = (scroll.options.nestedScroll === true\r\n            ? {}\r\n            : scroll.options.nestedScroll);\r\n        var defaultOptions = {\r\n            groupId: DEFAUL_GROUP_ID,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n        var groupIdType = typeof this.options.groupId;\r\n        if (groupIdType !== 'string' && groupIdType !== 'number') {\r\n            warn('groupId must be string or number for NestedScroll plugin');\r\n        }\r\n        return this.options.groupId;\r\n    };\r\n    NestedScroll.prototype.init = function (scroll) {\r\n        scroll.proxy(propertiesConfig$1);\r\n        this.addBScroll(scroll);\r\n        this.buildBScrollGraph();\r\n        this.analyzeBScrollGraph();\r\n        this.ensureEventInvokeSequence();\r\n        this.handleHooks(scroll);\r\n    };\r\n    NestedScroll.prototype.handleHooks = function (scroll) {\r\n        var _this = this;\r\n        this.registerHooks(scroll.hooks, scroll.hooks.eventTypes.destroy, function () {\r\n            _this.deleteScroll(scroll);\r\n        });\r\n    };\r\n    NestedScroll.prototype.deleteScroll = function (scroll) {\r\n        var wrapper = scroll.wrapper;\r\n        wrapper.isBScrollContainer = undefined;\r\n        var store = this.store;\r\n        var hooksFn = this.hooksFn;\r\n        var i = findIndex(store, function (bscrollFamily) {\r\n            return bscrollFamily.selfScroll === scroll;\r\n        });\r\n        if (i > -1) {\r\n            var bscrollFamily = store[i];\r\n            bscrollFamily.purge();\r\n            store.splice(i, 1);\r\n        }\r\n        var k = findIndex(hooksFn, function (_a) {\r\n            var hooks = _a[0];\r\n            return hooks === scroll.hooks;\r\n        });\r\n        if (k > -1) {\r\n            var _a = hooksFn[k], hooks = _a[0], eventType = _a[1], handler = _a[2];\r\n            hooks.off(eventType, handler);\r\n            hooksFn.splice(k, 1);\r\n        }\r\n    };\r\n    NestedScroll.prototype.addBScroll = function (scroll) {\r\n        this.store.push(BScrollFamily.create(scroll));\r\n    };\r\n    NestedScroll.prototype.buildBScrollGraph = function () {\r\n        var store = this.store;\r\n        var bf1;\r\n        var bf2;\r\n        var wrapper1;\r\n        var wrapper2;\r\n        var len = this.store.length;\r\n        // build graph\r\n        for (var i = 0; i < len; i++) {\r\n            bf1 = store[i];\r\n            wrapper1 = bf1.selfScroll.wrapper;\r\n            for (var j = 0; j < len; j++) {\r\n                bf2 = store[j];\r\n                wrapper2 = bf2.selfScroll.wrapper;\r\n                // same bs\r\n                if (bf1 === bf2)\r\n                    continue;\r\n                if (!wrapper1.contains(wrapper2))\r\n                    continue;\r\n                // bs1 contains bs2\r\n                var distance = calculateDistance(wrapper2, wrapper1);\r\n                if (!bf1.hasDescendants(bf2)) {\r\n                    bf1.addDescendant(bf2, distance);\r\n                }\r\n                if (!bf2.hasAncestors(bf1)) {\r\n                    bf2.addAncestor(bf1, distance);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    NestedScroll.prototype.analyzeBScrollGraph = function () {\r\n        this.store.forEach(function (bscrollFamily) {\r\n            if (bscrollFamily.analyzed) {\r\n                return;\r\n            }\r\n            var ancestors = bscrollFamily.ancestors, descendants = bscrollFamily.descendants, currentScroll = bscrollFamily.selfScroll;\r\n            var beforeScrollStartHandler = function () {\r\n                // always get the latest scroll\r\n                var ancestorScrolls = ancestors.map(function (_a) {\r\n                    var bscrollFamily = _a[0];\r\n                    return bscrollFamily.selfScroll;\r\n                });\r\n                var descendantScrolls = descendants.map(function (_a) {\r\n                    var bscrollFamily = _a[0];\r\n                    return bscrollFamily.selfScroll;\r\n                });\r\n                forceScrollStopHandler(__spreadArrays(ancestorScrolls, descendantScrolls));\r\n                if (isResettingPosition(currentScroll)) {\r\n                    resetPositionHandler(currentScroll);\r\n                }\r\n                syncTouchstartData(ancestorScrolls);\r\n                disableScrollHander(ancestorScrolls, currentScroll);\r\n            };\r\n            var touchEndHandler = function () {\r\n                var ancestorScrolls = ancestors.map(function (_a) {\r\n                    var bscrollFamily = _a[0];\r\n                    return bscrollFamily.selfScroll;\r\n                });\r\n                var descendantScrolls = descendants.map(function (_a) {\r\n                    var bscrollFamily = _a[0];\r\n                    return bscrollFamily.selfScroll;\r\n                });\r\n                enableScrollHander(__spreadArrays(ancestorScrolls, descendantScrolls));\r\n            };\r\n            bscrollFamily.registerHooks(currentScroll, currentScroll.eventTypes.beforeScrollStart, beforeScrollStartHandler);\r\n            bscrollFamily.registerHooks(currentScroll, currentScroll.eventTypes.touchEnd, touchEndHandler);\r\n            var selfActionsHooks = currentScroll.scroller.actions.hooks;\r\n            bscrollFamily.registerHooks(selfActionsHooks, selfActionsHooks.eventTypes.detectMovingDirection, function () {\r\n                var ancestorScrolls = ancestors.map(function (_a) {\r\n                    var bscrollFamily = _a[0];\r\n                    return bscrollFamily.selfScroll;\r\n                });\r\n                var parentScroll = ancestorScrolls[0];\r\n                var otherAncestorScrolls = ancestorScrolls.slice(1);\r\n                var contentMoved = currentScroll.scroller.actions.contentMoved;\r\n                var isTopScroll = ancestorScrolls.length === 0;\r\n                if (contentMoved) {\r\n                    disableScrollHander(ancestorScrolls, currentScroll);\r\n                }\r\n                else if (!isTopScroll) {\r\n                    if (isOutOfBoundary(currentScroll)) {\r\n                        disableScrollHander([currentScroll], currentScroll);\r\n                        if (parentScroll) {\r\n                            enableScrollHander([parentScroll]);\r\n                        }\r\n                        disableScrollHander(otherAncestorScrolls, currentScroll);\r\n                        return true;\r\n                    }\r\n                }\r\n            });\r\n            bscrollFamily.setAnalyzed(true);\r\n        });\r\n    };\r\n    // make sure touchmove|touchend invoke from child to parent\r\n    NestedScroll.prototype.ensureEventInvokeSequence = function () {\r\n        var copied = this.store.slice();\r\n        var sequencedScroll = copied.sort(function (a, b) {\r\n            return a.descendants.length - b.descendants.length;\r\n        });\r\n        sequencedScroll.forEach(function (bscrollFamily) {\r\n            var scroll = bscrollFamily.selfScroll;\r\n            scroll.scroller.actionsHandler.rebindDOMEvents();\r\n        });\r\n    };\r\n    NestedScroll.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    NestedScroll.prototype.purgeNestedScroll = function () {\r\n        var groupId = this.options.groupId;\r\n        this.store.forEach(function (bscrollFamily) {\r\n            bscrollFamily.purge();\r\n        });\r\n        this.store = [];\r\n        this.hooksFn.forEach(function (_a) {\r\n            var hooks = _a[0], eventType = _a[1], handler = _a[2];\r\n            hooks.off(eventType, handler);\r\n        });\r\n        this.hooksFn = [];\r\n        delete NestedScroll.instancesMap[groupId];\r\n    };\r\n    NestedScroll.pluginName = 'nestedScroll';\r\n    NestedScroll.instancesMap = {};\r\n    return NestedScroll;\r\n}());\n\nvar PRE_NUM = 10;\r\nvar POST_NUM = 30;\r\nvar IndexCalculator = /** @class */ (function () {\r\n    function IndexCalculator(wrapperHeight, tombstoneHeight) {\r\n        this.wrapperHeight = wrapperHeight;\r\n        this.tombstoneHeight = tombstoneHeight;\r\n        this.lastDirection = 1 /* DOWN */;\r\n        this.lastPos = 0;\r\n    }\r\n    IndexCalculator.prototype.calculate = function (pos, list) {\r\n        var offset = pos - this.lastPos;\r\n        this.lastPos = pos;\r\n        var direction = this.getDirection(offset);\r\n        // important! start index is much more important than end index.\r\n        var start = this.calculateIndex(0, pos, list);\r\n        var end = this.calculateIndex(start, pos + this.wrapperHeight, list);\r\n        if (direction === 1 /* DOWN */) {\r\n            start -= PRE_NUM;\r\n            end += POST_NUM;\r\n        }\r\n        else {\r\n            start -= POST_NUM;\r\n            end += PRE_NUM;\r\n        }\r\n        if (start < 0) {\r\n            start = 0;\r\n        }\r\n        return {\r\n            start: start,\r\n            end: end,\r\n        };\r\n    };\r\n    IndexCalculator.prototype.getDirection = function (offset) {\r\n        var direction;\r\n        if (offset > 0) {\r\n            direction = 1 /* DOWN */;\r\n        }\r\n        else if (offset < 0) {\r\n            direction = 0 /* UP */;\r\n        }\r\n        else {\r\n            return this.lastDirection;\r\n        }\r\n        this.lastDirection = direction;\r\n        return direction;\r\n    };\r\n    IndexCalculator.prototype.calculateIndex = function (start, offset, list) {\r\n        if (offset <= 0) {\r\n            return start;\r\n        }\r\n        var i = start;\r\n        var startPos = list[i] && list[i].pos !== -1 ? list[i].pos : 0;\r\n        var lastPos = startPos;\r\n        var tombstone = 0;\r\n        while (i < list.length && list[i].pos < offset) {\r\n            lastPos = list[i].pos;\r\n            i++;\r\n        }\r\n        if (i === list.length) {\r\n            tombstone = Math.floor((offset - lastPos) / this.tombstoneHeight);\r\n        }\r\n        i += tombstone;\r\n        return i;\r\n    };\r\n    IndexCalculator.prototype.resetState = function () {\r\n        this.lastDirection = 1 /* DOWN */;\r\n        this.lastPos = 0;\r\n    };\r\n    return IndexCalculator;\r\n}());\n\nvar ListItem = /** @class */ (function () {\r\n    function ListItem() {\r\n        this.data = null;\r\n        this.dom = null;\r\n        this.tombstone = null;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.pos = 0;\r\n    }\r\n    return ListItem;\r\n}());\r\nvar DataManager = /** @class */ (function () {\r\n    function DataManager(list, fetchFn, onFetchFinish) {\r\n        this.fetchFn = fetchFn;\r\n        this.onFetchFinish = onFetchFinish;\r\n        this.loadedNum = 0;\r\n        this.fetching = false;\r\n        this.hasMore = true;\r\n        this.list = list || [];\r\n    }\r\n    DataManager.prototype.update = function (end) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var len;\r\n            return __generator(this, function (_a) {\r\n                if (!this.hasMore) {\r\n                    end = Math.min(end, this.list.length);\r\n                }\r\n                // add data placeholder\r\n                if (end > this.list.length) {\r\n                    len = end - this.list.length;\r\n                    this.addEmptyData(len);\r\n                }\r\n                // tslint:disable-next-line: no-floating-promises\r\n                return [2 /*return*/, this.checkToFetch(end)];\r\n            });\r\n        });\r\n    };\r\n    DataManager.prototype.add = function (data) {\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (!this.list[this.loadedNum]) {\r\n                this.list[this.loadedNum] = { data: data[i] };\r\n            }\r\n            else {\r\n                this.list[this.loadedNum] = __assign(__assign({}, this.list[this.loadedNum]), { data: data[i] });\r\n            }\r\n            this.loadedNum++;\r\n        }\r\n        return this.list;\r\n    };\r\n    DataManager.prototype.addEmptyData = function (len) {\r\n        for (var i = 0; i < len; i++) {\r\n            this.list.push(new ListItem());\r\n        }\r\n        return this.list;\r\n    };\r\n    DataManager.prototype.fetch = function (len) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var data;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (this.fetching) {\r\n                            return [2 /*return*/, []];\r\n                        }\r\n                        this.fetching = true;\r\n                        return [4 /*yield*/, this.fetchFn(len)];\r\n                    case 1:\r\n                        data = _a.sent();\r\n                        this.fetching = false;\r\n                        return [2 /*return*/, data];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DataManager.prototype.checkToFetch = function (end) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var min, newData, currentEnd;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this.hasMore) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        if (end <= this.loadedNum) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        min = end - this.loadedNum;\r\n                        return [4 /*yield*/, this.fetch(min)];\r\n                    case 1:\r\n                        newData = _a.sent();\r\n                        if (newData instanceof Array && newData.length) {\r\n                            this.add(newData);\r\n                            currentEnd = this.onFetchFinish(this.list, true);\r\n                            return [2 /*return*/, this.checkToFetch(currentEnd)];\r\n                        }\r\n                        else if (typeof newData === 'boolean' && newData === false) {\r\n                            this.hasMore = false;\r\n                            this.list.splice(this.loadedNum);\r\n                            this.onFetchFinish(this.list, false);\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DataManager.prototype.getList = function () {\r\n        return this.list;\r\n    };\r\n    DataManager.prototype.resetState = function () {\r\n        this.loadedNum = 0;\r\n        this.fetching = false;\r\n        this.hasMore = true;\r\n        this.list = [];\r\n    };\r\n    return DataManager;\r\n}());\n\nvar Tombstone = /** @class */ (function () {\r\n    function Tombstone(create) {\r\n        this.create = create;\r\n        this.cached = [];\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.initialed = false;\r\n        this.getSize();\r\n    }\r\n    Tombstone.isTombstone = function (el) {\r\n        if (el && el.classList) {\r\n            return el.classList.contains('tombstone');\r\n        }\r\n        return false;\r\n    };\r\n    Tombstone.prototype.getSize = function () {\r\n        if (!this.initialed) {\r\n            var tombstone = this.create();\r\n            tombstone.style.position = 'absolute';\r\n            document.body.appendChild(tombstone);\r\n            tombstone.style.display = '';\r\n            this.height = tombstone.offsetHeight;\r\n            this.width = tombstone.offsetWidth;\r\n            document.body.removeChild(tombstone);\r\n            this.cached.push(tombstone);\r\n        }\r\n    };\r\n    Tombstone.prototype.getOne = function () {\r\n        var tombstone = this.cached.pop();\r\n        if (tombstone) {\r\n            var tombstoneStyle = tombstone.style;\r\n            tombstoneStyle.display = '';\r\n            tombstoneStyle.opacity = '1';\r\n            tombstoneStyle[style.transform] = '';\r\n            tombstoneStyle[style.transition] = '';\r\n            return tombstone;\r\n        }\r\n        return this.create();\r\n    };\r\n    Tombstone.prototype.recycle = function (tombstones) {\r\n        for (var _i = 0, tombstones_1 = tombstones; _i < tombstones_1.length; _i++) {\r\n            var tombstone = tombstones_1[_i];\r\n            tombstone.style.display = 'none';\r\n            this.cached.push(tombstone);\r\n        }\r\n        return this.cached;\r\n    };\r\n    Tombstone.prototype.recycleOne = function (tombstone) {\r\n        this.cached.push(tombstone);\r\n        return this.cached;\r\n    };\r\n    return Tombstone;\r\n}());\n\nvar ANIMATION_DURATION_MS = 200;\r\nvar DomManager = /** @class */ (function () {\r\n    function DomManager(content, renderFn, tombstone) {\r\n        this.renderFn = renderFn;\r\n        this.tombstone = tombstone;\r\n        this.unusedDom = [];\r\n        this.timers = [];\r\n        this.setContent(content);\r\n    }\r\n    DomManager.prototype.update = function (list, start, end) {\r\n        if (start >= list.length) {\r\n            start = list.length - 1;\r\n        }\r\n        if (end > list.length) {\r\n            end = list.length;\r\n        }\r\n        this.collectUnusedDom(list, start, end);\r\n        this.createDom(list, start, end);\r\n        this.cacheHeight(list, start, end);\r\n        var _a = this.positionDom(list, start, end), startPos = _a.startPos, startDelta = _a.startDelta, endPos = _a.endPos;\r\n        return {\r\n            start: start,\r\n            startPos: startPos,\r\n            startDelta: startDelta,\r\n            end: end,\r\n            endPos: endPos,\r\n        };\r\n    };\r\n    DomManager.prototype.collectUnusedDom = function (list, start, end) {\r\n        // TODO optimise\r\n        for (var i = 0; i < list.length; i++) {\r\n            if (i === start) {\r\n                i = end - 1;\r\n                continue;\r\n            }\r\n            if (list[i].dom) {\r\n                var dom = list[i].dom;\r\n                if (Tombstone.isTombstone(dom)) {\r\n                    this.tombstone.recycleOne(dom);\r\n                    dom.style.display = 'none';\r\n                }\r\n                else {\r\n                    this.unusedDom.push(dom);\r\n                }\r\n                list[i].dom = null;\r\n            }\r\n        }\r\n        return list;\r\n    };\r\n    DomManager.prototype.createDom = function (list, start, end) {\r\n        for (var i = start; i < end; i++) {\r\n            var dom = list[i].dom;\r\n            var data = list[i].data;\r\n            if (dom) {\r\n                if (Tombstone.isTombstone(dom) && data) {\r\n                    list[i].tombstone = dom;\r\n                    list[i].dom = null;\r\n                }\r\n                else {\r\n                    continue;\r\n                }\r\n            }\r\n            dom = data\r\n                ? this.renderFn(data, this.unusedDom.pop())\r\n                : this.tombstone.getOne();\r\n            dom.style.position = 'absolute';\r\n            list[i].dom = dom;\r\n            list[i].pos = -1;\r\n            this.content.appendChild(dom);\r\n        }\r\n    };\r\n    DomManager.prototype.cacheHeight = function (list, start, end) {\r\n        for (var i = start; i < end; i++) {\r\n            if (list[i].data && !list[i].height) {\r\n                list[i].height = list[i].dom.offsetHeight;\r\n            }\r\n        }\r\n    };\r\n    DomManager.prototype.positionDom = function (list, start, end) {\r\n        var _this = this;\r\n        var tombstoneEles = [];\r\n        var _a = this.getStartPos(list, start, end), startPos = _a.start, startDelta = _a.delta;\r\n        var pos = startPos;\r\n        for (var i = start; i < end; i++) {\r\n            var tombstone = list[i].tombstone;\r\n            if (tombstone) {\r\n                var tombstoneStyle = tombstone.style;\r\n                tombstoneStyle[style.transition] = cssVendor + \"transform \" + ANIMATION_DURATION_MS + \"ms, opacity \" + ANIMATION_DURATION_MS + \"ms\";\r\n                tombstoneStyle[style.transform] = \"translateY(\" + pos + \"px)\";\r\n                tombstoneStyle.opacity = '0';\r\n                list[i].tombstone = null;\r\n                tombstoneEles.push(tombstone);\r\n            }\r\n            if (list[i].dom && list[i].pos !== pos) {\r\n                list[i].dom.style[style.transform] = \"translateY(\" + pos + \"px)\";\r\n                list[i].pos = pos;\r\n            }\r\n            pos += list[i].height || this.tombstone.height;\r\n        }\r\n        var timerId = window.setTimeout(function () {\r\n            _this.tombstone.recycle(tombstoneEles);\r\n        }, ANIMATION_DURATION_MS);\r\n        this.timers.push(timerId);\r\n        return {\r\n            startPos: startPos,\r\n            startDelta: startDelta,\r\n            endPos: pos,\r\n        };\r\n    };\r\n    DomManager.prototype.getStartPos = function (list, start, end) {\r\n        if (list[start] && list[start].pos !== -1) {\r\n            return {\r\n                start: list[start].pos,\r\n                delta: 0,\r\n            };\r\n        }\r\n        // TODO optimise\r\n        var pos = list[0].pos === -1 ? 0 : list[0].pos;\r\n        for (var i_1 = 0; i_1 < start; i_1++) {\r\n            pos += list[i_1].height || this.tombstone.height;\r\n        }\r\n        var originPos = pos;\r\n        var i;\r\n        for (i = start; i < end; i++) {\r\n            if (!Tombstone.isTombstone(list[i].dom) && list[i].pos !== -1) {\r\n                pos = list[i].pos;\r\n                break;\r\n            }\r\n        }\r\n        var x = i;\r\n        if (x < end) {\r\n            while (x > start) {\r\n                pos -= list[x - 1].height;\r\n                x--;\r\n            }\r\n        }\r\n        var delta = originPos - pos;\r\n        return {\r\n            start: pos,\r\n            delta: delta,\r\n        };\r\n    };\r\n    DomManager.prototype.removeTombstone = function () {\r\n        var tombstones = this.content.querySelectorAll('.tombstone');\r\n        for (var i = tombstones.length - 1; i >= 0; i--) {\r\n            this.content.removeChild(tombstones[i]);\r\n        }\r\n    };\r\n    DomManager.prototype.setContent = function (content) {\r\n        if (content !== this.content) {\r\n            this.content = content;\r\n        }\r\n    };\r\n    DomManager.prototype.destroy = function () {\r\n        this.removeTombstone();\r\n        this.timers.forEach(function (id) {\r\n            clearTimeout(id);\r\n        });\r\n    };\r\n    DomManager.prototype.resetState = function () {\r\n        this.destroy();\r\n        this.timers = [];\r\n        this.unusedDom = [];\r\n    };\r\n    return DomManager;\r\n}());\n\nvar EXTRA_SCROLL_Y = -2000;\r\nvar InfinityScroll = /** @class */ (function () {\r\n    function InfinityScroll(scroll) {\r\n        this.scroll = scroll;\r\n        this.start = 0;\r\n        this.end = 0;\r\n        this.init();\r\n    }\r\n    InfinityScroll.prototype.init = function () {\r\n        var _this = this;\r\n        this.handleOptions();\r\n        var _a = this.options, fetchFn = _a.fetch, renderFn = _a.render, createTombstoneFn = _a.createTombstone;\r\n        this.tombstone = new Tombstone(createTombstoneFn);\r\n        this.indexCalculator = new IndexCalculator(this.scroll.scroller.scrollBehaviorY.wrapperSize, this.tombstone.height);\r\n        this.domManager = new DomManager(this.scroll.scroller.content, renderFn, this.tombstone);\r\n        this.dataManager = new DataManager([], fetchFn, this.onFetchFinish.bind(this));\r\n        this.scroll.on(this.scroll.eventTypes.destroy, this.destroy, this);\r\n        this.scroll.on(this.scroll.eventTypes.scroll, this.update, this);\r\n        this.scroll.on(this.scroll.eventTypes.contentChanged, function (content) {\r\n            _this.domManager.setContent(content);\r\n            _this.indexCalculator.resetState();\r\n            _this.domManager.resetState();\r\n            _this.dataManager.resetState();\r\n            _this.update({ y: 0 });\r\n        });\r\n        var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n        scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.computeBoundary, this.modifyBoundary, this);\r\n        this.update({ y: 0 });\r\n    };\r\n    InfinityScroll.prototype.modifyBoundary = function (boundary) {\r\n        // manually set position to allow scroll\r\n        boundary.maxScrollPos = EXTRA_SCROLL_Y;\r\n    };\r\n    InfinityScroll.prototype.handleOptions = function () {\r\n        // narrow down type to an object\r\n        var infinityOptions = this.scroll.options.infinity;\r\n        if (infinityOptions) {\r\n            if (typeof infinityOptions.fetch !== 'function') {\r\n                warn('Infinity plugin need fetch Function to new data.');\r\n            }\r\n            if (typeof infinityOptions.render !== 'function') {\r\n                warn('Infinity plugin need render Function to render each item.');\r\n            }\r\n            if (typeof infinityOptions.render !== 'function') {\r\n                warn('Infinity plugin need createTombstone Function to create tombstone.');\r\n            }\r\n            this.options = infinityOptions;\r\n        }\r\n        this.scroll.options.probeType = 3 /* Realtime */;\r\n    };\r\n    InfinityScroll.prototype.update = function (pos) {\r\n        var position = Math.round(-pos.y);\r\n        // important! calculate start/end index to render\r\n        var _a = this.indexCalculator.calculate(position, this.dataManager.getList()), start = _a.start, end = _a.end;\r\n        this.start = start;\r\n        this.end = end;\r\n        // tslint:disable-next-line: no-floating-promises\r\n        this.dataManager.update(end);\r\n        this.updateDom(this.dataManager.getList());\r\n    };\r\n    InfinityScroll.prototype.onFetchFinish = function (list, hasMore) {\r\n        var end = this.updateDom(list).end;\r\n        if (!hasMore) {\r\n            this.domManager.removeTombstone();\r\n            this.scroll.scroller.animater.stop();\r\n            this.scroll.resetPosition();\r\n        }\r\n        // tslint:disable-next-line: no-floating-promises\r\n        return end;\r\n    };\r\n    InfinityScroll.prototype.updateDom = function (list) {\r\n        var _a = this.domManager.update(list, this.start, this.end), end = _a.end, startPos = _a.startPos, endPos = _a.endPos, startDelta = _a.startDelta;\r\n        if (startDelta) {\r\n            this.scroll.minScrollY = startDelta;\r\n        }\r\n        if (endPos > this.scroll.maxScrollY) {\r\n            this.scroll.maxScrollY = -(endPos - this.scroll.scroller.scrollBehaviorY.wrapperSize);\r\n        }\r\n        return {\r\n            end: end,\r\n            startPos: startPos,\r\n            endPos: endPos,\r\n        };\r\n    };\r\n    InfinityScroll.prototype.destroy = function () {\r\n        var _a = this.scroll.scroller, content = _a.content, scrollBehaviorY = _a.scrollBehaviorY;\r\n        while (content.firstChild) {\r\n            content.removeChild(content.firstChild);\r\n        }\r\n        this.domManager.destroy();\r\n        this.scroll.off('scroll', this.update);\r\n        this.scroll.off('destroy', this.destroy);\r\n        scrollBehaviorY.hooks.off(scrollBehaviorY.hooks.eventTypes.computeBoundary);\r\n    };\r\n    InfinityScroll.pluginName = 'infinity';\r\n    return InfinityScroll;\r\n}());\n\nvar sourcePrefix = 'plugins.movable';\r\nvar propertiesMap = [\r\n    {\r\n        key: 'putAt',\r\n        name: 'putAt',\r\n    },\r\n];\r\nvar propertiesConfig = propertiesMap.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix + \".\" + item.name,\r\n    };\r\n});\n\nvar Movable = /** @class */ (function () {\r\n    function Movable(scroll) {\r\n        this.scroll = scroll;\r\n        this.handleBScroll();\r\n        this.handleHooks();\r\n    }\r\n    Movable.prototype.handleBScroll = function () {\r\n        this.scroll.proxy(propertiesConfig);\r\n    };\r\n    Movable.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        this.hooksFn = [];\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        var computeBoundary = function (boundary, behavior) {\r\n            if (boundary.maxScrollPos > 0) {\r\n                // content is smaller than wrapper\r\n                boundary.minScrollPos = behavior.wrapperSize - behavior.contentSize;\r\n                boundary.maxScrollPos = 0;\r\n            }\r\n        };\r\n        this.registerHooks(scrollBehaviorX.hooks, scrollBehaviorX.hooks.eventTypes.ignoreHasScroll, function () { return true; });\r\n        this.registerHooks(scrollBehaviorX.hooks, scrollBehaviorX.hooks.eventTypes.computeBoundary, function (boundary) {\r\n            computeBoundary(boundary, scrollBehaviorX);\r\n        });\r\n        this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.ignoreHasScroll, function () { return true; });\r\n        this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\r\n            computeBoundary(boundary, scrollBehaviorY);\r\n        });\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.destroy, function () {\r\n            _this.destroy();\r\n        });\r\n    };\r\n    Movable.prototype.putAt = function (x, y, time, easing) {\r\n        if (time === void 0) { time = this.scroll.options.bounceTime; }\r\n        if (easing === void 0) { easing = ease.bounce; }\r\n        var position = this.resolvePostion(x, y);\r\n        this.scroll.scrollTo(position.x, position.y, time, easing);\r\n    };\r\n    Movable.prototype.resolvePostion = function (x, y) {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        var resolveFormula = {\r\n            left: function () {\r\n                return 0;\r\n            },\r\n            top: function () {\r\n                return 0;\r\n            },\r\n            right: function () {\r\n                return scrollBehaviorX.minScrollPos;\r\n            },\r\n            bottom: function () {\r\n                return scrollBehaviorY.minScrollPos;\r\n            },\r\n            center: function (index) {\r\n                var baseSize = index === 0\r\n                    ? scrollBehaviorX.minScrollPos\r\n                    : scrollBehaviorY.minScrollPos;\r\n                return baseSize / 2;\r\n            },\r\n        };\r\n        return {\r\n            x: typeof x === 'number' ? x : resolveFormula[x](0),\r\n            y: typeof y === 'number' ? y : resolveFormula[y](1),\r\n        };\r\n    };\r\n    Movable.prototype.destroy = function () {\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    Movable.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Movable.pluginName = 'movable';\r\n    Movable.applyOrder = \"pre\" /* Pre */;\r\n    return Movable;\r\n}());\n\nvar isImageTag = function (el) {\r\n    return el.tagName.toLowerCase() === 'img';\r\n};\r\nvar ObserveImage = /** @class */ (function () {\r\n    function ObserveImage(scroll) {\r\n        this.scroll = scroll;\r\n        this.refreshTimer = 0;\r\n        this.init();\r\n    }\r\n    ObserveImage.prototype.init = function () {\r\n        this.handleOptions(this.scroll.options.observeImage);\r\n        this.bindEventsToWrapper();\r\n    };\r\n    ObserveImage.prototype.handleOptions = function (userOptions) {\r\n        if (userOptions === void 0) { userOptions = {}; }\r\n        userOptions = (userOptions === true ? {} : userOptions);\r\n        var defaultOptions = {\r\n            debounceTime: 100,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n    };\r\n    ObserveImage.prototype.bindEventsToWrapper = function () {\r\n        var wrapper = this.scroll.scroller.wrapper;\r\n        this.imageLoadEventRegister = new EventRegister(wrapper, [\r\n            {\r\n                name: 'load',\r\n                handler: this.load.bind(this),\r\n                capture: true,\r\n            },\r\n        ]);\r\n        this.imageErrorEventRegister = new EventRegister(wrapper, [\r\n            {\r\n                name: 'error',\r\n                handler: this.load.bind(this),\r\n                capture: true,\r\n            },\r\n        ]);\r\n    };\r\n    ObserveImage.prototype.load = function (e) {\r\n        var _this = this;\r\n        var target = e.target;\r\n        var debounceTime = this.options.debounceTime;\r\n        if (target && isImageTag(target)) {\r\n            if (debounceTime === 0) {\r\n                this.scroll.refresh();\r\n            }\r\n            else {\r\n                clearTimeout(this.refreshTimer);\r\n                this.refreshTimer = window.setTimeout(function () {\r\n                    _this.scroll.refresh();\r\n                }, this.options.debounceTime);\r\n            }\r\n        }\r\n    };\r\n    ObserveImage.pluginName = 'observeImage';\r\n    return ObserveImage;\r\n}());\n\nvar resolveRatioOption = function (ratioConfig) {\r\n    var ret = {\r\n        ratioX: 0,\r\n        ratioY: 0,\r\n    };\r\n    /* istanbul ignore if  */\r\n    if (!ratioConfig) {\r\n        return ret;\r\n    }\r\n    if (typeof ratioConfig === 'number') {\r\n        ret.ratioX = ret.ratioY = ratioConfig;\r\n    }\r\n    else if (typeof ratioConfig === 'object' && ratioConfig) {\r\n        ret.ratioX = ratioConfig.x || 0;\r\n        ret.ratioY = ratioConfig.y || 0;\r\n    }\r\n    return ret;\r\n};\r\nvar handleBubbleAndCancelable = function (e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n};\r\nvar Indicator = /** @class */ (function () {\r\n    function Indicator(scroll, options) {\r\n        this.scroll = scroll;\r\n        this.options = options;\r\n        this.currentPos = {\r\n            x: 0,\r\n            y: 0,\r\n        };\r\n        this.hooksFn = [];\r\n        this.handleDOM();\r\n        this.handleHooks();\r\n        this.handleInteractive();\r\n    }\r\n    Indicator.prototype.handleDOM = function () {\r\n        var _a = this.options, relationElement = _a.relationElement, _b = _a.relationElementHandleElementIndex, relationElementHandleElementIndex = _b === void 0 ? 0 : _b;\r\n        this.wrapper = relationElement;\r\n        this.indicatorEl = this.wrapper.children[relationElementHandleElementIndex];\r\n    };\r\n    Indicator.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scroll = this.scroll;\r\n        var scrollHooks = scroll.hooks;\r\n        var translaterHooks = scroll.scroller.translater.hooks;\r\n        var animaterHooks = scroll.scroller.animater.hooks;\r\n        this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refresh);\r\n        this.registerHooks(translaterHooks, translaterHooks.eventTypes.translate, function (pos) {\r\n            _this.updatePosition(pos);\r\n        });\r\n        this.registerHooks(animaterHooks, animaterHooks.eventTypes.time, this.transitionTime);\r\n        this.registerHooks(animaterHooks, animaterHooks.eventTypes.timeFunction, this.transitionTimingFunction);\r\n    };\r\n    Indicator.prototype.transitionTime = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        this.indicatorEl.style[style.transitionDuration] = time + 'ms';\r\n    };\r\n    Indicator.prototype.transitionTimingFunction = function (easing) {\r\n        this.indicatorEl.style[style.transitionTimingFunction] = easing;\r\n    };\r\n    Indicator.prototype.handleInteractive = function () {\r\n        if (this.options.interactive !== false) {\r\n            this.registerEvents();\r\n        }\r\n    };\r\n    Indicator.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Indicator.prototype.registerEvents = function () {\r\n        var _a = this.scroll.options, disableMouse = _a.disableMouse, disableTouch = _a.disableTouch;\r\n        var startEvents = [];\r\n        var moveEvents = [];\r\n        var endEvents = [];\r\n        if (!disableMouse) {\r\n            startEvents.push({\r\n                name: 'mousedown',\r\n                handler: this.start.bind(this),\r\n            });\r\n            moveEvents.push({\r\n                name: 'mousemove',\r\n                handler: this.move.bind(this),\r\n            });\r\n            endEvents.push({\r\n                name: 'mouseup',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        if (!disableTouch) {\r\n            startEvents.push({\r\n                name: 'touchstart',\r\n                handler: this.start.bind(this),\r\n            });\r\n            moveEvents.push({\r\n                name: 'touchmove',\r\n                handler: this.move.bind(this),\r\n            });\r\n            endEvents.push({\r\n                name: 'touchend',\r\n                handler: this.end.bind(this),\r\n            }, {\r\n                name: 'touchcancel',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        this.startEventRegister = new EventRegister(this.indicatorEl, startEvents);\r\n        this.moveEventRegister = new EventRegister(window, moveEvents);\r\n        this.endEventRegister = new EventRegister(window, endEvents);\r\n    };\r\n    Indicator.prototype.refresh = function () {\r\n        var _a = this.scroll, x = _a.x, y = _a.y, hasHorizontalScroll = _a.hasHorizontalScroll, hasVerticalScroll = _a.hasVerticalScroll, maxBScrollX = _a.maxScrollX, maxBScrollY = _a.maxScrollY;\r\n        var _b = resolveRatioOption(this.options.ratio), ratioX = _b.ratioX, ratioY = _b.ratioY;\r\n        var _c = getClientSize(this.wrapper), wrapperWidth = _c.width, wrapperHeight = _c.height;\r\n        var _d = getRect(this.indicatorEl), indicatorWidth = _d.width, indicatorHeight = _d.height;\r\n        if (hasHorizontalScroll) {\r\n            this.maxScrollX = wrapperWidth - indicatorWidth;\r\n            this.translateXSign =\r\n                this.maxScrollX > 0 ? -1 /* Positive */ : 1 /* NotPositive */;\r\n            this.minScrollX = 0;\r\n            // ensure positive\r\n            this.ratioX = ratioX ? ratioX : Math.abs(this.maxScrollX / maxBScrollX);\r\n        }\r\n        if (hasVerticalScroll) {\r\n            this.maxScrollY = wrapperHeight - indicatorHeight;\r\n            this.translateYSign =\r\n                this.maxScrollY > 0 ? -1 /* Positive */ : 1 /* NotPositive */;\r\n            this.minScrollY = 0;\r\n            this.ratioY = ratioY ? ratioY : Math.abs(this.maxScrollY / maxBScrollY);\r\n        }\r\n        this.updatePosition({\r\n            x: x,\r\n            y: y,\r\n        });\r\n    };\r\n    Indicator.prototype.start = function (e) {\r\n        if (this.BScrollIsDisabled()) {\r\n            return;\r\n        }\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        handleBubbleAndCancelable(e);\r\n        this.initiated = true;\r\n        this.moved = false;\r\n        this.lastPointX = point.pageX;\r\n        this.lastPointY = point.pageY;\r\n        this.startTime = getNow();\r\n        this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.beforeScrollStart);\r\n    };\r\n    Indicator.prototype.BScrollIsDisabled = function () {\r\n        return !this.scroll.enabled;\r\n    };\r\n    Indicator.prototype.move = function (e) {\r\n        if (!this.initiated) {\r\n            return;\r\n        }\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        var pointX = point.pageX;\r\n        var pointY = point.pageY;\r\n        handleBubbleAndCancelable(e);\r\n        var deltaX = pointX - this.lastPointX;\r\n        var deltaY = pointY - this.lastPointY;\r\n        this.lastPointX = pointX;\r\n        this.lastPointY = pointY;\r\n        if (!this.moved && !this.indicatorNotMoved(deltaX, deltaY)) {\r\n            this.moved = true;\r\n            this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollStart);\r\n        }\r\n        if (this.moved) {\r\n            var newPos = this.getBScrollPosByRatio(this.currentPos, deltaX, deltaY);\r\n            this.syncBScroll(newPos);\r\n        }\r\n    };\r\n    Indicator.prototype.end = function (e) {\r\n        if (!this.initiated) {\r\n            return;\r\n        }\r\n        this.initiated = false;\r\n        handleBubbleAndCancelable(e);\r\n        if (this.moved) {\r\n            var _a = this.scroll, x = _a.x, y = _a.y;\r\n            this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollEnd, {\r\n                x: x,\r\n                y: y,\r\n            });\r\n        }\r\n    };\r\n    Indicator.prototype.getBScrollPosByRatio = function (currentPos, deltaX, deltaY) {\r\n        var currentX = currentPos.x, currentY = currentPos.y;\r\n        var _a = this.scroll, hasHorizontalScroll = _a.hasHorizontalScroll, hasVerticalScroll = _a.hasVerticalScroll, BScrollMinScrollX = _a.minScrollX, BScrollMaxScrollX = _a.maxScrollX, BScrollMinScrollY = _a.minScrollY, BScrollMaxScrollY = _a.maxScrollY;\r\n        var _b = this.scroll, x = _b.x, y = _b.y;\r\n        if (hasHorizontalScroll) {\r\n            var newPosX = between(currentX + deltaX, Math.min(this.minScrollX, this.maxScrollX), Math.max(this.minScrollX, this.maxScrollX));\r\n            var roundX = Math.round((newPosX / this.ratioX) * this.translateXSign);\r\n            x = between(roundX, BScrollMaxScrollX, BScrollMinScrollX);\r\n        }\r\n        if (hasVerticalScroll) {\r\n            var newPosY = between(currentY + deltaY, Math.min(this.minScrollY, this.maxScrollY), Math.max(this.minScrollY, this.maxScrollY));\r\n            var roundY = Math.round((newPosY / this.ratioY) * this.translateYSign);\r\n            y = between(roundY, BScrollMaxScrollY, BScrollMinScrollY);\r\n        }\r\n        return { x: x, y: y };\r\n    };\r\n    Indicator.prototype.indicatorNotMoved = function (deltaX, deltaY) {\r\n        var _a = this.currentPos, x = _a.x, y = _a.y;\r\n        var xNotMoved = (x === this.minScrollX && deltaX <= 0) ||\r\n            (x === this.maxScrollX && deltaX >= 0);\r\n        var yNotMoved = (y === this.minScrollY && deltaY <= 0) ||\r\n            (y === this.maxScrollY && deltaY >= 0);\r\n        return xNotMoved && yNotMoved;\r\n    };\r\n    Indicator.prototype.syncBScroll = function (newPos) {\r\n        var timestamp = getNow();\r\n        var _a = this.scroll, options = _a.options, scroller = _a.scroller;\r\n        var probeType = options.probeType, momentumLimitTime = options.momentumLimitTime;\r\n        scroller.translater.translate(newPos);\r\n        // dispatch scroll in interval time\r\n        if (timestamp - this.startTime > momentumLimitTime) {\r\n            this.startTime = timestamp;\r\n            if (probeType === 1 /* Throttle */) {\r\n                scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, newPos);\r\n            }\r\n        }\r\n        // dispatch scroll all the time\r\n        if (probeType > 1 /* Throttle */) {\r\n            scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, newPos);\r\n        }\r\n    };\r\n    Indicator.prototype.updatePosition = function (BScrollPos) {\r\n        var newIndicatorPos = this.getIndicatorPosByRatio(BScrollPos);\r\n        this.applyTransformProperty(newIndicatorPos);\r\n        this.currentPos = __assign({}, newIndicatorPos);\r\n    };\r\n    Indicator.prototype.applyTransformProperty = function (pos) {\r\n        var translateZ = this.scroll.options.translateZ;\r\n        var transformProperties = [\r\n            \"translateX(\" + pos.x + \"px)\",\r\n            \"translateY(\" + pos.y + \"px)\",\r\n            \"\" + translateZ,\r\n        ];\r\n        this.indicatorEl.style[style.transform] = transformProperties.join(' ');\r\n    };\r\n    Indicator.prototype.getIndicatorPosByRatio = function (BScrollPos) {\r\n        var x = BScrollPos.x, y = BScrollPos.y;\r\n        var _a = this.scroll, hasHorizontalScroll = _a.hasHorizontalScroll, hasVerticalScroll = _a.hasVerticalScroll;\r\n        var position = __assign({}, this.currentPos);\r\n        if (hasHorizontalScroll) {\r\n            var roundX = Math.round(this.ratioX * x * this.translateXSign);\r\n            // maybe maxScrollX is negative\r\n            position.x = between(roundX, Math.min(this.minScrollX, this.maxScrollX), Math.max(this.minScrollX, this.maxScrollX));\r\n        }\r\n        if (hasVerticalScroll) {\r\n            var roundY = Math.round(this.ratioY * y * this.translateYSign);\r\n            // maybe maxScrollY is negative\r\n            position.y = between(roundY, Math.min(this.minScrollY, this.maxScrollY), Math.max(this.minScrollY, this.maxScrollY));\r\n        }\r\n        return position;\r\n    };\r\n    Indicator.prototype.destroy = function () {\r\n        if (this.options.interactive !== false) {\r\n            this.startEventRegister.destroy();\r\n            this.moveEventRegister.destroy();\r\n            this.endEventRegister.destroy();\r\n        }\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    return Indicator;\r\n}());\n\nvar Indicators = /** @class */ (function () {\r\n    function Indicators(scroll) {\r\n        this.scroll = scroll;\r\n        this.options = [];\r\n        this.indicators = [];\r\n        this.handleOptions();\r\n        this.handleHooks();\r\n    }\r\n    Indicators.prototype.handleOptions = function () {\r\n        var UserIndicatorsOptions = this.scroll.options.indicators;\r\n        assert(Array.isArray(UserIndicatorsOptions), \"'indicators' must be an array.\");\r\n        for (var _i = 0, UserIndicatorsOptions_1 = UserIndicatorsOptions; _i < UserIndicatorsOptions_1.length; _i++) {\r\n            var indicatorOptions = UserIndicatorsOptions_1[_i];\r\n            assert(!!indicatorOptions.relationElement, \"'relationElement' must be a HTMLElement.\");\r\n            this.createIndicators(indicatorOptions);\r\n        }\r\n    };\r\n    Indicators.prototype.createIndicators = function (options) {\r\n        this.indicators.push(new Indicator(this.scroll, options));\r\n    };\r\n    Indicators.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scrollHooks = this.scroll.hooks;\r\n        scrollHooks.on(scrollHooks.eventTypes.destroy, function () {\r\n            for (var _i = 0, _a = _this.indicators; _i < _a.length; _i++) {\r\n                var indicator = _a[_i];\r\n                indicator.destroy();\r\n            }\r\n            _this.indicators = [];\r\n        });\r\n    };\r\n    Indicators.pluginName = 'indicators';\r\n    return Indicators;\r\n}());\n\nBScroll.use(MouseWheel)\r\n    .use(ObserveDOM)\r\n    .use(PullDown)\r\n    .use(PullUp)\r\n    .use(ScrollBar)\r\n    .use(Slide)\r\n    .use(Wheel)\r\n    .use(Zoom)\r\n    .use(NestedScroll)\r\n    .use(InfinityScroll)\r\n    .use(Movable)\r\n    .use(ObserveImage)\r\n    .use(Indicators);\n\nexport default BScroll;\nexport { Behavior, CustomOptions, Indicators, InfinityScroll, MouseWheel, Movable, NestedScroll, ObserveDOM as ObserveDom, ObserveImage, PullDown as PullDownRefresh, PullUp as PullUpLoad, ScrollBar, Slide, Wheel, Zoom, createBScroll };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}